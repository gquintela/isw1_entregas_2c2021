

----QUIT----(13 November 2021 20:18:32) CuisUniversity-4972.image priorSource: 14896235!

----STARTUP---- (13 November 2021 20:18:33) as /Users/hernan/Documents/Cuis/5.0-64Bits/Cuis-University-Installer/CuisUniversity-4972.image!


----QUIT----(13 November 2021 20:18:33) CuisUniversity-4972.image priorSource: 18974023!

----STARTUP---- (15 November 2021 17:58:55) as /home/equipo/Escritorio/linux64 (3)/linux64/CuisUniversity-4972.image!


----End fileIn of /home/equipo/Escritorio/linux64 (3)/linux64/WordsClientDemo.st----!

----End fileIn of /home/equipo/Escritorio/linux64 (3)/linux64/TusLibros-View.st----!

----End fileIn of /home/equipo/Escritorio/linux64 (3)/linux64/TusLibros-80.st----!

----End fileIn of /home/equipo/Escritorio/linux64 (3)/linux64/StringsServicesServer.st----!

----End fileIn of /home/equipo/Escritorio/linux64 (3)/linux64/Packages/System/Collections-CompactArrays.pck.st----!

----End fileIn of /home/equipo/Escritorio/linux64 (3)/linux64/Packages/Features/Compression.pck.st----!

----End fileIn of /home/equipo/Escritorio/linux64 (3)/linux64/Packages/Features/Sound.pck.st----!

----End fileIn of /home/equipo/Escritorio/linux64 (3)/linux64/Packages/Features/Cryptography-DigitalSignatures.pck.st----!

----End fileIn of /home/equipo/Escritorio/linux64 (3)/linux64/Packages/Features/Identities-UUID.pck.st----!

----End fileIn of /home/equipo/Escritorio/linux64 (3)/linux64/Packages/System/Network-Kernel.pck.st----!

----End fileIn of /home/equipo/Escritorio/linux64 (3)/linux64/Packages/WebClient.pck.st----!

----STARTUP---- (15 November 2021 18:04:00) as /home/equipo/Escritorio/linux64 (3)/linux64/CuisUniversity-4972.image!


----End fileIn of /home/equipo/Escritorio/linux64 (3)/linux64/Packages/System/Collections-CompactArrays.pck.st----!

----End fileIn of /home/equipo/Escritorio/linux64 (3)/linux64/Packages/Features/Compression.pck.st----!

----End fileIn of /home/equipo/Escritorio/linux64 (3)/linux64/Packages/Features/Sound.pck.st----!

----End fileIn of /home/equipo/Escritorio/linux64 (3)/linux64/Packages/Features/Cryptography-DigitalSignatures.pck.st----!

----End fileIn of /home/equipo/Escritorio/linux64 (3)/linux64/Packages/Features/Identities-UUID.pck.st----!

----End fileIn of /home/equipo/Escritorio/linux64 (3)/linux64/Packages/System/Network-Kernel.pck.st----!

----End fileIn of /home/equipo/Escritorio/linux64 (3)/linux64/Packages/WebClient.pck.st----!

----End fileIn of /home/equipo/Escritorio/linux64 (3)/linux64/WordsClientDemo.st----!

----End fileIn of /home/equipo/Escritorio/linux64 (3)/linux64/TusLibros-View.st----!

----End fileIn of /home/equipo/Escritorio/linux64 (3)/linux64/TusLibros-80.st----!

----End fileIn of /home/equipo/Escritorio/linux64 (3)/linux64/StringsServicesServer.st----!

----SNAPSHOT----(15 November 2021 18:05:58) CuisUniversity-4972.image priorSource: 18974255!

StringsServicesRestInterface listeningOn: 8080!

WordsClientWindow open!

----STARTUP---- (15 November 2021 18:20:55) as /home/equipo/Escritorio/linux64 (3)/linux64/CuisUniversity-4972.image!

!TusLibrosXx methodsFor: 'initialization' stamp: 'FR 11/15/2021 19:36:07'!
addCreateCartService

	webServer addService: '/create-cart' action:[:request | | user password cartId cartIdAsJson |
		
		[
			user := (request fields at: 'user').
			password := (request fields at: 'password').
			cartId := tusLibrosSystemFacade 
			createCartFor: user authenticatedWith: password.
			cartIdAsJson := WebUtils jsonEncode: (cartId).
			request send200Response: (cartIdAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	! !
!TusLibrosXx methodsFor: 'initialization' stamp: 'FR 11/15/2021 19:38:31' prior: 50961541!
addServices

	self addCreateCartService.! !
!TusLibrosSystemFacade methodsFor: 'facade protocol' stamp: 'FR 11/15/2021 19:39:58'!
listCatalog

	^ catalog copy! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'FR 11/15/2021 19:40:03'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'FR 11/15/2021 19:40:03'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'FR 11/15/2021 19:40:03'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'FR 11/15/2021 19:40:03'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'FR 11/15/2021 19:40:03'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'FR 11/15/2021 19:40:03'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'FR 11/15/2021 19:40:03'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'FR 11/15/2021 19:40:03'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'FR 11/15/2021 19:40:03'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'FR 11/15/2021 19:40:03'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'FR 11/15/2021 19:40:03'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'FR 11/15/2021 19:40:03'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'FR 11/15/2021 19:40:03'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'FR 11/15/2021 19:40:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test01CanCreateCartWithValidUserAndPassword stamp: 'FR 11/15/2021 19:40:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test02CanNotCreateCartWithInvalidUser stamp: 'FR 11/15/2021 19:40:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test03CanNotCreateCartWithInvalidPassword stamp: 'FR 11/15/2021 19:40:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test04CanAddItemsToACreatedCart stamp: 'FR 11/15/2021 19:40:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test05CanNotAddItemToNotCreatedCart stamp: 'FR 11/15/2021 19:40:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test06CanNotAddItemNotSellByTheStore stamp: 'FR 11/15/2021 19:40:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test07ListCartOfAnEmptyCartReturnsAnEmptyBag stamp: 'FR 11/15/2021 19:40:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test08CanNotListCartOfInvalidCartId stamp: 'FR 11/15/2021 19:40:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test09ListCartReturnsTheRightNumberOfItems stamp: 'FR 11/15/2021 19:40:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test10CanCheckoutACart stamp: 'FR 11/15/2021 19:40:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test11CanNotCheckoutANotCreatedCart stamp: 'FR 11/15/2021 19:40:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test12CanNotCheckoutAnEmptyCart stamp: 'FR 11/15/2021 19:40:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test13CanNotCheckoutWithAnExpiredCreditCard stamp: 'FR 11/15/2021 19:40:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test14ListPurchasesIncludesBoughtItems stamp: 'FR 11/15/2021 19:40:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test15CanNotListPurchasesOfInvalidCustomer stamp: 'FR 11/15/2021 19:40:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test16CanNotListPurchasesOfValidCustomerWithInvalidPassword stamp: 'FR 11/15/2021 19:40:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test17CanNotAddToCartWhenSessionIsExpired stamp: 'FR 11/15/2021 19:40:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test18CanNotListCartWhenSessionIsExpired stamp: 'FR 11/15/2021 19:40:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test19CanNotCheckOutCartWhenSessionIsExpired stamp: 'FR 11/15/2021 19:40:03'!
PASSED!
!TusLibrosXx methodsFor: 'initialization' stamp: 'FR 11/15/2021 19:45:27'!
addListCatalogService

	webServer addService: '/list-catalog' action:[:request | | catalogAsJson |
		
		[
			catalogAsJson := WebUtils jsonEncode: (tusLibrosSystemFacade 
			listCatalog).
			request send200Response: (catalogAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	! !
!TusLibrosXx methodsFor: 'initialization' stamp: 'FR 11/15/2021 19:45:38' prior: 50963468!
addServices

	self addCreateCartService.
	self addListCatalogService.! !
!TusLibrosXx methodsFor: 'initialization' stamp: 'FR 11/15/2021 19:49:26'!
destroy
	
	webServer ifNotNil:[webServer destroy]! !

MerchantProcessor subclass: #MerchantProcessorStub
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Model'!

!classDefinition: #MerchantProcessorStub category: 'TusLibros-Model' stamp: 'FR 11/15/2021 20:00:01'!
MerchantProcessor subclass: #MerchantProcessorStub
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Model'!
!MerchantProcessorStub methodsFor: 'nil' stamp: 'FR 11/15/2021 20:00:14' overrides: 50962064!
debit: anAmount from: aCreditCard! !

| userAndPassword catalog |

userAndPassword := Dictionary new at: 'validUser' put: 'validUserPassword'.
catalog := Dictionary new at: 'book' put: 10.

TusLibrosXx listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: (GregorianDateTime new).!

TusLibrosXx!

TusLibrosXx!

TusLibrosXx allInstances.!

TusLibrosXx allInstances first destroy.!

| userAndPassword catalog tusLibrosXxInstance |

userAndPassword := Dictionary new.
userAndPassword at: 'validUser' put: 'validUserPassword'.
catalog := Dictionary new.
catalog at: 'book' put: 10.

tusLibrosXxInstance := TusLibrosXx listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: (GregorianDateTime new).!

| userAndPassword catalog tusLibrosXxInstance |

userAndPassword := Dictionary new.
userAndPassword at: 'validUser' put: 'validUserPassword'.
catalog := Dictionary new.
catalog at: 'book' put: 10.

tusLibrosXxInstance := TusLibrosXx listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: (GregorianDateTime new).!

TusLibrosXx allInstances.!

TusLibrosXx allInstancesDo: [:anInstance | anInstance destroy].!

TusLibrosXx allInstances.!

TusLibrosXx allInstancesDo: [:anInstance | anInstance destroy].!

TusLibrosXx allInstances.!

TusLibrosXx allInstances do: [:anInstance | anInstance destroy].!

TusLibrosXx allInstances.!

TusLibrosXx allInstances.!

| userAndPassword catalog tusLibrosXxInstance |

userAndPassword := Dictionary new.
userAndPassword at: 'validUser' put: 'validUserPassword'.
catalog := Dictionary new.
catalog at: 'book' put: 10.

tusLibrosXxInstance := TusLibrosXx listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: (GregorianDateTime new).!

TusLibrosXx allInstances do: [:anInstance | anInstance destroy].
!

| userAndPassword catalog tusLibrosXxInstance |

userAndPassword := Dictionary new.
userAndPassword at: 'validUser' put: 'validUserPassword'.
catalog := Dictionary new.
catalog at: 'book' put: 10.

tusLibrosXxInstance := TusLibrosXx listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: (GregorianDateTime new).!

TusLibrosXx allInstances do: [:anInstance | anInstance destroy].!

| userAndPassword catalog tusLibrosXxInstance |

userAndPassword := Dictionary new.
userAndPassword at: 'validUser' put: 'validUserPassword'.
catalog := Dictionary new.
catalog at: 'book' put: 10.

tusLibrosXxInstance := TusLibrosXx listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime.!

TusLibrosXx allInstances do: [:anInstance | anInstance destroy].!

----SNAPSHOT----(15 November 2021 20:27:59) CuisUniversity-4972.image priorSource: 20217313!
!TusLibrosXx methodsFor: 'initialization' stamp: 'FR 11/15/2021 20:38:07'!
addAddToCartService

	webServer addService: '/add-to-cart' action:[:request | | bookAmount book cartId |
		
		[
			bookAmount := (request fields at: 'bookAmount').
			book := (request fields at: 'book').
			cartId := (request fields at: 'cartId').
			tusLibrosSystemFacade 
			add: bookAmount of: book toCartIdentifiedAs: cartId.
			request send200Response: (WebUtils jsonEncode: 'Book added correctly')
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	! !
!TusLibrosXx methodsFor: 'initialization' stamp: 'FR 11/15/2021 20:38:16' prior: 50963608!
addServices

	self addCreateCartService.
	self addListCatalogService.
	self addAddToCartService.! !

| userAndPassword catalog tusLibrosXxInstance |

userAndPassword := Dictionary new.
userAndPassword at: 'validUser' put: 'validUserPassword'.
catalog := Dictionary new.
catalog at: 'book' put: 10.

tusLibrosXxInstance := TusLibrosXx listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime.!

TusLibrosXx allInstances do: [:anInstance | anInstance destroy].!

| userAndPassword catalog tusLibrosXxInstance tusLibrosSystemFacade |

userAndPassword := Dictionary new.
userAndPassword at: 'validUser' put: 'validUserPassword'.
catalog := Dictionary new.
catalog at: 'book' put: 10.!

tusLibrosSystemFacade := TusLibrosSystemFacade authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime.

tusLibrosSystemFacade createCartFor: 'validUser' authenticatedWith: 'validUserPassword'.!

| userAndPassword catalog tusLibrosXxInstance tusLibrosSystemFacade |

userAndPassword := Dictionary new.
userAndPassword at: 'validUser' put: 'validUserPassword'.
catalog := Dictionary new.
catalog at: 'book' put: 10.

tusLibrosSystemFacade := TusLibrosSystemFacade authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime.

tusLibrosSystemFacade createCartFor: 'validUser' authenticatedWith: 'validUserPassword'.!

| userAndPassword catalog tusLibrosXxInstance tusLibrosSystemFacade |

userAndPassword := Dictionary new.
userAndPassword at: 'validUser' put: 'validUserPassword'.
catalog := Dictionary new.
catalog at: 'book' put: 10.

tusLibrosSystemFacade := TusLibrosSystemFacade authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime.

tusLibrosSystemFacade createCartFor: 'validUser' authenticatedWith: 'validUserPassword'.!

| userAndPassword catalog tusLibrosXxInstance tusLibrosSystemFacade |

userAndPassword := Dictionary new.
userAndPassword at: 'validUser' put: 'validUserPassword'.
catalog := Dictionary new.
catalog at: 'book' put: 10.

tusLibrosSystemFacade := TusLibrosSystemFacade authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime.

tusLibrosSystemFacade createCartFor: 'validUser' authenticatedWith: 'validUserPassword'.

tusLibrosSystemFacade add: 1 of: 'book' toCartIdentifiedAs: 1.!
!TusLibrosSystemFacade methodsFor: 'cart session management' stamp: 'FR 11/15/2021 20:59:40' prior: 50962275!
withCartSessionIdentifiedAs: aCartId do: aBlock

	| cartSession |

	cartSession := cartSessions at: aCartId ifAbsent: [self signalInvalidCartId ].
	cartSession do: aBlock.
	cartSessions at: aCartId
! !

!testRun: #TusLibrosSystemFacadeTest #test01CanCreateCartWithValidUserAndPassword stamp: 'FR 11/15/2021 20:59:40'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test02CanNotCreateCartWithInvalidUser stamp: 'FR 11/15/2021 20:59:40'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test03CanNotCreateCartWithInvalidPassword stamp: 'FR 11/15/2021 20:59:40'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test04CanAddItemsToACreatedCart stamp: 'FR 11/15/2021 20:59:40'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test05CanNotAddItemToNotCreatedCart stamp: 'FR 11/15/2021 20:59:40'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test06CanNotAddItemNotSellByTheStore stamp: 'FR 11/15/2021 20:59:40'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test07ListCartOfAnEmptyCartReturnsAnEmptyBag stamp: 'FR 11/15/2021 20:59:40'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test08CanNotListCartOfInvalidCartId stamp: 'FR 11/15/2021 20:59:40'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test09ListCartReturnsTheRightNumberOfItems stamp: 'FR 11/15/2021 20:59:40'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test10CanCheckoutACart stamp: 'FR 11/15/2021 20:59:40'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test11CanNotCheckoutANotCreatedCart stamp: 'FR 11/15/2021 20:59:40'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test12CanNotCheckoutAnEmptyCart stamp: 'FR 11/15/2021 20:59:40'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test13CanNotCheckoutWithAnExpiredCreditCard stamp: 'FR 11/15/2021 20:59:40'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test14ListPurchasesIncludesBoughtItems stamp: 'FR 11/15/2021 20:59:40'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test15CanNotListPurchasesOfInvalidCustomer stamp: 'FR 11/15/2021 20:59:40'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test16CanNotListPurchasesOfValidCustomerWithInvalidPassword stamp: 'FR 11/15/2021 20:59:40'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test17CanNotAddToCartWhenSessionIsExpired stamp: 'FR 11/15/2021 20:59:40'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test18CanNotListCartWhenSessionIsExpired stamp: 'FR 11/15/2021 20:59:40'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test19CanNotCheckOutCartWhenSessionIsExpired stamp: 'FR 11/15/2021 20:59:40'!
PASSED!

cartSessions at: aCartId!
!TusLibrosXx methodsFor: 'initialization' stamp: 'FR 11/15/2021 21:02:02' prior: 50963449!
addCreateCartService

	webServer addService: '/create-cart' action:[:request | | user password cartId cartIdAsJson |
		
		[
			user := (request fields at: 'user').
			password := (request fields at: 'password').
			cartId := tusLibrosSystemFacade 
			createCartFor: user authenticatedWith: password.
			cartIdAsJson := WebUtils jsonEncode: (cartId).
			tusLibrosSystemFacade add: 1 of: 'book' toCartIdentifiedAs: cartId.
			request send200Response: (cartIdAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	! !

| userAndPassword catalog tusLibrosXxInstance tusLibrosSystemFacade |

userAndPassword := Dictionary new.
userAndPassword at: 'validUser' put: 'validUserPassword'.
catalog := Dictionary new.
catalog at: 'book' put: 10.

tusLibrosXxInstance := TusLibrosXx listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime.!

tusLibrosXxInstance!

TusLibrosXx allInstances do: [:anInstance | anInstance destroy].
!

| userAndPassword catalog tusLibrosXxInstance tusLibrosSystemFacade |

userAndPassword := Dictionary new.
userAndPassword at: 'validUser' put: 'validUserPassword'.
catalog := Dictionary new.
catalog at: 'book' put: 10.

tusLibrosXxInstance := TusLibrosXx listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. !

tusLibrosXxInstance!
!TusLibrosXx methodsFor: 'initialization' stamp: 'FR 11/15/2021 21:10:01' prior: 50963931!
addCreateCartService

	webServer addService: '/create-cart' action:[:request | | user password cartId cartIdAsJson |
		
		[
			user := (request fields at: 'user').
			password := (request fields at: 'password').
			cartId := tusLibrosSystemFacade 
			createCartFor: user authenticatedWith: password.
			cartIdAsJson := WebUtils jsonEncode: (cartId).
			request send200Response: (cartIdAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	! !

----SNAPSHOT----(15 November 2021 21:10:13) CuisUniversity-4972.image priorSource: 20226714!

TusLibrosXx allInstances do: [:anInstance | anInstance destroy].
!
!TusLibrosXx methodsFor: 'initialization' stamp: 'FR 11/15/2021 21:14:55' prior: 50963984!
addCreateCartService

	webServer addService: '/create-cart' action:[:request | | user password cartId cartIdAsJson |
		
		[
			user := (request fields at: 'user').
			password := (request fields at: 'password').
			cartId := tusLibrosSystemFacade createCartFor: user authenticatedWith: password.
			cartIdAsJson := WebUtils jsonEncode: (cartId).
			request send200Response: (cartIdAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	! !
!TusLibrosXx methodsFor: 'initialization' stamp: 'FR 11/15/2021 21:15:16' prior: 50964008!
addCreateCartService

	webServer addService: '/create-cart' action:[:request | | user password cartId cartIdAsJson |
		
		[
			user := (request fields at: 'user').
			password := (request fields at: 'password').
			self halt.
			cartId := tusLibrosSystemFacade createCartFor: user authenticatedWith: password.
			cartIdAsJson := WebUtils jsonEncode: (cartId).
			request send200Response: (cartIdAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	! !

| userAndPassword catalog tusLibrosXxInstance tusLibrosSystemFacade |

userAndPassword := Dictionary new.
userAndPassword at: 'validUser' put: 'validUserPassword'.
catalog := Dictionary new.
catalog at: 'book' put: 10.

tusLibrosXxInstance := TusLibrosXx listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. !
!TusLibrosXx methodsFor: 'initialization' stamp: 'FR 11/15/2021 21:15:48' prior: 50964027!
addCreateCartService

	webServer addService: '/create-cart' action:[:request | | user password cartId cartIdAsJson |
		
		[
			user := (request fields at: 'user').
			password := (request fields at: 'password').
			cartId := tusLibrosSystemFacade createCartFor: user authenticatedWith: password.
			cartIdAsJson := WebUtils jsonEncode: (cartId).
			request send200Response: (cartIdAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	! !
!TusLibrosXx methodsFor: 'initialization' stamp: 'FR 11/15/2021 21:16:26' prior: 50963739!
addAddToCartService

	webServer addService: '/add-to-cart' action:[:request | | bookAmount book cartId |
		
		[
			bookAmount := (request fields at: 'bookAmount').
			book := (request fields at: 'book').
			cartId := (request fields at: 'cartId').
			self halt.
			tusLibrosSystemFacade add: bookAmount of: book toCartIdentifiedAs: cartId.
			request send200Response: (WebUtils jsonEncode: 'Book added correctly')
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	! !

TusLibrosXx allInstances do: [:anInstance | anInstance destroy].
!

| userAndPassword catalog tusLibrosXxInstance tusLibrosSystemFacade |

userAndPassword := Dictionary new.
userAndPassword at: 'validUser' put: 'validUserPassword'.
catalog := Dictionary new.
catalog at: 'book' put: 10.

tusLibrosXxInstance := TusLibrosXx listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. !

tusLibrosSystemFacade add: bookAmount of: book toCartIdentifiedAs: cartId!
!TusLibrosXx methodsFor: 'initialization' stamp: 'FR 11/15/2021 21:21:19' prior: 50964079!
addAddToCartService

	webServer addService: '/add-to-cart' action:[:request | | bookAmount book cartId |
		
		[
			bookAmount := (request fields at: 'bookAmount').
			book := (request fields at: 'book').
			cartId := (request fields at: 'cartId') asNumber.
			tusLibrosSystemFacade add: bookAmount of: book toCartIdentifiedAs: cartId.
			request send200Response: (WebUtils jsonEncode: 'Book added correctly')
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	! !

TusLibrosXx allInstances do: [:anInstance | anInstance destroy].
!

| userAndPassword catalog tusLibrosXxInstance tusLibrosSystemFacade |

userAndPassword := Dictionary new.
userAndPassword at: 'validUser' put: 'validUserPassword'.
catalog := Dictionary new.
catalog at: 'book' put: 10.

tusLibrosXxInstance := TusLibrosXx listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. !

TusLibrosXx allInstances do: [:anInstance | anInstance destroy].
!
!TusLibrosXx methodsFor: 'initialization' stamp: 'FR 11/15/2021 21:24:30' prior: 50964117!
addAddToCartService

	webServer addService: '/add-to-cart' action:[:request | | bookAmount book cartId |
		
		[
			bookAmount := (request fields at: 'bookAmount').
			book := (request fields at: 'book').
			self halt.
			cartId := (request fields at: 'cartId') asNumber.
			tusLibrosSystemFacade add: bookAmount of: book toCartIdentifiedAs: cartId.
			request send200Response: (WebUtils jsonEncode: 'Book added correctly')
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	! !
!TusLibrosXx methodsFor: 'initialization' stamp: 'FR 11/15/2021 21:24:52' prior: 50964155!
addAddToCartService

	webServer addService: '/add-to-cart' action:[:request | | bookAmount book cartId |
		
		[
			bookAmount := (request fields at: 'bookAmount') asNumber.
			book := (request fields at: 'book').
			self halt.
			cartId := (request fields at: 'cartId') asNumber.
			tusLibrosSystemFacade add: bookAmount of: book toCartIdentifiedAs: cartId.
			request send200Response: (WebUtils jsonEncode: 'Book added correctly')
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	! !
!TusLibrosXx methodsFor: 'initialization' stamp: 'FR 11/15/2021 21:24:56' prior: 50964175!
addAddToCartService

	webServer addService: '/add-to-cart' action:[:request | | bookAmount book cartId |
		
		[
			bookAmount := (request fields at: 'bookAmount') asNumber.
			book := (request fields at: 'book').
			cartId := (request fields at: 'cartId') asNumber.
			tusLibrosSystemFacade add: bookAmount of: book toCartIdentifiedAs: cartId.
			request send200Response: (WebUtils jsonEncode: 'Book added correctly')
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	! !

| userAndPassword catalog tusLibrosXxInstance tusLibrosSystemFacade |

userAndPassword := Dictionary new.
userAndPassword at: 'validUser' put: 'validUserPassword'.
catalog := Dictionary new.
catalog at: 'book' put: 10.

tusLibrosXxInstance := TusLibrosXx listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. !

----SNAPSHOT----(15 November 2021 21:26:03) CuisUniversity-4972.image priorSource: 20235243!

----STARTUP---- (17 November 2021 16:25:05) as /home/juli/Documentos/Facu/Inge1/cuis-university/CuisUniversity-4972.image!

!TusLibrosXx methodsFor: 'initialization' stamp: 'JD 11/17/2021 16:59:14'!
addListCartService

	| cartContent cartContentAsJson |
	webServer addService: '/list-cart' action:[:request | | cartId |
		
		[	
			cartId := (request fields at: 'cartId') asNumber.
			cartContent := tusLibrosSystemFacade listCart: cartId.
			cartContentAsJson := WebUtils jsonEncode: cartContent.
			request send200Response: (cartContentAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	! !

!classRenamed: #TusLibrosXx as: #TusLibrosRestAPI stamp: 'JD 11/17/2021 17:00:49'!
Smalltalk renameClassNamed: #TusLibrosXx as: #TusLibrosRestAPI!
!TusLibrosRestAPI methodsFor: 'initialization' stamp: 'JD 11/17/2021 17:02:33' prior: 50964235!
addListCartService

	| cartContent cartContentAsJson |
	webServer addService: '/list-cart' action:[:request | | cartId |
		
		[	
			cartId := (request fields at: 'cartId') asNumber.
			cartContent := tusLibrosSystemFacade listCartIdentifiedAs: cartId.
			cartContentAsJson := WebUtils jsonEncode: cartContent.
			request send200Response: (cartContentAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	! !

| userAndPassword catalog tusLibrosRestAPI |

userAndPassword := Dictionary new.
userAndPassword at: 'validUser' put: 'validUserPassword'.
catalog := Dictionary new.
catalog at: 'book' put: 10.

tusLibrosRestAPI := TusLibrosRestAPI listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. !

TusLibrosRestAPI allInstances do: [:anInstance | anInstance destroy].
!

| userAndPassword catalog tusLibrosRestAPI |

userAndPassword := Dictionary new.
userAndPassword at: 'validUser' put: 'validUserPassword'.
catalog := Dictionary new.
catalog at: 'book' put: 10.

tusLibrosRestAPI := TusLibrosRestAPI listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. !

TusLibrosRestAPI allInstances do: [:anInstance | anInstance destroy].!

| userAndPassword catalog tusLibrosRestAPI |

userAndPassword := Dictionary new.
userAndPassword at: 'validUser' put: 'validUserPassword'.
catalog := Dictionary new.
catalog at: 'book' put: 10.

tusLibrosRestAPI := TusLibrosRestAPI listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. !
!TusLibrosRestAPI methodsFor: 'initialization' stamp: 'JD 11/17/2021 17:06:43' prior: 50963758!
addServices

	self addCreateCartService.
	self addListCatalogService.
	self addAddToCartService.
	self addListCartService.! !

TusLibrosRestAPI allInstances do: [:anInstance | anInstance destroy].!

| userAndPassword catalog tusLibrosRestAPI |

userAndPassword := Dictionary new.
userAndPassword at: 'validUser' put: 'validUserPassword'.
catalog := Dictionary new.
catalog at: 'book' put: 10.

tusLibrosRestAPI := TusLibrosRestAPI listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
!
!TusLibrosRestAPI methodsFor: 'initialization' stamp: 'JD 11/17/2021 17:09:28' prior: 50964257!
addListCartService

	| cartContent cartContentAsJson |
	webServer addService: '/list-cart' action:[:request | | cartId |
		
		[	
			cartId := (request fields at: 'cartId') asNumber.
			self halt.
			cartContent := tusLibrosSystemFacade listCartIdentifiedAs: cartId.
			cartContentAsJson := WebUtils jsonEncode: cartContent.
			request send200Response: (cartContentAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	! !

TusLibrosRestAPI allInstances do: [:anInstance | anInstance destroy].!

| userAndPassword catalog tusLibrosRestAPI |

userAndPassword := Dictionary new.
userAndPassword at: 'validUser' put: 'validUserPassword'.
catalog := Dictionary new.
catalog at: 'book' put: 10.

tusLibrosRestAPI := TusLibrosRestAPI listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'JD 11/17/2021 17:15:42'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'JD 11/17/2021 17:15:42'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'JD 11/17/2021 17:15:42'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'JD 11/17/2021 17:15:42'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'JD 11/17/2021 17:15:42'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'JD 11/17/2021 17:15:42'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'JD 11/17/2021 17:15:42'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'JD 11/17/2021 17:15:42'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'JD 11/17/2021 17:15:42'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'JD 11/17/2021 17:15:42'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'JD 11/17/2021 17:15:42'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'JD 11/17/2021 17:15:42'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'JD 11/17/2021 17:15:42'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'JD 11/17/2021 17:15:42'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test01CanCreateCartWithValidUserAndPassword stamp: 'JD 11/17/2021 17:15:42'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test02CanNotCreateCartWithInvalidUser stamp: 'JD 11/17/2021 17:15:42'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test03CanNotCreateCartWithInvalidPassword stamp: 'JD 11/17/2021 17:15:42'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test04CanAddItemsToACreatedCart stamp: 'JD 11/17/2021 17:15:42'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test05CanNotAddItemToNotCreatedCart stamp: 'JD 11/17/2021 17:15:42'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test06CanNotAddItemNotSellByTheStore stamp: 'JD 11/17/2021 17:15:42'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test07ListCartOfAnEmptyCartReturnsAnEmptyBag stamp: 'JD 11/17/2021 17:15:42'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test08CanNotListCartOfInvalidCartId stamp: 'JD 11/17/2021 17:15:42'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test09ListCartReturnsTheRightNumberOfItems stamp: 'JD 11/17/2021 17:15:42'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test10CanCheckoutACart stamp: 'JD 11/17/2021 17:15:42'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test11CanNotCheckoutANotCreatedCart stamp: 'JD 11/17/2021 17:15:42'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test12CanNotCheckoutAnEmptyCart stamp: 'JD 11/17/2021 17:15:42'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test13CanNotCheckoutWithAnExpiredCreditCard stamp: 'JD 11/17/2021 17:15:42'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test14ListPurchasesIncludesBoughtItems stamp: 'JD 11/17/2021 17:15:42'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test15CanNotListPurchasesOfInvalidCustomer stamp: 'JD 11/17/2021 17:15:42'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test16CanNotListPurchasesOfValidCustomerWithInvalidPassword stamp: 'JD 11/17/2021 17:15:42'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test17CanNotAddToCartWhenSessionIsExpired stamp: 'JD 11/17/2021 17:15:42'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test18CanNotListCartWhenSessionIsExpired stamp: 'JD 11/17/2021 17:15:42'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test19CanNotCheckOutCartWhenSessionIsExpired stamp: 'JD 11/17/2021 17:15:42'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test01CanCreateCartWithValidUserAndPassword stamp: 'JD 11/17/2021 17:15:52'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test01CanCreateCartWithValidUserAndPassword stamp: 'JD 11/17/2021 17:16:59'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test02CanNotCreateCartWithInvalidUser stamp: 'JD 11/17/2021 17:16:59'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test03CanNotCreateCartWithInvalidPassword stamp: 'JD 11/17/2021 17:16:59'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test04CanAddItemsToACreatedCart stamp: 'JD 11/17/2021 17:16:59'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test05CanNotAddItemToNotCreatedCart stamp: 'JD 11/17/2021 17:16:59'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test06CanNotAddItemNotSellByTheStore stamp: 'JD 11/17/2021 17:16:59'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test07ListCartOfAnEmptyCartReturnsAnEmptyBag stamp: 'JD 11/17/2021 17:16:59'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test08CanNotListCartOfInvalidCartId stamp: 'JD 11/17/2021 17:16:59'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test09ListCartReturnsTheRightNumberOfItems stamp: 'JD 11/17/2021 17:16:59'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test10CanCheckoutACart stamp: 'JD 11/17/2021 17:16:59'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test11CanNotCheckoutANotCreatedCart stamp: 'JD 11/17/2021 17:16:59'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test12CanNotCheckoutAnEmptyCart stamp: 'JD 11/17/2021 17:16:59'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test13CanNotCheckoutWithAnExpiredCreditCard stamp: 'JD 11/17/2021 17:16:59'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test14ListPurchasesIncludesBoughtItems stamp: 'JD 11/17/2021 17:16:59'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test15CanNotListPurchasesOfInvalidCustomer stamp: 'JD 11/17/2021 17:16:59'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test16CanNotListPurchasesOfValidCustomerWithInvalidPassword stamp: 'JD 11/17/2021 17:16:59'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test17CanNotAddToCartWhenSessionIsExpired stamp: 'JD 11/17/2021 17:16:59'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test18CanNotListCartWhenSessionIsExpired stamp: 'JD 11/17/2021 17:16:59'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test19CanNotCheckOutCartWhenSessionIsExpired stamp: 'JD 11/17/2021 17:16:59'!
PASSED!

----STARTUP---- (17 November 2021 17:18:32) as /home/juli/Documentos/Facu/Inge1/cuis-university/CuisUniversity-4972.image!


!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'JD 11/17/2021 17:18:45'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'JD 11/17/2021 17:18:45'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'JD 11/17/2021 17:18:45'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'JD 11/17/2021 17:18:45'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'JD 11/17/2021 17:18:45'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'JD 11/17/2021 17:18:45'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'JD 11/17/2021 17:18:45'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'JD 11/17/2021 17:18:45'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'JD 11/17/2021 17:18:45'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'JD 11/17/2021 17:18:45'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'JD 11/17/2021 17:18:45'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'JD 11/17/2021 17:18:45'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'JD 11/17/2021 17:18:45'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'JD 11/17/2021 17:18:45'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test01CanCreateCartWithValidUserAndPassword stamp: 'JD 11/17/2021 17:18:45'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test02CanNotCreateCartWithInvalidUser stamp: 'JD 11/17/2021 17:18:45'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test03CanNotCreateCartWithInvalidPassword stamp: 'JD 11/17/2021 17:18:45'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test04CanAddItemsToACreatedCart stamp: 'JD 11/17/2021 17:18:45'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test05CanNotAddItemToNotCreatedCart stamp: 'JD 11/17/2021 17:18:45'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test06CanNotAddItemNotSellByTheStore stamp: 'JD 11/17/2021 17:18:45'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test07ListCartOfAnEmptyCartReturnsAnEmptyBag stamp: 'JD 11/17/2021 17:18:45'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test08CanNotListCartOfInvalidCartId stamp: 'JD 11/17/2021 17:18:45'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test09ListCartReturnsTheRightNumberOfItems stamp: 'JD 11/17/2021 17:18:45'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test10CanCheckoutACart stamp: 'JD 11/17/2021 17:18:45'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test11CanNotCheckoutANotCreatedCart stamp: 'JD 11/17/2021 17:18:45'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test12CanNotCheckoutAnEmptyCart stamp: 'JD 11/17/2021 17:18:45'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test13CanNotCheckoutWithAnExpiredCreditCard stamp: 'JD 11/17/2021 17:18:45'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test14ListPurchasesIncludesBoughtItems stamp: 'JD 11/17/2021 17:18:45'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test15CanNotListPurchasesOfInvalidCustomer stamp: 'JD 11/17/2021 17:18:45'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test16CanNotListPurchasesOfValidCustomerWithInvalidPassword stamp: 'JD 11/17/2021 17:18:45'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test17CanNotAddToCartWhenSessionIsExpired stamp: 'JD 11/17/2021 17:18:45'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test18CanNotListCartWhenSessionIsExpired stamp: 'JD 11/17/2021 17:18:45'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test19CanNotCheckOutCartWhenSessionIsExpired stamp: 'JD 11/17/2021 17:18:45'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test01CanCreateCartWithValidUserAndPassword stamp: 'JD 11/17/2021 17:18:54'!
ERROR!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'JD 11/17/2021 17:20:10'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'JD 11/17/2021 17:20:10'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'JD 11/17/2021 17:20:10'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'JD 11/17/2021 17:20:10'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'JD 11/17/2021 17:20:10'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'JD 11/17/2021 17:20:10'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'JD 11/17/2021 17:20:10'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'JD 11/17/2021 17:20:10'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'JD 11/17/2021 17:20:10'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'JD 11/17/2021 17:20:10'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'JD 11/17/2021 17:20:10'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'JD 11/17/2021 17:20:10'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'JD 11/17/2021 17:20:10'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'JD 11/17/2021 17:20:10'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test01CanCreateCartWithValidUserAndPassword stamp: 'JD 11/17/2021 17:20:10'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test02CanNotCreateCartWithInvalidUser stamp: 'JD 11/17/2021 17:20:10'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test03CanNotCreateCartWithInvalidPassword stamp: 'JD 11/17/2021 17:20:10'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test04CanAddItemsToACreatedCart stamp: 'JD 11/17/2021 17:20:10'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test05CanNotAddItemToNotCreatedCart stamp: 'JD 11/17/2021 17:20:10'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test06CanNotAddItemNotSellByTheStore stamp: 'JD 11/17/2021 17:20:10'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test07ListCartOfAnEmptyCartReturnsAnEmptyBag stamp: 'JD 11/17/2021 17:20:10'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test08CanNotListCartOfInvalidCartId stamp: 'JD 11/17/2021 17:20:10'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test09ListCartReturnsTheRightNumberOfItems stamp: 'JD 11/17/2021 17:20:10'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test10CanCheckoutACart stamp: 'JD 11/17/2021 17:20:10'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test11CanNotCheckoutANotCreatedCart stamp: 'JD 11/17/2021 17:20:10'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test12CanNotCheckoutAnEmptyCart stamp: 'JD 11/17/2021 17:20:10'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test13CanNotCheckoutWithAnExpiredCreditCard stamp: 'JD 11/17/2021 17:20:10'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test14ListPurchasesIncludesBoughtItems stamp: 'JD 11/17/2021 17:20:10'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test15CanNotListPurchasesOfInvalidCustomer stamp: 'JD 11/17/2021 17:20:10'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test16CanNotListPurchasesOfValidCustomerWithInvalidPassword stamp: 'JD 11/17/2021 17:20:10'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test17CanNotAddToCartWhenSessionIsExpired stamp: 'JD 11/17/2021 17:20:10'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test18CanNotListCartWhenSessionIsExpired stamp: 'JD 11/17/2021 17:20:10'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test19CanNotCheckOutCartWhenSessionIsExpired stamp: 'JD 11/17/2021 17:20:10'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test01CanCreateCartWithValidUserAndPassword stamp: 'JD 11/17/2021 17:20:16'!
ERROR!
!TusLibrosSystemFacade methodsFor: 'facade protocol' stamp: 'JD 11/17/2021 17:20:45' prior: 50962320!
listCartIdentifiedAs: aCartId

	^ self withCartSessionIdentifiedAs: aCartId do: [ :cartSession | ^ cartSession cartContent ]! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'JD 11/17/2021 17:20:49'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'JD 11/17/2021 17:20:49'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'JD 11/17/2021 17:20:49'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'JD 11/17/2021 17:20:49'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'JD 11/17/2021 17:20:49'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'JD 11/17/2021 17:20:49'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'JD 11/17/2021 17:20:49'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'JD 11/17/2021 17:20:49'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'JD 11/17/2021 17:20:49'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'JD 11/17/2021 17:20:49'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'JD 11/17/2021 17:20:49'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'JD 11/17/2021 17:20:49'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'JD 11/17/2021 17:20:49'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'JD 11/17/2021 17:20:49'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test01CanCreateCartWithValidUserAndPassword stamp: 'JD 11/17/2021 17:20:49'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test02CanNotCreateCartWithInvalidUser stamp: 'JD 11/17/2021 17:20:49'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test03CanNotCreateCartWithInvalidPassword stamp: 'JD 11/17/2021 17:20:49'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test04CanAddItemsToACreatedCart stamp: 'JD 11/17/2021 17:20:49'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test05CanNotAddItemToNotCreatedCart stamp: 'JD 11/17/2021 17:20:49'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test06CanNotAddItemNotSellByTheStore stamp: 'JD 11/17/2021 17:20:49'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test07ListCartOfAnEmptyCartReturnsAnEmptyBag stamp: 'JD 11/17/2021 17:20:49'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test08CanNotListCartOfInvalidCartId stamp: 'JD 11/17/2021 17:20:49'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test09ListCartReturnsTheRightNumberOfItems stamp: 'JD 11/17/2021 17:20:49'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test10CanCheckoutACart stamp: 'JD 11/17/2021 17:20:49'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test11CanNotCheckoutANotCreatedCart stamp: 'JD 11/17/2021 17:20:49'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test12CanNotCheckoutAnEmptyCart stamp: 'JD 11/17/2021 17:20:49'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test13CanNotCheckoutWithAnExpiredCreditCard stamp: 'JD 11/17/2021 17:20:49'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test14ListPurchasesIncludesBoughtItems stamp: 'JD 11/17/2021 17:20:49'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test15CanNotListPurchasesOfInvalidCustomer stamp: 'JD 11/17/2021 17:20:49'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test16CanNotListPurchasesOfValidCustomerWithInvalidPassword stamp: 'JD 11/17/2021 17:20:49'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test17CanNotAddToCartWhenSessionIsExpired stamp: 'JD 11/17/2021 17:20:49'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test18CanNotListCartWhenSessionIsExpired stamp: 'JD 11/17/2021 17:20:49'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test19CanNotCheckOutCartWhenSessionIsExpired stamp: 'JD 11/17/2021 17:20:49'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'JD 11/17/2021 17:21:03'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'JD 11/17/2021 17:21:03'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'JD 11/17/2021 17:21:03'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'JD 11/17/2021 17:21:03'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'JD 11/17/2021 17:21:03'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'JD 11/17/2021 17:21:03'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'JD 11/17/2021 17:21:03'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'JD 11/17/2021 17:21:03'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'JD 11/17/2021 17:21:03'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'JD 11/17/2021 17:21:03'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'JD 11/17/2021 17:21:03'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'JD 11/17/2021 17:21:03'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'JD 11/17/2021 17:21:03'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'JD 11/17/2021 17:21:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test01CanCreateCartWithValidUserAndPassword stamp: 'JD 11/17/2021 17:21:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test02CanNotCreateCartWithInvalidUser stamp: 'JD 11/17/2021 17:21:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test03CanNotCreateCartWithInvalidPassword stamp: 'JD 11/17/2021 17:21:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test04CanAddItemsToACreatedCart stamp: 'JD 11/17/2021 17:21:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test05CanNotAddItemToNotCreatedCart stamp: 'JD 11/17/2021 17:21:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test06CanNotAddItemNotSellByTheStore stamp: 'JD 11/17/2021 17:21:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test07ListCartOfAnEmptyCartReturnsAnEmptyBag stamp: 'JD 11/17/2021 17:21:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test08CanNotListCartOfInvalidCartId stamp: 'JD 11/17/2021 17:21:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test09ListCartReturnsTheRightNumberOfItems stamp: 'JD 11/17/2021 17:21:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test10CanCheckoutACart stamp: 'JD 11/17/2021 17:21:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test11CanNotCheckoutANotCreatedCart stamp: 'JD 11/17/2021 17:21:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test12CanNotCheckoutAnEmptyCart stamp: 'JD 11/17/2021 17:21:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test13CanNotCheckoutWithAnExpiredCreditCard stamp: 'JD 11/17/2021 17:21:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test14ListPurchasesIncludesBoughtItems stamp: 'JD 11/17/2021 17:21:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test15CanNotListPurchasesOfInvalidCustomer stamp: 'JD 11/17/2021 17:21:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test16CanNotListPurchasesOfValidCustomerWithInvalidPassword stamp: 'JD 11/17/2021 17:21:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test17CanNotAddToCartWhenSessionIsExpired stamp: 'JD 11/17/2021 17:21:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test18CanNotListCartWhenSessionIsExpired stamp: 'JD 11/17/2021 17:21:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test19CanNotCheckOutCartWhenSessionIsExpired stamp: 'JD 11/17/2021 17:21:03'!
PASSED!
!TusLibrosXx methodsFor: 'initialization' stamp: 'JD 11/17/2021 17:21:56'!
addListCartService

 | cartContent cartContentAsJson |
	 webServer addService: '/list-cart' action:[:request | | cartId |
		  [
		   cartId := (request fields at: 'cartId') asNumber.
		   cartContent := tusLibrosSystemFacade listCartIdentifiedAs: cartId.
		   cartContentAsJson := WebUtils jsonEncode: cartContent.
		   request send200Response: (cartContentAsJson)
		   ]
	  on: Error
	  do: [ :anError |
	   request send400Response: (anError messageText) ]].
	
	! !
!TusLibrosXx methodsFor: 'initialization' stamp: 'JD 11/17/2021 17:22:14' prior: 50964717!
addListCartService

 | cartContent cartContentAsJson |
	 webServer addService: '/list-cart' action:[:request | | cartId |

		  [
			   cartId := (request fields at: 'cartId') asNumber.
			   cartContent := tusLibrosSystemFacade listCartIdentifiedAs: cartId.
			   cartContentAsJson := WebUtils jsonEncode: cartContent.
			   request send200Response: (cartContentAsJson)
		   ]
	  on: Error
	  do: [ :anError |
	   request send400Response: (anError messageText) ]].
	
	! !
!TusLibrosXx methodsFor: 'initialization' stamp: 'JD 11/17/2021 17:22:30' prior: 50964735!
addListCartService

 | cartContent cartContentAsJson |
	 webServer addService: '/list-cart' action:[:request | | cartId |

		  [
			   cartId := (request fields at: 'cartId') asNumber.
			   cartContent := tusLibrosSystemFacade listCartIdentifiedAs: cartId.
			   cartContentAsJson := WebUtils jsonEncode: cartContent.
			   request send200Response: (cartContentAsJson)
		   ]
	  on: Error
	  do: [ :anError |
	   	request send400Response: (anError messageText) ]].
	
	! !
!TusLibrosXx methodsFor: 'initialization' stamp: 'JD 11/17/2021 17:23:02' prior: 50964753!
addListCartService

	 webServer addService: '/list-cart' action:[:request | | cartId cartContent cartContentAsJson |

		  [
			   cartId := (request fields at: 'cartId') asNumber.
			   cartContent := tusLibrosSystemFacade listCartIdentifiedAs: cartId.
			   cartContentAsJson := WebUtils jsonEncode: cartContent.
			   request send200Response: (cartContentAsJson)
		   ]
	  on: Error
	  do: [ :anError |
	   	  request send400Response: (anError messageText) ]].
	
	! !
!TusLibrosXx methodsFor: 'initialization' stamp: 'JD 11/17/2021 17:23:12' prior: 50964771!
addListCartService

	 webServer addService: '/list-cart' action:[:request | | cartId cartContent cartContentAsJson |

		  [
			   cartId := (request fields at: 'cartId') asNumber.
			   cartContent := tusLibrosSystemFacade listCartIdentifiedAs: cartId.
			   cartContentAsJson := WebUtils jsonEncode: cartContent.
			   request send200Response: (cartContentAsJson)
		   ]
		  on: Error
		  do: [ :anError |
		   	  request send400Response: (anError messageText) ]].
	
	! !

TusLibrosXx allInstances do: [:anInstance | anInstance destroy].!

TusLibrosXx allInstances do: [:anInstance | anInstance destroy].!

| userAndPassword catalog tusLibrosXxInstance |

userAndPassword := Dictionary new.
userAndPassword at: 'validUser' put: 'validUserPassword'.
catalog := Dictionary new.
catalog at: 'book' put: 10.

tusLibrosXxInstance := TusLibrosXx listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. !
!TusLibrosXx methodsFor: 'initialization' stamp: 'JD 11/17/2021 17:24:12' prior: 50963758!
addServices

	self addCreateCartService.
	self addListCatalogService.
	self addAddToCartService.
	self addListCartService.! !

TusLibrosXx allInstances do: [:anInstance | anInstance destroy].!

| userAndPassword catalog tusLibrosXxInstance |

userAndPassword := Dictionary new.
userAndPassword at: 'validUser' put: 'validUserPassword'.
catalog := Dictionary new.
catalog at: 'book' put: 10.

tusLibrosXxInstance := TusLibrosXx listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. !
!TusLibrosXx methodsFor: 'initialization' stamp: 'JD 11/17/2021 17:29:43' prior: 50964789!
addListCartService

	 webServer addService: '/list-cart' action:[:request | | cartId cartContent cartContentAsJson |

		  [
			   cartId := (request fields at: 'cartId') asNumber.	
			   self halt.
			   cartContent := tusLibrosSystemFacade listCartIdentifiedAs: cartId.
			   cartContentAsJson := WebUtils jsonEncode: cartContent.
			   request send200Response: (cartContentAsJson)
		   ]
		  on: Error
		  do: [ :anError |
		   	  request send400Response: (anError messageText) ]].
	
	! !

TusLibrosXx allInstances do: [:anInstance | anInstance destroy].!

| userAndPassword catalog tusLibrosXxInstance |

userAndPassword := Dictionary new.
userAndPassword at: 'validUser' put: 'validUserPassword'.
catalog := Dictionary new.
catalog at: 'book' put: 10.

tusLibrosXxInstance := TusLibrosXx listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. !
!WebUtils class methodsFor: 'json-encode' stamp: 'JD 11/17/2021 17:34:43' prior: 50959685!
jsonObj: anObject on: stream
	"Encode a generic object"

	anObject isString ifTrue:[^self jsonString: anObject on: stream].
	anObject isNumber ifTrue:[^self jsonNumber: anObject on: stream].
	anObject == nil ifTrue:[^stream nextPutAll: 'null'].
	anObject == true ifTrue:[^stream nextPutAll: 'true'].
	anObject == false ifTrue:[^stream nextPutAll: 'false'].
	anObject isArray ifTrue:[^self jsonArray: anObject on: stream].
	(anObject is: #Dictionary) ifTrue:[^self jsonMap: anObject on: stream].
	(anObject is: #Bag) ifTrue:[^self jsonMap: anObject on: stream].

	self error: 'Cannot encode: ', anObject! !

allInstances!

| userAndPassword catalog tusLibrosXxInstance |

userAndPassword := Dictionary new.
userAndPassword at: 'validUser' put: 'validUserPassword'.
catalog := Dictionary new.
catalog at: 'book' put: 10.

tusLibrosXxInstance := TusLibrosXx listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. !
!WebUtils class methodsFor: 'json-encode' stamp: 'JD 11/17/2021 17:36:00' prior: 50964882!
jsonObj: anObject on: stream
	"Encode a generic object"

	anObject isString ifTrue:[^self jsonString: anObject on: stream].
	anObject isNumber ifTrue:[^self jsonNumber: anObject on: stream].
	anObject == nil ifTrue:[^stream nextPutAll: 'null'].
	anObject == true ifTrue:[^stream nextPutAll: 'true'].
	anObject == false ifTrue:[^stream nextPutAll: 'false'].
	anObject isArray ifTrue:[^self jsonArray: anObject on: stream].
	(anObject is: #Dictionary) ifTrue:[^self jsonMap: anObject on: stream].
	(anObject is: #Bag) ifTrue:[^self jsonArray: anObject on: stream].

	self error: 'Cannot encode: ', anObject! !

TusLibrosXx allInstances do: [:anInstance | anInstance destroy].!

| userAndPassword catalog tusLibrosXxInstance |

userAndPassword := Dictionary new.
userAndPassword at: 'validUser' put: 'validUserPassword'.
catalog := Dictionary new.
catalog at: 'book' put: 10.

tusLibrosXxInstance := TusLibrosXx listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
!
!TusLibrosXx methodsFor: 'initialization' stamp: 'JD 11/17/2021 17:36:45' prior: 50964848!
addListCartService

	 webServer addService: '/list-cart' action:[:request | | cartId cartContent cartContentAsJson |

		  [
			   cartId := (request fields at: 'cartId') asNumber.	
			   self halt.
			   cartContent := tusLibrosSystemFacade listCartIdentifiedAs: cartId.
			   cartContentAsJson := WebUtils jsonEncode: cartContent asArray.
			   request send200Response: (cartContentAsJson)
		   ]
		  on: Error
		  do: [ :anError |
		   	  request send400Response: (anError messageText) ]].
	
	! !

TusLibrosXx allInstances do: [:anInstance | anInstance destroy].!
!TusLibrosXx methodsFor: 'initialization' stamp: 'JD 11/17/2021 17:36:53' prior: 50964956!
addListCartService

	 webServer addService: '/list-cart' action:[:request | | cartId cartContent cartContentAsJson |

		  [
			   cartId := (request fields at: 'cartId') asNumber.	
			   cartContent := tusLibrosSystemFacade listCartIdentifiedAs: cartId.
			   cartContentAsJson := WebUtils jsonEncode: cartContent asArray.
			   request send200Response: (cartContentAsJson)
		   ]
		  on: Error
		  do: [ :anError |
		   	  request send400Response: (anError messageText) ]].
	
	! !

TusLibrosXx allInstances do: [:anInstance | anInstance destroy].!

| userAndPassword catalog tusLibrosXxInstance |

userAndPassword := Dictionary new.
userAndPassword at: 'validUser' put: 'validUserPassword'.
catalog := Dictionary new.
catalog at: 'book' put: 10.

tusLibrosXxInstance := TusLibrosXx listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. !
!WebUtils class methodsFor: 'json-encode' stamp: 'JD 11/17/2021 17:37:19' prior: 50964918!
jsonObj: anObject on: stream
	"Encode a generic object"

	anObject isString ifTrue:[^self jsonString: anObject on: stream].
	anObject isNumber ifTrue:[^self jsonNumber: anObject on: stream].
	anObject == nil ifTrue:[^stream nextPutAll: 'null'].
	anObject == true ifTrue:[^stream nextPutAll: 'true'].
	anObject == false ifTrue:[^stream nextPutAll: 'false'].
	anObject isArray ifTrue:[^self jsonArray: anObject on: stream].
	(anObject is: #Dictionary) ifTrue:[^self jsonMap: anObject on: stream].

	self error: 'Cannot encode: ', anObject! !

!classRenamed: #TusLibrosXx as: #TusLibrosRestAPI stamp: 'JD 11/17/2021 17:39:00'!
Smalltalk renameClassNamed: #TusLibrosXx as: #TusLibrosRestAPI!
!TusLibrosRestAPI methodsFor: 'initialization' stamp: 'JD 11/17/2021 17:48:26'!
addCheckoutCartService

	webServer addService: '/list-catalog' action:[:request | | cartId cardNumber cardExpirationDate cardOwner ticket |
		
		[	
			cartId := (request fields at: 'cartId') asNumber.
			cardNumber := (request fields at: 'ccn') asNumber.
			cardExpirationDate := request fields at: 'cced'.
			cardOwner := request fields at: 'cco'.
			ticket := tusLibrosSystemFacade checkOutCartIdentifiedAs: cartId withCreditCardNumbered: cardNumber ownedBy: cardOwner expiringOn: cardExpirationDate.
			ticket := WebUtils jsonEncode: ticket.
			request send200Response: ticket
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	! !
!TusLibrosRestAPI methodsFor: 'initialization' stamp: 'JD 11/17/2021 17:48:40' prior: 50964825!
addServices

	self addCreateCartService.
	self addListCatalogService.
	self addAddToCartService.
	self addListCartService.
	self addCheckoutCartService.! !
!TusLibrosRestAPI methodsFor: 'initialization' stamp: 'JD 11/17/2021 17:50:58'!
addListPurchasesService

	webServer addService: '/list-catalog' action:[:request | | user password purchasesList purchasesListAsJson |
		
		[	
			user := (request fields at: 'user').
			password := (request fields at: 'password').
			purchasesList := tusLibrosSystemFacade listPurchasesOf: user  authenticatingWith: password.
			purchasesListAsJson := WebUtils jsonEncode: purchasesList.
			request send200Response: purchasesListAsJson
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	! !
!TusLibrosRestAPI methodsFor: 'initialization' stamp: 'JD 11/17/2021 17:51:19' prior: 50965068!
addListPurchasesService

	webServer addService: '/list-purchases' action:[:request | | user password purchasesList purchasesListAsJson |
		
		[	
			user := (request fields at: 'user').
			password := (request fields at: 'password').
			purchasesList := tusLibrosSystemFacade listPurchasesOf: user  authenticatingWith: password.
			purchasesListAsJson := WebUtils jsonEncode: purchasesList.
			request send200Response: purchasesListAsJson
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	! !
!TusLibrosRestAPI methodsFor: 'initialization' stamp: 'JD 11/17/2021 17:51:27' prior: 50965035!
addCheckoutCartService

	webServer addService: '/checkout-cart' action:[:request | | cartId cardNumber cardExpirationDate cardOwner ticket |
		
		[	
			cartId := (request fields at: 'cartId') asNumber.
			cardNumber := (request fields at: 'ccn') asNumber.
			cardExpirationDate := request fields at: 'cced'.
			cardOwner := request fields at: 'cco'.
			ticket := tusLibrosSystemFacade checkOutCartIdentifiedAs: cartId withCreditCardNumbered: cardNumber ownedBy: cardOwner expiringOn: cardExpirationDate.
			ticket := WebUtils jsonEncode: ticket.
			request send200Response: ticket
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	! !
!TusLibrosRestAPI methodsFor: 'initialization' stamp: 'JD 11/17/2021 18:04:53' prior: 50965108!
addCheckoutCartService

	webServer addService: '/checkout-cart' action:[:request | | cartId cardNumber cardExpirationDate cardOwner ticket |
		
		[	
			cartId := (request fields at: 'cartId') asNumber.
			cardNumber := (request fields at: 'ccn') asNumber.
			cardExpirationDate := Month readFrom: (request fields at: 'cced').
			cardOwner := request fields at: 'cco'.
			ticket := tusLibrosSystemFacade checkOutCartIdentifiedAs: cartId withCreditCardNumbered: cardNumber ownedBy: cardOwner expiringOn: cardExpirationDate.
			ticket := WebUtils jsonEncode: ticket.
			request send200Response: ticket
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	! !

TusLibrosRestAPI allInstances do: [:anInstance | anInstance destroy].!

| userAndPassword catalog tusLibrosXxInstance |

userAndPassword := Dictionary new.
userAndPassword at: 'validUser' put: 'validUserPassword'.
catalog := Dictionary new.
catalog at: 'book' put: 10.

tusLibrosXxInstance := TusLibrosRestAPI listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
!
!TusLibrosRestAPI methodsFor: 'initialization' stamp: 'JD 11/17/2021 18:08:16' prior: 50965133!
addCheckoutCartService

	webServer addService: '/checkout-cart' action:[:request | | cartId cardNumber cardExpirationDate cardOwner ticket |
		
		[	
			cartId := (request fields at: 'cartId') asNumber.
			cardNumber := (request fields at: 'ccn') asNumber.
			cardExpirationDate := Month readFrom: (request fields at: 'cced').
			cardOwner := request fields at: 'cco'.
			ticket := tusLibrosSystemFacade checkOutCartIdentifiedAs: cartId withCreditCardNumbered: cardNumber ownedBy: cardOwner expiringOn: cardExpirationDate.
			request send200Response: 'OK'
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	! !
!TusLibrosRestAPI methodsFor: 'initialization' stamp: 'JD 11/17/2021 18:08:27' prior: 50965174!
addCheckoutCartService

	webServer addService: '/checkout-cart' action:[:request | | cartId cardNumber cardExpirationDate cardOwner |
		
		[	
			cartId := (request fields at: 'cartId') asNumber.
			cardNumber := (request fields at: 'ccn') asNumber.
			cardExpirationDate := Month readFrom: (request fields at: 'cced').
			cardOwner := request fields at: 'cco'.
			tusLibrosSystemFacade checkOutCartIdentifiedAs: cartId withCreditCardNumbered: cardNumber ownedBy: cardOwner expiringOn: cardExpirationDate.
			request send200Response: 'OK'
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	! !

TusLibrosRestAPI allInstances do: [:anInstance | anInstance destroy].!

| userAndPassword catalog tusLibrosXxInstance |

userAndPassword := Dictionary new.
userAndPassword at: 'validUser' put: 'validUserPassword'.
catalog := Dictionary new.
catalog at: 'book' put: 10.

tusLibrosXxInstance := TusLibrosRestAPI listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. !
!TusLibrosRestAPI methodsFor: 'initialization' stamp: 'JD 11/17/2021 18:09:20' prior: 50965198!
addCheckoutCartService

	webServer addService: '/checkout-cart' action:[:request | | cartId cardNumber cardExpirationDate cardOwner |
		
		[	
			self halt.
			cartId := (request fields at: 'cartId') asNumber.
			cardNumber := (request fields at: 'ccn') asNumber.
			cardExpirationDate := Month readFrom: (request fields at: 'cced').
			cardOwner := request fields at: 'cco'.
			tusLibrosSystemFacade checkOutCartIdentifiedAs: cartId withCreditCardNumbered: cardNumber ownedBy: cardOwner expiringOn: cardExpirationDate.
			request send200Response: 'OK'
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	! !

TusLibrosRestAPI allInstances do: [:anInstance | anInstance destroy].!

| userAndPassword catalog tusLibrosXxInstance |

userAndPassword := Dictionary new.
userAndPassword at: 'validUser' put: 'validUserPassword'.
catalog := Dictionary new.
catalog at: 'book' put: 10.

tusLibrosXxInstance := TusLibrosRestAPI listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
!

(request fields at: 'cced')!

(request fields at: 'cced')!

(request fields at: 'cced')!

Month readFrom: (request fields at: 'cced')!
!TusLibrosRestAPI methodsFor: 'initialization' stamp: 'JD 11/17/2021 18:11:43' prior: 50965237!
addCheckoutCartService

	webServer addService: '/checkout-cart' action:[:request | | cartId cardNumber cardExpirationDate cardOwner |
		
		[	
			self halt.
			cartId := (request fields at: 'cartId') asNumber.
			cardNumber := (request fields at: 'ccn') asNumber.
			cardExpirationDate := Month readFrom: (ReadStream on: (request fields at: 'cced')).
			cardOwner := request fields at: 'cco'.
			tusLibrosSystemFacade checkOutCartIdentifiedAs: cartId withCreditCardNumbered: cardNumber ownedBy: cardOwner expiringOn: cardExpirationDate.
			request send200Response: 'OK'
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	! !

TusLibrosRestAPI allInstances do: [:anInstance | anInstance destroy].!

| userAndPassword catalog tusLibrosXxInstance |

userAndPassword := Dictionary new.
userAndPassword at: 'validUser' put: 'validUserPassword'.
catalog := Dictionary new.
catalog at: 'book' put: 10.

tusLibrosXxInstance := TusLibrosRestAPI listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. !
!TusLibrosRestAPI methodsFor: 'initialization' stamp: 'JD 11/17/2021 18:12:40' prior: 50965060!
addServices

	self addCreateCartService.
	self addListCatalogService.
	self addAddToCartService.
	self addListCartService.
	self addCheckoutCartService.
	self addListPurchasesService.! !

TusLibrosRestAPI allInstances do: [:anInstance | anInstance destroy].!

| userAndPassword catalog tusLibrosXxInstance |

userAndPassword := Dictionary new.
userAndPassword at: 'validUser' put: 'validUserPassword'.
catalog := Dictionary new.
catalog at: 'book' put: 10.

tusLibrosXxInstance := TusLibrosRestAPI listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. !
!TusLibrosRestAPI methodsFor: 'initialization' stamp: 'JD 11/17/2021 18:14:06' prior: 50965281!
addCheckoutCartService

	webServer addService: '/checkout-cart' action:[:request | | cartId cardNumber cardExpirationDate cardOwner |
		
		[	
			cartId := (request fields at: 'cartId') asNumber.
			cardNumber := (request fields at: 'ccn') asNumber.
			cardExpirationDate := Month readFrom: (ReadStream on: (request fields at: 'cced')).
			cardOwner := request fields at: 'cco'.
			tusLibrosSystemFacade checkOutCartIdentifiedAs: cartId withCreditCardNumbered: cardNumber ownedBy: cardOwner expiringOn: cardExpirationDate.
			request send200Response: 'OK'
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	! !
!TusLibrosSystemFacade methodsFor: 'facade protocol' stamp: 'JD 11/17/2021 18:21:44'!
remove: aBook fromCartIdentifiedAs: aCartId

	self withCartSessionIdentifiedAs: aCartId do: [ :cartSession | cartSession remove: aBook ]! !

!methodRemoval: TusLibrosSystemFacade #remove:fromCartIdentifiedAs: stamp: 'JD 11/17/2021 18:21:56'!
remove: aBook fromCartIdentifiedAs: aCartId

	self withCartSessionIdentifiedAs: aCartId do: [ :cartSession | cartSession remove: aBook ]!
!TusLibrosSystemFacadeTest methodsFor: 'tests - checkout' stamp: 'JD 11/17/2021 18:27:33'!
test20CannotRemoveABookNotPresentInTheCart

	| cartId |

	cartId := systemFacade createCartFor: self validUser authenticatedWith: self validUserPassword.
	self should: [
		systemFacade remove: self validBook fromCart: cartId]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText equals: systemFacade canNotRemoveParameterFromBinaryMessagesErrorMessage.
			self assert: (systemFacade listCartIdentifiedAs: cartId) isEmpty ]


	! !
!TusLibrosSystemFacadeTest methodsFor: 'tests - checkout' stamp: 'JD 11/17/2021 18:27:53' prior: 50965385!
test20CannotRemoveABookNotPresentInTheCart

	| cartId |

	cartId := systemFacade createCartFor: self validUser authenticatedWith: self validUserPassword.
	self should: [
		systemFacade remove: self validBook fromCart: cartId]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText equals: systemFacade cannotRemoveANonPresentBookErrorMessage.
			self assert: (systemFacade listCartIdentifiedAs: cartId) isEmpty ]


	! !

!testRun: #TusLibrosSystemFacadeTest #test20CannotRemoveABookNotPresentInTheCart stamp: 'JD 11/17/2021 18:28:03'!
ERROR!
!TusLibrosSystemFacade methodsFor: 'facade protocol' stamp: 'JD 11/17/2021 18:28:10'!
remove: aString fromCart: aSmallInteger 
	self shouldBeImplemented.! !
!TusLibrosSystemFacade methodsFor: 'facade protocol' stamp: 'JD 11/17/2021 18:30:07' prior: 50965426!
remove: aBook fromCart: aCartId
	
	self assert: ((self listCartIdentifiedAs: aCartId) includes: aBook) description: TusLibrosSystemFacade cannotRemoveANonPresentBookErrorMessage! !

!testRun: #TusLibrosSystemFacadeTest #test20CannotRemoveABookNotPresentInTheCart stamp: 'JD 11/17/2021 18:30:11'!
ERROR!
!TusLibrosSystemFacade class methodsFor: 'as yet unclassified' stamp: 'JD 11/17/2021 18:30:22'!
cannotRemoveANonPresentBookErrorMessage
	self shouldBeImplemented.! !
!TusLibrosSystemFacade class methodsFor: 'as yet unclassified' stamp: 'JD 11/17/2021 18:30:37' prior: 50965445!
cannotRemoveANonPresentBookErrorMessage
	
	^ 'Cannot remove a non present book.'! !
!TusLibrosSystemFacadeTest methodsFor: 'tests - checkout' stamp: 'JD 11/17/2021 18:31:04' prior: 50965404!
test20CannotRemoveABookNotPresentInTheCart

	| cartId |

	cartId := systemFacade createCartFor: self validUser authenticatedWith: self validUserPassword.
	self should: [
		systemFacade remove: self validBook fromCart: cartId]
		raise: AssertionFailure - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText equals: systemFacade cannotRemoveANonPresentBookErrorMessage.
			self assert: (systemFacade listCartIdentifiedAs: cartId) isEmpty ]


	! !

!testRun: #TusLibrosSystemFacadeTest #test20CannotRemoveABookNotPresentInTheCart stamp: 'JD 11/17/2021 18:31:05'!
ERROR!
!TusLibrosSystemFacadeTest methodsFor: 'tests - checkout' stamp: 'JD 11/17/2021 18:31:18' prior: 50965457!
test20CannotRemoveABookNotPresentInTheCart

	| cartId |

	cartId := systemFacade createCartFor: self validUser authenticatedWith: self validUserPassword.
	self should: [
		systemFacade remove: self validBook fromCart: cartId]
		raise: AssertionFailure - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText equals: TusLibrosSystemFacade cannotRemoveANonPresentBookErrorMessage.
			self assert: (systemFacade listCartIdentifiedAs: cartId) isEmpty ]


	! !

!testRun: #TusLibrosSystemFacadeTest #test20CannotRemoveABookNotPresentInTheCart stamp: 'JD 11/17/2021 18:31:19'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'JD 11/17/2021 18:31:19'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'JD 11/17/2021 18:31:19'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'JD 11/17/2021 18:31:19'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'JD 11/17/2021 18:31:19'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'JD 11/17/2021 18:31:19'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'JD 11/17/2021 18:31:19'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'JD 11/17/2021 18:31:19'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'JD 11/17/2021 18:31:19'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'JD 11/17/2021 18:31:19'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'JD 11/17/2021 18:31:19'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'JD 11/17/2021 18:31:19'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'JD 11/17/2021 18:31:19'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'JD 11/17/2021 18:31:19'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'JD 11/17/2021 18:31:19'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test01CanCreateCartWithValidUserAndPassword stamp: 'JD 11/17/2021 18:31:19'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test02CanNotCreateCartWithInvalidUser stamp: 'JD 11/17/2021 18:31:19'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test03CanNotCreateCartWithInvalidPassword stamp: 'JD 11/17/2021 18:31:19'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test04CanAddItemsToACreatedCart stamp: 'JD 11/17/2021 18:31:19'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test05CanNotAddItemToNotCreatedCart stamp: 'JD 11/17/2021 18:31:19'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test06CanNotAddItemNotSellByTheStore stamp: 'JD 11/17/2021 18:31:19'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test07ListCartOfAnEmptyCartReturnsAnEmptyBag stamp: 'JD 11/17/2021 18:31:19'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test08CanNotListCartOfInvalidCartId stamp: 'JD 11/17/2021 18:31:19'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test09ListCartReturnsTheRightNumberOfItems stamp: 'JD 11/17/2021 18:31:19'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test10CanCheckoutACart stamp: 'JD 11/17/2021 18:31:19'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test11CanNotCheckoutANotCreatedCart stamp: 'JD 11/17/2021 18:31:19'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test12CanNotCheckoutAnEmptyCart stamp: 'JD 11/17/2021 18:31:19'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test13CanNotCheckoutWithAnExpiredCreditCard stamp: 'JD 11/17/2021 18:31:19'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test14ListPurchasesIncludesBoughtItems stamp: 'JD 11/17/2021 18:31:19'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test15CanNotListPurchasesOfInvalidCustomer stamp: 'JD 11/17/2021 18:31:19'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test16CanNotListPurchasesOfValidCustomerWithInvalidPassword stamp: 'JD 11/17/2021 18:31:19'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test17CanNotAddToCartWhenSessionIsExpired stamp: 'JD 11/17/2021 18:31:19'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test18CanNotListCartWhenSessionIsExpired stamp: 'JD 11/17/2021 18:31:19'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test19CanNotCheckOutCartWhenSessionIsExpired stamp: 'JD 11/17/2021 18:31:19'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test20CannotRemoveABookNotPresentInTheCart stamp: 'JD 11/17/2021 18:31:19'!
PASSED!
!TusLibrosSystemFacadeTest methodsFor: 'tests - checkout' stamp: 'JD 11/17/2021 18:34:13'!
test21CannotRemoveABookFromANotCreatedCart

	self should: [
		systemFacade remove: self validBook fromCart: self invalidCartId ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText equals: systemFacade invalidCartIdErrorDescription ]


	! !
!CartSession methodsFor: 'error signal' stamp: 'JD 11/17/2021 18:40:56'!
signalCannotRemoveANonPresentBook

	self error: systemFacade cannotRemoveANonPresentBookErrorMessage ! !

!methodRemoval: TusLibrosSystemFacade class #cannotRemoveANonPresentBookErrorMessage stamp: 'JD 11/17/2021 18:41:10'!
cannotRemoveANonPresentBookErrorMessage
	
	^ 'Cannot remove a non present book.'!
!TusLibrosSystemFacade methodsFor: 'error messages' stamp: 'JD 11/17/2021 18:41:25'!
cannotRemoveANonPresentBookErrorMessage
	
	^ 'Cannot remove a non present book.'! !
!CartSession methodsFor: 'cart' stamp: 'JD 11/17/2021 18:41:32'!
removeBook: aBook
	
	(self cartContent includes: aBook) ifFalse: [ self signalCannotRemoveANonPresentBook ].
	! !
!TusLibrosSystemFacade methodsFor: 'facade protocol' stamp: 'JD 11/17/2021 18:42:34' prior: 50965432!
remove: aBook fromCart: aCartId
	
	(cartSessions at: aCartId) removeBook: aBook! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'JD 11/17/2021 18:42:42'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'JD 11/17/2021 18:42:42'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'JD 11/17/2021 18:42:42'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'JD 11/17/2021 18:42:42'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'JD 11/17/2021 18:42:42'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'JD 11/17/2021 18:42:42'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'JD 11/17/2021 18:42:42'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'JD 11/17/2021 18:42:42'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'JD 11/17/2021 18:42:42'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'JD 11/17/2021 18:42:42'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'JD 11/17/2021 18:42:42'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'JD 11/17/2021 18:42:42'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'JD 11/17/2021 18:42:42'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'JD 11/17/2021 18:42:42'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test01CanCreateCartWithValidUserAndPassword stamp: 'JD 11/17/2021 18:42:42'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test02CanNotCreateCartWithInvalidUser stamp: 'JD 11/17/2021 18:42:42'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test03CanNotCreateCartWithInvalidPassword stamp: 'JD 11/17/2021 18:42:42'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test04CanAddItemsToACreatedCart stamp: 'JD 11/17/2021 18:42:42'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test05CanNotAddItemToNotCreatedCart stamp: 'JD 11/17/2021 18:42:42'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test06CanNotAddItemNotSellByTheStore stamp: 'JD 11/17/2021 18:42:43'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test07ListCartOfAnEmptyCartReturnsAnEmptyBag stamp: 'JD 11/17/2021 18:42:43'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test08CanNotListCartOfInvalidCartId stamp: 'JD 11/17/2021 18:42:43'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test09ListCartReturnsTheRightNumberOfItems stamp: 'JD 11/17/2021 18:42:43'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test10CanCheckoutACart stamp: 'JD 11/17/2021 18:42:43'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test11CanNotCheckoutANotCreatedCart stamp: 'JD 11/17/2021 18:42:43'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test12CanNotCheckoutAnEmptyCart stamp: 'JD 11/17/2021 18:42:43'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test13CanNotCheckoutWithAnExpiredCreditCard stamp: 'JD 11/17/2021 18:42:43'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test14ListPurchasesIncludesBoughtItems stamp: 'JD 11/17/2021 18:42:43'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test15CanNotListPurchasesOfInvalidCustomer stamp: 'JD 11/17/2021 18:42:43'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test16CanNotListPurchasesOfValidCustomerWithInvalidPassword stamp: 'JD 11/17/2021 18:42:43'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test17CanNotAddToCartWhenSessionIsExpired stamp: 'JD 11/17/2021 18:42:43'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test18CanNotListCartWhenSessionIsExpired stamp: 'JD 11/17/2021 18:42:43'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test19CanNotCheckOutCartWhenSessionIsExpired stamp: 'JD 11/17/2021 18:42:43'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test20CannotRemoveABookNotPresentInTheCart stamp: 'JD 11/17/2021 18:42:43'!
ERROR!

!testRun: #TusLibrosSystemFacadeTest #test21CannotRemoveABookFromANotCreatedCart stamp: 'JD 11/17/2021 18:42:43'!
FAILURE!
!TusLibrosSystemFacadeTest methodsFor: 'tests - checkout' stamp: 'JD 11/17/2021 18:42:53' prior: 50965480!
test20CannotRemoveABookNotPresentInTheCart

	| cartId |

	cartId := systemFacade createCartFor: self validUser authenticatedWith: self validUserPassword.
	self should: [
		systemFacade remove: self validBook fromCart: cartId]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText equals: systemFacade cannotRemoveANonPresentBookErrorMessage.
			self assert: (systemFacade listCartIdentifiedAs: cartId) isEmpty ]


	! !

!testRun: #TusLibrosSystemFacadeTest #test20CannotRemoveABookNotPresentInTheCart stamp: 'JD 11/17/2021 18:42:54'!
PASSED!
!TusLibrosSystemFacade methodsFor: 'facade protocol' stamp: 'JD 11/17/2021 18:43:42' prior: 50965660!
remove: aBook fromCart: aCartId
	
	cartSessions at: aCartId ifAbsent: [self signalInvalidCartId ].
	(cartSessions at: aCartId) removeBook: aBook! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'JD 11/17/2021 18:43:44'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'JD 11/17/2021 18:43:44'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'JD 11/17/2021 18:43:44'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'JD 11/17/2021 18:43:44'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'JD 11/17/2021 18:43:44'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'JD 11/17/2021 18:43:44'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'JD 11/17/2021 18:43:44'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'JD 11/17/2021 18:43:44'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'JD 11/17/2021 18:43:44'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'JD 11/17/2021 18:43:44'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'JD 11/17/2021 18:43:44'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'JD 11/17/2021 18:43:44'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'JD 11/17/2021 18:43:44'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'JD 11/17/2021 18:43:44'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test01CanCreateCartWithValidUserAndPassword stamp: 'JD 11/17/2021 18:43:44'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test02CanNotCreateCartWithInvalidUser stamp: 'JD 11/17/2021 18:43:44'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test03CanNotCreateCartWithInvalidPassword stamp: 'JD 11/17/2021 18:43:44'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test04CanAddItemsToACreatedCart stamp: 'JD 11/17/2021 18:43:44'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test05CanNotAddItemToNotCreatedCart stamp: 'JD 11/17/2021 18:43:44'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test06CanNotAddItemNotSellByTheStore stamp: 'JD 11/17/2021 18:43:44'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test07ListCartOfAnEmptyCartReturnsAnEmptyBag stamp: 'JD 11/17/2021 18:43:44'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test08CanNotListCartOfInvalidCartId stamp: 'JD 11/17/2021 18:43:44'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test09ListCartReturnsTheRightNumberOfItems stamp: 'JD 11/17/2021 18:43:44'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test10CanCheckoutACart stamp: 'JD 11/17/2021 18:43:44'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test11CanNotCheckoutANotCreatedCart stamp: 'JD 11/17/2021 18:43:44'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test12CanNotCheckoutAnEmptyCart stamp: 'JD 11/17/2021 18:43:44'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test13CanNotCheckoutWithAnExpiredCreditCard stamp: 'JD 11/17/2021 18:43:44'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test14ListPurchasesIncludesBoughtItems stamp: 'JD 11/17/2021 18:43:44'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test15CanNotListPurchasesOfInvalidCustomer stamp: 'JD 11/17/2021 18:43:44'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test16CanNotListPurchasesOfValidCustomerWithInvalidPassword stamp: 'JD 11/17/2021 18:43:44'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test17CanNotAddToCartWhenSessionIsExpired stamp: 'JD 11/17/2021 18:43:44'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test18CanNotListCartWhenSessionIsExpired stamp: 'JD 11/17/2021 18:43:44'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test19CanNotCheckOutCartWhenSessionIsExpired stamp: 'JD 11/17/2021 18:43:44'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test20CannotRemoveABookNotPresentInTheCart stamp: 'JD 11/17/2021 18:43:44'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test21CannotRemoveABookFromANotCreatedCart stamp: 'JD 11/17/2021 18:43:44'!
PASSED!
!TusLibrosSystemFacadeTest methodsFor: 'tests - checkout' stamp: 'JD 11/17/2021 18:46:17'!
test22CannotRemoveABookWhenSessionIsExpired
	
	| cartId |
	cartId := systemFacade createCartFor: self validUser authenticatedWith: self validUserPassword.
	systemFacade add: 2 of: self validBook toCartIdentifiedAs: cartId.
	self advanceTime: (systemFacade sessionDuration + 1 minutes).
	self should: [
		systemFacade remove: self validBook fromCart: self invalidCartId ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText equals: systemFacade sessionHasExpiredErrorDescription ]


	! !
!TusLibrosSystemFacadeTest methodsFor: 'tests - checkout' stamp: 'JD 11/17/2021 18:46:22' prior: 50965945!
test22CannotRemoveABookWhenSessionIsExpired
	
	| cartId |

	cartId := systemFacade createCartFor: self validUser authenticatedWith: self validUserPassword.
	systemFacade add: 2 of: self validBook toCartIdentifiedAs: cartId.
	self advanceTime: (systemFacade sessionDuration + 1 minutes).
	self should: [
		systemFacade remove: self validBook fromCart: self invalidCartId ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText equals: systemFacade sessionHasExpiredErrorDescription ]


	! !

!testRun: #TusLibrosSystemFacadeTest #test22CannotRemoveABookWhenSessionIsExpired stamp: 'JD 11/17/2021 18:46:23'!
FAILURE!
!CartSession methodsFor: 'cart' stamp: 'JD 11/17/2021 18:48:36' prior: 50965653!
removeBook: aBook
	
	(self cartContent includes: aBook) ifFalse: [ self signalCannotRemoveANonPresentBook ].
	self assertIsNotExpirtedAt: self now.
! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'JD 11/17/2021 18:48:38'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'JD 11/17/2021 18:48:38'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'JD 11/17/2021 18:48:38'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'JD 11/17/2021 18:48:38'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'JD 11/17/2021 18:48:38'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'JD 11/17/2021 18:48:38'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'JD 11/17/2021 18:48:38'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'JD 11/17/2021 18:48:38'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'JD 11/17/2021 18:48:38'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'JD 11/17/2021 18:48:38'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'JD 11/17/2021 18:48:38'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'JD 11/17/2021 18:48:38'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'JD 11/17/2021 18:48:38'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'JD 11/17/2021 18:48:38'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test01CanCreateCartWithValidUserAndPassword stamp: 'JD 11/17/2021 18:48:38'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test02CanNotCreateCartWithInvalidUser stamp: 'JD 11/17/2021 18:48:38'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test03CanNotCreateCartWithInvalidPassword stamp: 'JD 11/17/2021 18:48:38'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test04CanAddItemsToACreatedCart stamp: 'JD 11/17/2021 18:48:38'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test05CanNotAddItemToNotCreatedCart stamp: 'JD 11/17/2021 18:48:38'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test06CanNotAddItemNotSellByTheStore stamp: 'JD 11/17/2021 18:48:38'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test07ListCartOfAnEmptyCartReturnsAnEmptyBag stamp: 'JD 11/17/2021 18:48:38'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test08CanNotListCartOfInvalidCartId stamp: 'JD 11/17/2021 18:48:38'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test09ListCartReturnsTheRightNumberOfItems stamp: 'JD 11/17/2021 18:48:38'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test10CanCheckoutACart stamp: 'JD 11/17/2021 18:48:38'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test11CanNotCheckoutANotCreatedCart stamp: 'JD 11/17/2021 18:48:38'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test12CanNotCheckoutAnEmptyCart stamp: 'JD 11/17/2021 18:48:38'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test13CanNotCheckoutWithAnExpiredCreditCard stamp: 'JD 11/17/2021 18:48:38'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test14ListPurchasesIncludesBoughtItems stamp: 'JD 11/17/2021 18:48:38'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test15CanNotListPurchasesOfInvalidCustomer stamp: 'JD 11/17/2021 18:48:38'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test16CanNotListPurchasesOfValidCustomerWithInvalidPassword stamp: 'JD 11/17/2021 18:48:38'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test17CanNotAddToCartWhenSessionIsExpired stamp: 'JD 11/17/2021 18:48:38'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test18CanNotListCartWhenSessionIsExpired stamp: 'JD 11/17/2021 18:48:38'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test19CanNotCheckOutCartWhenSessionIsExpired stamp: 'JD 11/17/2021 18:48:38'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test20CannotRemoveABookNotPresentInTheCart stamp: 'JD 11/17/2021 18:48:38'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test21CannotRemoveABookFromANotCreatedCart stamp: 'JD 11/17/2021 18:48:38'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test22CannotRemoveABookWhenSessionIsExpired stamp: 'JD 11/17/2021 18:48:38'!
FAILURE!

!testRun: #TusLibrosSystemFacadeTest #test22CannotRemoveABookWhenSessionIsExpired stamp: 'JD 11/17/2021 18:48:38'!
FAILURE!
!TusLibrosSystemFacadeTest methodsFor: 'tests - checkout' stamp: 'JD 11/17/2021 18:49:20' prior: 50965966!
test22CannotRemoveABookWhenSessionIsExpired
	
	| cartId |

	cartId := systemFacade createCartFor: self validUser authenticatedWith: self validUserPassword.
	systemFacade add: 2 of: self validBook toCartIdentifiedAs: cartId.
	self advanceTime: (systemFacade sessionDuration + 1 minutes).
	self should: [
		systemFacade remove: self validBook fromCart: cartId ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText equals: systemFacade sessionHasExpiredErrorDescription ]


	! !

!testRun: #TusLibrosSystemFacadeTest #test22CannotRemoveABookWhenSessionIsExpired stamp: 'JD 11/17/2021 18:49:22'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'JD 11/17/2021 18:49:22'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'JD 11/17/2021 18:49:22'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'JD 11/17/2021 18:49:22'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'JD 11/17/2021 18:49:22'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'JD 11/17/2021 18:49:22'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'JD 11/17/2021 18:49:22'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'JD 11/17/2021 18:49:22'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'JD 11/17/2021 18:49:22'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'JD 11/17/2021 18:49:22'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'JD 11/17/2021 18:49:22'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'JD 11/17/2021 18:49:22'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'JD 11/17/2021 18:49:22'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'JD 11/17/2021 18:49:22'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'JD 11/17/2021 18:49:22'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test01CanCreateCartWithValidUserAndPassword stamp: 'JD 11/17/2021 18:49:22'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test02CanNotCreateCartWithInvalidUser stamp: 'JD 11/17/2021 18:49:22'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test03CanNotCreateCartWithInvalidPassword stamp: 'JD 11/17/2021 18:49:22'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test04CanAddItemsToACreatedCart stamp: 'JD 11/17/2021 18:49:22'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test05CanNotAddItemToNotCreatedCart stamp: 'JD 11/17/2021 18:49:22'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test06CanNotAddItemNotSellByTheStore stamp: 'JD 11/17/2021 18:49:22'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test07ListCartOfAnEmptyCartReturnsAnEmptyBag stamp: 'JD 11/17/2021 18:49:22'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test08CanNotListCartOfInvalidCartId stamp: 'JD 11/17/2021 18:49:22'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test09ListCartReturnsTheRightNumberOfItems stamp: 'JD 11/17/2021 18:49:22'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test10CanCheckoutACart stamp: 'JD 11/17/2021 18:49:22'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test11CanNotCheckoutANotCreatedCart stamp: 'JD 11/17/2021 18:49:22'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test12CanNotCheckoutAnEmptyCart stamp: 'JD 11/17/2021 18:49:22'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test13CanNotCheckoutWithAnExpiredCreditCard stamp: 'JD 11/17/2021 18:49:22'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test14ListPurchasesIncludesBoughtItems stamp: 'JD 11/17/2021 18:49:22'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test15CanNotListPurchasesOfInvalidCustomer stamp: 'JD 11/17/2021 18:49:22'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test16CanNotListPurchasesOfValidCustomerWithInvalidPassword stamp: 'JD 11/17/2021 18:49:22'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test17CanNotAddToCartWhenSessionIsExpired stamp: 'JD 11/17/2021 18:49:22'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test18CanNotListCartWhenSessionIsExpired stamp: 'JD 11/17/2021 18:49:22'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test19CanNotCheckOutCartWhenSessionIsExpired stamp: 'JD 11/17/2021 18:49:22'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test20CannotRemoveABookNotPresentInTheCart stamp: 'JD 11/17/2021 18:49:22'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test21CannotRemoveABookFromANotCreatedCart stamp: 'JD 11/17/2021 18:49:22'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test22CannotRemoveABookWhenSessionIsExpired stamp: 'JD 11/17/2021 18:49:22'!
PASSED!
!TusLibrosSystemFacadeTest methodsFor: 'tests - checkout' stamp: 'JD 11/17/2021 18:52:36'!
test23CanRemoveABookFromCart
	
	| cartId |

	cartId := systemFacade createCartFor: self validUser authenticatedWith: self validUserPassword.
	systemFacade add: 2 of: self validBook toCartIdentifiedAs: cartId.
	systemFacade remove: self validBook fromCart: cartId.
	
	self assert: 1 equals: ((systemFacade listCartIdentifiedAs: cartId) occurrencesOf: self validBook).


	! !

!testRun: #TusLibrosSystemFacadeTest #test23CanRemoveABookFromCart stamp: 'JD 11/17/2021 18:52:38'!
FAILURE!
!CartSession methodsFor: 'cart' stamp: 'JD 11/17/2021 18:56:30' prior: 50965990!
removeBook: aBook
	
	(self cartContent includes: aBook) ifFalse: [ self signalCannotRemoveANonPresentBook ].
	self assertIsNotExpirtedAt: self now.
	cart remove: aBook.
! !
!Cart methodsFor: 'adding' stamp: 'JD 11/17/2021 18:57:11'!
remove: anItem

	^ items remove: anItem! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'JD 11/17/2021 18:57:13'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'JD 11/17/2021 18:57:13'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'JD 11/17/2021 18:57:13'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'JD 11/17/2021 18:57:13'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'JD 11/17/2021 18:57:13'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'JD 11/17/2021 18:57:13'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'JD 11/17/2021 18:57:13'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'JD 11/17/2021 18:57:13'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'JD 11/17/2021 18:57:13'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'JD 11/17/2021 18:57:13'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'JD 11/17/2021 18:57:13'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'JD 11/17/2021 18:57:13'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'JD 11/17/2021 18:57:13'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'JD 11/17/2021 18:57:13'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test01CanCreateCartWithValidUserAndPassword stamp: 'JD 11/17/2021 18:57:13'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test02CanNotCreateCartWithInvalidUser stamp: 'JD 11/17/2021 18:57:13'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test03CanNotCreateCartWithInvalidPassword stamp: 'JD 11/17/2021 18:57:13'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test04CanAddItemsToACreatedCart stamp: 'JD 11/17/2021 18:57:13'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test05CanNotAddItemToNotCreatedCart stamp: 'JD 11/17/2021 18:57:13'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test06CanNotAddItemNotSellByTheStore stamp: 'JD 11/17/2021 18:57:13'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test07ListCartOfAnEmptyCartReturnsAnEmptyBag stamp: 'JD 11/17/2021 18:57:13'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test08CanNotListCartOfInvalidCartId stamp: 'JD 11/17/2021 18:57:13'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test09ListCartReturnsTheRightNumberOfItems stamp: 'JD 11/17/2021 18:57:13'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test10CanCheckoutACart stamp: 'JD 11/17/2021 18:57:13'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test11CanNotCheckoutANotCreatedCart stamp: 'JD 11/17/2021 18:57:13'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test12CanNotCheckoutAnEmptyCart stamp: 'JD 11/17/2021 18:57:13'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test13CanNotCheckoutWithAnExpiredCreditCard stamp: 'JD 11/17/2021 18:57:13'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test14ListPurchasesIncludesBoughtItems stamp: 'JD 11/17/2021 18:57:13'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test15CanNotListPurchasesOfInvalidCustomer stamp: 'JD 11/17/2021 18:57:13'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test16CanNotListPurchasesOfValidCustomerWithInvalidPassword stamp: 'JD 11/17/2021 18:57:13'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test17CanNotAddToCartWhenSessionIsExpired stamp: 'JD 11/17/2021 18:57:13'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test18CanNotListCartWhenSessionIsExpired stamp: 'JD 11/17/2021 18:57:13'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test19CanNotCheckOutCartWhenSessionIsExpired stamp: 'JD 11/17/2021 18:57:13'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test20CannotRemoveABookNotPresentInTheCart stamp: 'JD 11/17/2021 18:57:13'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test21CannotRemoveABookFromANotCreatedCart stamp: 'JD 11/17/2021 18:57:13'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test22CannotRemoveABookWhenSessionIsExpired stamp: 'JD 11/17/2021 18:57:13'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test23CanRemoveABookFromCart stamp: 'JD 11/17/2021 18:57:13'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'JD 11/17/2021 18:57:13'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'JD 11/17/2021 18:57:13'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'JD 11/17/2021 18:57:13'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'JD 11/17/2021 18:57:13'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'JD 11/17/2021 18:57:13'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'JD 11/17/2021 18:57:13'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'JD 11/17/2021 18:57:13'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'JD 11/17/2021 18:57:13'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test23CanRemoveABookFromCart stamp: 'JD 11/17/2021 18:57:19'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'JD 11/17/2021 18:57:19'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'JD 11/17/2021 18:57:19'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'JD 11/17/2021 18:57:19'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'JD 11/17/2021 18:57:19'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'JD 11/17/2021 18:57:19'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'JD 11/17/2021 18:57:19'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'JD 11/17/2021 18:57:19'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'JD 11/17/2021 18:57:19'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'JD 11/17/2021 18:57:19'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'JD 11/17/2021 18:57:19'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'JD 11/17/2021 18:57:19'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'JD 11/17/2021 18:57:19'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'JD 11/17/2021 18:57:19'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'JD 11/17/2021 18:57:19'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test01CanCreateCartWithValidUserAndPassword stamp: 'JD 11/17/2021 18:57:19'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test02CanNotCreateCartWithInvalidUser stamp: 'JD 11/17/2021 18:57:19'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test03CanNotCreateCartWithInvalidPassword stamp: 'JD 11/17/2021 18:57:19'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test04CanAddItemsToACreatedCart stamp: 'JD 11/17/2021 18:57:19'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test05CanNotAddItemToNotCreatedCart stamp: 'JD 11/17/2021 18:57:19'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test06CanNotAddItemNotSellByTheStore stamp: 'JD 11/17/2021 18:57:19'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test07ListCartOfAnEmptyCartReturnsAnEmptyBag stamp: 'JD 11/17/2021 18:57:19'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test08CanNotListCartOfInvalidCartId stamp: 'JD 11/17/2021 18:57:19'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test09ListCartReturnsTheRightNumberOfItems stamp: 'JD 11/17/2021 18:57:19'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test10CanCheckoutACart stamp: 'JD 11/17/2021 18:57:19'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test11CanNotCheckoutANotCreatedCart stamp: 'JD 11/17/2021 18:57:19'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test12CanNotCheckoutAnEmptyCart stamp: 'JD 11/17/2021 18:57:19'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test13CanNotCheckoutWithAnExpiredCreditCard stamp: 'JD 11/17/2021 18:57:19'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test14ListPurchasesIncludesBoughtItems stamp: 'JD 11/17/2021 18:57:19'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test15CanNotListPurchasesOfInvalidCustomer stamp: 'JD 11/17/2021 18:57:19'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test16CanNotListPurchasesOfValidCustomerWithInvalidPassword stamp: 'JD 11/17/2021 18:57:19'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test17CanNotAddToCartWhenSessionIsExpired stamp: 'JD 11/17/2021 18:57:19'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test18CanNotListCartWhenSessionIsExpired stamp: 'JD 11/17/2021 18:57:19'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test19CanNotCheckOutCartWhenSessionIsExpired stamp: 'JD 11/17/2021 18:57:19'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test20CannotRemoveABookNotPresentInTheCart stamp: 'JD 11/17/2021 18:57:19'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test21CannotRemoveABookFromANotCreatedCart stamp: 'JD 11/17/2021 18:57:19'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test22CannotRemoveABookWhenSessionIsExpired stamp: 'JD 11/17/2021 18:57:19'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test23CanRemoveABookFromCart stamp: 'JD 11/17/2021 18:57:19'!
PASSED!
!TusLibrosSystemFacadeTest methodsFor: 'tests - checkout' stamp: 'JD 11/17/2021 18:57:31' prior: 50966283!
test23CanRemoveABookFromCart
	
	| cartId |

	cartId := systemFacade createCartFor: self validUser authenticatedWith: self validUserPassword.
	systemFacade add: 2 of: self validBook toCartIdentifiedAs: cartId.
	systemFacade remove: self validBook fromCart: cartId.
	
	self assert: 0 equals: ((systemFacade listCartIdentifiedAs: cartId) occurrencesOf: self validBook).


	! !

!testRun: #TusLibrosSystemFacadeTest #test23CanRemoveABookFromCart stamp: 'JD 11/17/2021 18:57:32'!
FAILURE!
!TusLibrosSystemFacadeTest methodsFor: 'tests - checkout' stamp: 'JD 11/17/2021 18:57:34' prior: 50966607!
test23CanRemoveABookFromCart
	
	| cartId |

	cartId := systemFacade createCartFor: self validUser authenticatedWith: self validUserPassword.
	systemFacade add: 2 of: self validBook toCartIdentifiedAs: cartId.
	systemFacade remove: self validBook fromCart: cartId.
	
	self assert: 1 equals: ((systemFacade listCartIdentifiedAs: cartId) occurrencesOf: self validBook).


	! !

!testRun: #TusLibrosSystemFacadeTest #test23CanRemoveABookFromCart stamp: 'JD 11/17/2021 18:57:35'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'JD 11/17/2021 18:57:35'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'JD 11/17/2021 18:57:35'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'JD 11/17/2021 18:57:35'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'JD 11/17/2021 18:57:35'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'JD 11/17/2021 18:57:35'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'JD 11/17/2021 18:57:35'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'JD 11/17/2021 18:57:35'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'JD 11/17/2021 18:57:35'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'JD 11/17/2021 18:57:35'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'JD 11/17/2021 18:57:35'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'JD 11/17/2021 18:57:35'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'JD 11/17/2021 18:57:35'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'JD 11/17/2021 18:57:35'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'JD 11/17/2021 18:57:35'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test01CanCreateCartWithValidUserAndPassword stamp: 'JD 11/17/2021 18:57:35'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test02CanNotCreateCartWithInvalidUser stamp: 'JD 11/17/2021 18:57:35'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test03CanNotCreateCartWithInvalidPassword stamp: 'JD 11/17/2021 18:57:35'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test04CanAddItemsToACreatedCart stamp: 'JD 11/17/2021 18:57:35'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test05CanNotAddItemToNotCreatedCart stamp: 'JD 11/17/2021 18:57:35'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test06CanNotAddItemNotSellByTheStore stamp: 'JD 11/17/2021 18:57:35'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test07ListCartOfAnEmptyCartReturnsAnEmptyBag stamp: 'JD 11/17/2021 18:57:35'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test08CanNotListCartOfInvalidCartId stamp: 'JD 11/17/2021 18:57:35'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test09ListCartReturnsTheRightNumberOfItems stamp: 'JD 11/17/2021 18:57:35'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test10CanCheckoutACart stamp: 'JD 11/17/2021 18:57:35'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test11CanNotCheckoutANotCreatedCart stamp: 'JD 11/17/2021 18:57:35'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test12CanNotCheckoutAnEmptyCart stamp: 'JD 11/17/2021 18:57:35'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test13CanNotCheckoutWithAnExpiredCreditCard stamp: 'JD 11/17/2021 18:57:35'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test14ListPurchasesIncludesBoughtItems stamp: 'JD 11/17/2021 18:57:35'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test15CanNotListPurchasesOfInvalidCustomer stamp: 'JD 11/17/2021 18:57:35'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test16CanNotListPurchasesOfValidCustomerWithInvalidPassword stamp: 'JD 11/17/2021 18:57:35'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test17CanNotAddToCartWhenSessionIsExpired stamp: 'JD 11/17/2021 18:57:35'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test18CanNotListCartWhenSessionIsExpired stamp: 'JD 11/17/2021 18:57:35'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test19CanNotCheckOutCartWhenSessionIsExpired stamp: 'JD 11/17/2021 18:57:35'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test20CannotRemoveABookNotPresentInTheCart stamp: 'JD 11/17/2021 18:57:35'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test21CannotRemoveABookFromANotCreatedCart stamp: 'JD 11/17/2021 18:57:35'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test22CannotRemoveABookWhenSessionIsExpired stamp: 'JD 11/17/2021 18:57:35'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test23CanRemoveABookFromCart stamp: 'JD 11/17/2021 18:57:35'!
PASSED!

!methodRemoval: TusLibrosSystemFacadeTest #test20CannotRemoveABookNotPresentInTheCart stamp: 'JD 11/17/2021 18:58:44'!
test20CannotRemoveABookNotPresentInTheCart

	| cartId |

	cartId := systemFacade createCartFor: self validUser authenticatedWith: self validUserPassword.
	self should: [
		systemFacade remove: self validBook fromCart: cartId]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText equals: systemFacade cannotRemoveANonPresentBookErrorMessage.
			self assert: (systemFacade listCartIdentifiedAs: cartId) isEmpty ]


	!
!TusLibrosSystemFacadeTest methodsFor: 'nil' stamp: 'JD 11/17/2021 18:58:47'!
test20CannotRemoveABookNotPresentInTheCart

	| cartId |

	cartId := systemFacade createCartFor: self validUser authenticatedWith: self validUserPassword.
	self should: [
		systemFacade remove: self validBook fromCart: cartId]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText equals: systemFacade cannotRemoveANonPresentBookErrorMessage.
			self assert: (systemFacade listCartIdentifiedAs: cartId) isEmpty ]


	! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'JD 11/17/2021 18:59:25'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'JD 11/17/2021 18:59:25'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'JD 11/17/2021 18:59:25'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'JD 11/17/2021 18:59:25'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'JD 11/17/2021 18:59:25'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'JD 11/17/2021 18:59:25'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'JD 11/17/2021 18:59:25'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'JD 11/17/2021 18:59:25'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'JD 11/17/2021 18:59:25'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'JD 11/17/2021 18:59:25'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'JD 11/17/2021 18:59:25'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'JD 11/17/2021 18:59:25'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'JD 11/17/2021 18:59:25'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'JD 11/17/2021 18:59:25'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test01CanCreateCartWithValidUserAndPassword stamp: 'JD 11/17/2021 18:59:25'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test02CanNotCreateCartWithInvalidUser stamp: 'JD 11/17/2021 18:59:25'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test03CanNotCreateCartWithInvalidPassword stamp: 'JD 11/17/2021 18:59:25'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test04CanAddItemsToACreatedCart stamp: 'JD 11/17/2021 18:59:25'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test05CanNotAddItemToNotCreatedCart stamp: 'JD 11/17/2021 18:59:25'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test06CanNotAddItemNotSellByTheStore stamp: 'JD 11/17/2021 18:59:25'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test07ListCartOfAnEmptyCartReturnsAnEmptyBag stamp: 'JD 11/17/2021 18:59:25'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test08CanNotListCartOfInvalidCartId stamp: 'JD 11/17/2021 18:59:25'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test09ListCartReturnsTheRightNumberOfItems stamp: 'JD 11/17/2021 18:59:25'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test10CanCheckoutACart stamp: 'JD 11/17/2021 18:59:25'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test11CanNotCheckoutANotCreatedCart stamp: 'JD 11/17/2021 18:59:25'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test12CanNotCheckoutAnEmptyCart stamp: 'JD 11/17/2021 18:59:25'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test13CanNotCheckoutWithAnExpiredCreditCard stamp: 'JD 11/17/2021 18:59:25'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test14ListPurchasesIncludesBoughtItems stamp: 'JD 11/17/2021 18:59:25'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test15CanNotListPurchasesOfInvalidCustomer stamp: 'JD 11/17/2021 18:59:25'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test16CanNotListPurchasesOfValidCustomerWithInvalidPassword stamp: 'JD 11/17/2021 18:59:25'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test17CanNotAddToCartWhenSessionIsExpired stamp: 'JD 11/17/2021 18:59:25'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test18CanNotListCartWhenSessionIsExpired stamp: 'JD 11/17/2021 18:59:25'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test19CanNotCheckOutCartWhenSessionIsExpired stamp: 'JD 11/17/2021 18:59:25'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test20CannotRemoveABookNotPresentInTheCart stamp: 'JD 11/17/2021 18:59:25'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test21CannotRemoveABookFromANotCreatedCart stamp: 'JD 11/17/2021 18:59:25'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test22CannotRemoveABookWhenSessionIsExpired stamp: 'JD 11/17/2021 18:59:25'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test23CanRemoveABookFromCart stamp: 'JD 11/17/2021 18:59:25'!
PASSED!
!TusLibrosSystemFacade methodsFor: 'facade protocol' stamp: 'JD 11/17/2021 19:01:08' prior: 50965813!
remove: aBook fromCart: aCartId

	self withCartSessionIdentifiedAs: aCartId do: [ :cartSession | cartSession removeBook: aBook]! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'JD 11/17/2021 19:01:10'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'JD 11/17/2021 19:01:10'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'JD 11/17/2021 19:01:10'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'JD 11/17/2021 19:01:10'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'JD 11/17/2021 19:01:10'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'JD 11/17/2021 19:01:10'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'JD 11/17/2021 19:01:10'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'JD 11/17/2021 19:01:10'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'JD 11/17/2021 19:01:10'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'JD 11/17/2021 19:01:10'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'JD 11/17/2021 19:01:10'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'JD 11/17/2021 19:01:10'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'JD 11/17/2021 19:01:10'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'JD 11/17/2021 19:01:10'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test01CanCreateCartWithValidUserAndPassword stamp: 'JD 11/17/2021 19:01:10'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test02CanNotCreateCartWithInvalidUser stamp: 'JD 11/17/2021 19:01:10'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test03CanNotCreateCartWithInvalidPassword stamp: 'JD 11/17/2021 19:01:10'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test04CanAddItemsToACreatedCart stamp: 'JD 11/17/2021 19:01:10'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test05CanNotAddItemToNotCreatedCart stamp: 'JD 11/17/2021 19:01:10'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test06CanNotAddItemNotSellByTheStore stamp: 'JD 11/17/2021 19:01:10'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test07ListCartOfAnEmptyCartReturnsAnEmptyBag stamp: 'JD 11/17/2021 19:01:10'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test08CanNotListCartOfInvalidCartId stamp: 'JD 11/17/2021 19:01:10'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test09ListCartReturnsTheRightNumberOfItems stamp: 'JD 11/17/2021 19:01:10'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test10CanCheckoutACart stamp: 'JD 11/17/2021 19:01:10'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test11CanNotCheckoutANotCreatedCart stamp: 'JD 11/17/2021 19:01:10'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test12CanNotCheckoutAnEmptyCart stamp: 'JD 11/17/2021 19:01:10'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test13CanNotCheckoutWithAnExpiredCreditCard stamp: 'JD 11/17/2021 19:01:10'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test14ListPurchasesIncludesBoughtItems stamp: 'JD 11/17/2021 19:01:10'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test15CanNotListPurchasesOfInvalidCustomer stamp: 'JD 11/17/2021 19:01:10'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test16CanNotListPurchasesOfValidCustomerWithInvalidPassword stamp: 'JD 11/17/2021 19:01:10'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test17CanNotAddToCartWhenSessionIsExpired stamp: 'JD 11/17/2021 19:01:10'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test18CanNotListCartWhenSessionIsExpired stamp: 'JD 11/17/2021 19:01:10'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test19CanNotCheckOutCartWhenSessionIsExpired stamp: 'JD 11/17/2021 19:01:10'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test20CannotRemoveABookNotPresentInTheCart stamp: 'JD 11/17/2021 19:01:10'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test21CannotRemoveABookFromANotCreatedCart stamp: 'JD 11/17/2021 19:01:10'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test22CannotRemoveABookWhenSessionIsExpired stamp: 'JD 11/17/2021 19:01:10'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test23CanRemoveABookFromCart stamp: 'JD 11/17/2021 19:01:10'!
PASSED!
!CartSession methodsFor: 'cart' stamp: 'JD 11/17/2021 19:01:53' prior: 50966301!
removeBook: aBook

	self assertIsNotExpirtedAt: self now.
	cart remove: aBook.
! !
!CartSession methodsFor: 'cart' stamp: 'JD 11/17/2021 19:02:25' prior: 50967083!
removeBook: aBook
	
	(self cartContent includes: aBook) ifFalse: [ self signalCannotRemoveANonPresentBook ].
	self assertIsNotExpirtedAt: self now.
	cart remove: aBook.
! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'JD 11/17/2021 19:04:28'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'JD 11/17/2021 19:04:28'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'JD 11/17/2021 19:04:28'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'JD 11/17/2021 19:04:28'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'JD 11/17/2021 19:04:28'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'JD 11/17/2021 19:04:28'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'JD 11/17/2021 19:04:28'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'JD 11/17/2021 19:04:28'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'JD 11/17/2021 19:04:28'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'JD 11/17/2021 19:04:28'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'JD 11/17/2021 19:04:28'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'JD 11/17/2021 19:04:28'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'JD 11/17/2021 19:04:28'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'JD 11/17/2021 19:04:28'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test01CanCreateCartWithValidUserAndPassword stamp: 'JD 11/17/2021 19:04:28'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test02CanNotCreateCartWithInvalidUser stamp: 'JD 11/17/2021 19:04:28'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test03CanNotCreateCartWithInvalidPassword stamp: 'JD 11/17/2021 19:04:28'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test04CanAddItemsToACreatedCart stamp: 'JD 11/17/2021 19:04:28'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test05CanNotAddItemToNotCreatedCart stamp: 'JD 11/17/2021 19:04:28'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test06CanNotAddItemNotSellByTheStore stamp: 'JD 11/17/2021 19:04:28'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test07ListCartOfAnEmptyCartReturnsAnEmptyBag stamp: 'JD 11/17/2021 19:04:28'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test08CanNotListCartOfInvalidCartId stamp: 'JD 11/17/2021 19:04:28'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test09ListCartReturnsTheRightNumberOfItems stamp: 'JD 11/17/2021 19:04:28'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test10CanCheckoutACart stamp: 'JD 11/17/2021 19:04:28'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test11CanNotCheckoutANotCreatedCart stamp: 'JD 11/17/2021 19:04:28'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test12CanNotCheckoutAnEmptyCart stamp: 'JD 11/17/2021 19:04:28'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test13CanNotCheckoutWithAnExpiredCreditCard stamp: 'JD 11/17/2021 19:04:28'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test14ListPurchasesIncludesBoughtItems stamp: 'JD 11/17/2021 19:04:28'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test15CanNotListPurchasesOfInvalidCustomer stamp: 'JD 11/17/2021 19:04:28'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test16CanNotListPurchasesOfValidCustomerWithInvalidPassword stamp: 'JD 11/17/2021 19:04:28'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test17CanNotAddToCartWhenSessionIsExpired stamp: 'JD 11/17/2021 19:04:28'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test18CanNotListCartWhenSessionIsExpired stamp: 'JD 11/17/2021 19:04:28'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test19CanNotCheckOutCartWhenSessionIsExpired stamp: 'JD 11/17/2021 19:04:28'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test20CannotRemoveABookNotPresentInTheCart stamp: 'JD 11/17/2021 19:04:28'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test21CannotRemoveABookFromANotCreatedCart stamp: 'JD 11/17/2021 19:04:28'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test22CannotRemoveABookWhenSessionIsExpired stamp: 'JD 11/17/2021 19:04:28'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test23CanRemoveABookFromCart stamp: 'JD 11/17/2021 19:04:28'!
PASSED!
!CartSession methodsFor: 'cart' stamp: 'JD 11/17/2021 19:04:31' prior: 50967089!
removeBook: aBook
	
	(self cartContent includes: aBook) ifFalse: [ self signalCannotRemoveANonPresentBook ].
	cart remove: aBook.
! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'JD 11/17/2021 19:04:33'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'JD 11/17/2021 19:04:33'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'JD 11/17/2021 19:04:33'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'JD 11/17/2021 19:04:33'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'JD 11/17/2021 19:04:33'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'JD 11/17/2021 19:04:33'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'JD 11/17/2021 19:04:33'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'JD 11/17/2021 19:04:33'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'JD 11/17/2021 19:04:33'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'JD 11/17/2021 19:04:33'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'JD 11/17/2021 19:04:33'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'JD 11/17/2021 19:04:33'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'JD 11/17/2021 19:04:33'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'JD 11/17/2021 19:04:33'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test01CanCreateCartWithValidUserAndPassword stamp: 'JD 11/17/2021 19:04:33'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test02CanNotCreateCartWithInvalidUser stamp: 'JD 11/17/2021 19:04:33'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test03CanNotCreateCartWithInvalidPassword stamp: 'JD 11/17/2021 19:04:33'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test04CanAddItemsToACreatedCart stamp: 'JD 11/17/2021 19:04:33'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test05CanNotAddItemToNotCreatedCart stamp: 'JD 11/17/2021 19:04:33'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test06CanNotAddItemNotSellByTheStore stamp: 'JD 11/17/2021 19:04:33'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test07ListCartOfAnEmptyCartReturnsAnEmptyBag stamp: 'JD 11/17/2021 19:04:33'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test08CanNotListCartOfInvalidCartId stamp: 'JD 11/17/2021 19:04:33'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test09ListCartReturnsTheRightNumberOfItems stamp: 'JD 11/17/2021 19:04:33'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test10CanCheckoutACart stamp: 'JD 11/17/2021 19:04:33'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test11CanNotCheckoutANotCreatedCart stamp: 'JD 11/17/2021 19:04:33'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test12CanNotCheckoutAnEmptyCart stamp: 'JD 11/17/2021 19:04:33'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test13CanNotCheckoutWithAnExpiredCreditCard stamp: 'JD 11/17/2021 19:04:33'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test14ListPurchasesIncludesBoughtItems stamp: 'JD 11/17/2021 19:04:33'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test15CanNotListPurchasesOfInvalidCustomer stamp: 'JD 11/17/2021 19:04:33'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test16CanNotListPurchasesOfValidCustomerWithInvalidPassword stamp: 'JD 11/17/2021 19:04:33'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test17CanNotAddToCartWhenSessionIsExpired stamp: 'JD 11/17/2021 19:04:33'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test18CanNotListCartWhenSessionIsExpired stamp: 'JD 11/17/2021 19:04:33'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test19CanNotCheckOutCartWhenSessionIsExpired stamp: 'JD 11/17/2021 19:04:33'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test20CannotRemoveABookNotPresentInTheCart stamp: 'JD 11/17/2021 19:04:33'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test21CannotRemoveABookFromANotCreatedCart stamp: 'JD 11/17/2021 19:04:33'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test22CannotRemoveABookWhenSessionIsExpired stamp: 'JD 11/17/2021 19:04:33'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test23CanRemoveABookFromCart stamp: 'JD 11/17/2021 19:04:33'!
PASSED!
!CartSession methodsFor: 'cart' stamp: 'JD 11/17/2021 19:06:31'!
removeFromCart: aBook
	
	(self cartContent includes: aBook) ifFalse: [ self signalCannotRemoveANonPresentBook ].
	cart remove: aBook.
! !
!TusLibrosSystemFacade methodsFor: 'as yet unclassified' stamp: 'JD 11/17/2021 19:06:31' prior: 50966944!
remove: aBook fromCart: aCartId

	self withCartSessionIdentifiedAs: aCartId do: [ :cartSession | cartSession removeFromCart: aBook]! !

!methodRemoval: CartSession #removeBook: stamp: 'JD 11/17/2021 19:06:31'!
removeBook: aBook
	
	(self cartContent includes: aBook) ifFalse: [ self signalCannotRemoveANonPresentBook ].
	cart remove: aBook.
!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'JD 11/17/2021 19:06:34'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'JD 11/17/2021 19:06:34'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'JD 11/17/2021 19:06:34'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'JD 11/17/2021 19:06:34'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'JD 11/17/2021 19:06:34'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'JD 11/17/2021 19:06:34'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'JD 11/17/2021 19:06:34'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'JD 11/17/2021 19:06:34'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'JD 11/17/2021 19:06:34'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'JD 11/17/2021 19:06:34'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'JD 11/17/2021 19:06:34'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'JD 11/17/2021 19:06:34'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'JD 11/17/2021 19:06:34'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'JD 11/17/2021 19:06:34'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test01CanCreateCartWithValidUserAndPassword stamp: 'JD 11/17/2021 19:06:34'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test02CanNotCreateCartWithInvalidUser stamp: 'JD 11/17/2021 19:06:34'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test03CanNotCreateCartWithInvalidPassword stamp: 'JD 11/17/2021 19:06:34'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test04CanAddItemsToACreatedCart stamp: 'JD 11/17/2021 19:06:34'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test05CanNotAddItemToNotCreatedCart stamp: 'JD 11/17/2021 19:06:34'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test06CanNotAddItemNotSellByTheStore stamp: 'JD 11/17/2021 19:06:34'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test07ListCartOfAnEmptyCartReturnsAnEmptyBag stamp: 'JD 11/17/2021 19:06:34'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test08CanNotListCartOfInvalidCartId stamp: 'JD 11/17/2021 19:06:34'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test09ListCartReturnsTheRightNumberOfItems stamp: 'JD 11/17/2021 19:06:34'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test10CanCheckoutACart stamp: 'JD 11/17/2021 19:06:34'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test11CanNotCheckoutANotCreatedCart stamp: 'JD 11/17/2021 19:06:34'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test12CanNotCheckoutAnEmptyCart stamp: 'JD 11/17/2021 19:06:34'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test13CanNotCheckoutWithAnExpiredCreditCard stamp: 'JD 11/17/2021 19:06:34'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test14ListPurchasesIncludesBoughtItems stamp: 'JD 11/17/2021 19:06:34'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test15CanNotListPurchasesOfInvalidCustomer stamp: 'JD 11/17/2021 19:06:34'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test16CanNotListPurchasesOfValidCustomerWithInvalidPassword stamp: 'JD 11/17/2021 19:06:34'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test17CanNotAddToCartWhenSessionIsExpired stamp: 'JD 11/17/2021 19:06:34'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test18CanNotListCartWhenSessionIsExpired stamp: 'JD 11/17/2021 19:06:34'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test19CanNotCheckOutCartWhenSessionIsExpired stamp: 'JD 11/17/2021 19:06:34'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test20CannotRemoveABookNotPresentInTheCart stamp: 'JD 11/17/2021 19:06:34'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test21CannotRemoveABookFromANotCreatedCart stamp: 'JD 11/17/2021 19:06:34'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test22CannotRemoveABookWhenSessionIsExpired stamp: 'JD 11/17/2021 19:06:34'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test23CanRemoveABookFromCart stamp: 'JD 11/17/2021 19:06:34'!
PASSED!
!TusLibrosRestAPI methodsFor: 'initialization' stamp: 'JD 11/17/2021 19:08:44'!
addRemoveFromCartService

	webServer addService: '/remove-from-cart' action:[:request | | book cartId |
		
		[
			book := (request fields at: 'book').
			cartId := (request fields at: 'cartId') asNumber.
			tusLibrosSystemFacade remove: book fromCart: cartId.
			request send200Response: 'OK'
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	! !
!TusLibrosRestAPI methodsFor: 'initialization' stamp: 'JD 11/17/2021 19:08:53' prior: 50965321!
addServices

	self addCreateCartService.
	self addListCatalogService.
	self addAddToCartService.
	self addListCartService.
	self addCheckoutCartService.
	self addListPurchasesService.
	self addRemoveFromCartService.! !

TusLibrosRestAPI allInstances do: [:anInstance | anInstance destroy].!

| userAndPassword catalog tusLibrosXxInstance |

userAndPassword := Dictionary new.
userAndPassword at: 'validUser' put: 'validUserPassword'.
catalog := Dictionary new.
catalog at: 'book' put: 10.

tusLibrosXxInstance := TusLibrosRestAPI listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. !

TusLibrosRestAPI allInstances do: [:anInstance | anInstance destroy].!

----SNAPSHOT----(17 November 2021 19:12:31) CuisUniversity-4972.image priorSource: 20242475!

----SNAPSHOT----(17 November 2021 19:12:37) CuisUniversity-4972.image priorSource: 20349216!
Can process chunked data.!
Exception signaled when authentication is required.!
WebClient provides a simple yet complete HTTP client implementation.

To retrieve the contents of a web page:
(WebClient httpGet: 'http://www.cuis-smalltalk.org/') content

INTRO
-------

The simplest form to use WebClient is by one of its convenience APIs:

	WebClient httpGet: 'http://www.squeak.org/'.
	WebClient httpPost: 'http://www.squeak.org/' content:'Hello Squeak' type: 'text/plain'.

For more elaborate use of headers and some other options in the request, a client can utilize modified variants:

	WebClient new httpGet: 'http://www.squeak.org/' do: [ :req|
		"Set an if-modified-since header"
		req headerAt: 'If-Modified-Since' put: 'Sat, 29 Oct 1994 19:43:31 GMT'.
		"Add several accept headers"
		req addHeader: 'Accept' value: 'text/plain'.
		req addHeader: 'Accept' value: 'application/x-foo-bar'.
		req addHeader: 'Accept' value: 'image/jpg'.
	].

The set of utility methods is limited to a few useful ones but it is easy to do the setup on your own:

	| url client request data |
	data := 'Hello Squeak'.								"POST data"
	url := 'http://www.squeak.org/'.						"POST url"
	client := WebClient new initializeFromUrl: url. 		"sets host etc"
	request := client requestWithUrl: url. 				"sets path etc"
	request method: 'POST'.							"sets method"
	request headerAt: 'Content-Length' put: data size.
	request headerAt: 'Content-Type' put: 'text/plain'.
	"... any other headers required ..."
	^client sendRequest: request 
		content: data readStream
		size: data size.

The utility methods like httpGet: etc. are similarly simple requests.

RESPONSES
--------------

The WebClient request methods return a WebResponse that the client can process:

	| resp |
	resp := WebClient httpGet: 'http://www.squeak.org/'.
	resp isSuccess ifFalse: [^self error: resp status].
	"Process the content from the response"
	^resp content

In addition, content can be streamed from the response so that it does not need to be downloaded all at once:

	| client resp |
	client := WebClient new.
	[
		resp := client httpGet: 'http://www.squeak.org/'.
		resp isSuccess ifFalse:[^self error: resp status].
		"Stream the content from the response"
		'page.html' asFileEntry forceWriteStreamDo: [ :file |
			resp streamTo: file 
				size: resp contentLength
				progress: [ :total :amount ]].
	] ensure: [ client close].

The progress block in the above can be omitted but has been included in this example to illustrate its usage. The block takes a total length (which can be nil if the length is not known) and the amount that has been loaded.

MULTIPLE REQUESTS
-------------------------

WebClient can and should be used for multiple requests to the same host. This will ensure persistent connections as well as having cookies processed properly within one session:

	| client resp |
	client := WebClient new.
	resp := client httpGet: 'http://www.squeak.org/'.
	resp := client httpGet: 'http://www.squeak.org/Download'.
	resp := client httpGet: 'http://www.squeak.org/Features'.
	client close.

One important issue to keep in mind is that because WebClient is optimized for persistent connections, you need to close it when you are done. That is not true for WebClient's class-side convenience APIs, which prefetch the response and close the socket. Generally speaking, whenever you say 'WebClient new' you need to close the client when you're done (however, you can do so by sending #close to a response you've received). For example:

	"Convenience API. Don't need to close, but prefetches result."
	WebClient httpGet: 'http://www.squeak.org'.

	| client resp |
	"Regular use. Create WebClient, return after header is read ..."
	client := WebClient new.
	[response := client httpGet: 'http://www.squeak.org/'.
	"... then fetch (or stream) the content ..."
	response content.
	] ensure:[
		"... and close the client when done."
		client close.
	].

AUTHENTICATION
---------------------

WebClient supports basic and digest authentication by default. WebClient delegates the retrieval of username/password to WebUtils which prompts the user for credentials. 

WebClient can either be supplied with specific credentials to be used or custom credentials handlers, for example:

	| client |
	client := WebClient new.
	client username: 'squeak'.
	client password: 'squeak'.
	client httpGet: 'http://www.squeak.org/protected'.

Proxy authentication works the same way as authentication but operates on a different authentication context to allow different sets of credentials to work.
!
WebCookie represents an http cookie for use by WebClient.!
A common base class for WebRequest and WebResponse.!
Represents an HTTP request for WebClient/WebServer.!
Represents an HTTP response for WebClient/WebServer.!
WebServer provides a simple yet complete HTTP server implementation.

Example:
(WebServer new listenOn: 8080) addService: '/hello' action: [ :req | req send200Response: 'Hello World!!']!
A wrapper object for the WebSocket API.!
A wrapper object for the WebSocket API.!
A wrapper object for the WebSocket API.!
WebUtils contains a number of utility methods used by WebClient/WebServer.!
A variant on SocketStream supporting SSL/TLS encryption via SqueakSSL.
!
SqueakSSL provides an interface to the platforms SSL/TLS facilities.
!

----SNAPSHOT----(17 November 2021 19:13:45) CuisUniversity-4972.image priorSource: 20349310!

----STARTUP---- (18 November 2021 17:11:25) as /home/juli/Documentos/Facu/Inge1/cuis-university/CuisUniversity-4972.image!


----End fileIn of /home/juli/Documentos/Facu/Inge1/2021-2c/20-TusLibros/Iteracion 4/WordsClientDemo.st----!

|server client|

server := StringsServicesRestInterface listeningOn: 8080.
client := WordsClientWindow open.
!

server destroy.!

|server client|

server := StringsServicesRestInterface listeningOn: 8080.!

client := WordsClientWindow open.!

CodePackage subclass: #ColorExtrasPackage
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Color-Extras'!

!classDefinition: #ColorExtrasPackage category: 'Color-Extras' stamp: 'Install-Color-Extras 11/18/2021 17:26:43'!
CodePackage subclass: #ColorExtrasPackage
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Color-Extras'!

ColorExtrasPackage class
	instanceVariableNames: ''!

!classDefinition: 'ColorExtrasPackage class' category: 'Color-Extras' stamp: 'Install-Color-Extras 11/18/2021 17:26:43'!
ColorExtrasPackage class
	instanceVariableNames: ''!

----End fileIn of /home/juli/Documentos/Facu/Inge1/cuis-university/Packages/Features/Color-Extras.pck.st----!

CodePackage subclass: #MorphicMisc1Package
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Misc1'!

!classDefinition: #MorphicMisc1Package category: 'Morphic-Misc1' stamp: 'Install-Morphic-Misc1 11/18/2021 17:26:44'!
CodePackage subclass: #MorphicMisc1Package
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Misc1'!
!MorphicMisc1Package commentStamp: '<historical>' prior: 0!
My purpose in life is to check that any base image methods overridden have not been updated.
See #MorphMisc1Package class>>prePackageInstall!

MorphicMisc1Package class
	instanceVariableNames: ''!

!classDefinition: 'MorphicMisc1Package class' category: 'Morphic-Misc1' stamp: 'Install-Morphic-Misc1 11/18/2021 17:26:44'!
MorphicMisc1Package class
	instanceVariableNames: ''!

----End fileIn of /home/juli/Documentos/Facu/Inge1/cuis-university/Packages/Morphic/Morphic-Misc1/Morphic-Misc1.pck.st----!

----End fileIn of /home/juli/Documentos/Facu/Inge1/cuis-university/Packages/Morphic/Morphic-Widgets-Extras.pck.st----!

server destroy.!

StringsServicesRestInterface allInstances do: [:anInstance | anInstance destroy].!

|server client|

server := StringsServicesRestInterface listeningOn: 8080.
client := WordsClientWindow open.
!

!classRemoval: #WordsClientWindow stamp: 'JD 11/18/2021 17:28:28'!
ProtoObject subclass: #WordsClientWindow
	instanceVariableNames: 'sentenceTextBoxMorph wordsListMorph'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'WordsClientDemo'!

!classRemoval: #WordsRestInterface stamp: 'JD 11/18/2021 17:28:28'!
Object subclass: #WordsRestInterface
	instanceVariableNames: 'port'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'WordsClientDemo'!

!classRemoval: #WordsClientWindowModel stamp: 'JD 11/18/2021 17:28:29'!
Object subclass: #WordsClientWindowModel
	instanceVariableNames: 'sentence words selectedIndex restInterface'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'WordsClientDemo'!

----End fileIn of /home/juli/Documentos/Facu/Inge1/2021-2c/20-TusLibros/Iteracion 4/WordsClientDemo.st----!

StringsServicesRestInterface allInstances do: [:anInstance | anInstance destroy].!

|server client|

server := StringsServicesRestInterface listeningOn: 8080.
client := WordsClientWindow open.!

----SNAPSHOT----(18 November 2021 17:31:15) CuisUniversity-4972.image priorSource: 20349404!

	StringsServicesRestInterface allInstances do: [:anInstance | anInstance destroy].!

	|server client|

	server := StringsServicesRestInterface listeningOn: 8080.
	client := WordsClientWindow open.!

	StringsServicesRestInterface allInstances do: [:anInstance | anInstance destroy].!

	StringsServicesRestInterface allInstances do: [:anInstance | anInstance destroy].!

	StringsServicesRestInterface allInstances do: [:anInstance | anInstance destroy].!

	|server client|

	server := StringsServicesRestInterface listeningOn: 8080.
	client := WordsClientWindow open.!

Panel subclass: #TusLibrosLogInWindow
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!

!classDefinition: #TusLibrosLogInWindow category: 'TusLibros-View' stamp: 'JD 11/18/2021 18:21:47'!
Panel subclass: #TusLibrosLogInWindow
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!

!classDefinition: #TusLibrosLogInWindowModel category: 'TusLibros-View' stamp: 'JD 11/18/2021 18:26:18'!
Object subclass: #TusLibrosLogInWindowModel
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!
!TusLibrosLogInWindow methodsFor: 'no messages' stamp: 'JD 11/18/2021 18:26:10' overrides: 50972279!
initialize
	
	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: 'Tus Libros'.
	self model: (TusLibrosLogInWindowModel new).
	self morphExtent: 1035@485.
	self buildMorphicWindow.
	self openInWorld.
			
	self model when: #newWordsArrived send: #refreshListOfWords to: self.! !

----SNAPSHOT----(18 November 2021 18:28:47) CuisUniversity-4972.image priorSource: 20676514!

----STARTUP---- (21 November 2021 20:20:48) as /home/juli/Documentos/Facu/Inge1/cuis-university/CuisUniversity-4972.image!


	StringsServicesRestInterface allInstances do: [:anInstance | anInstance destroy].!

	server := StringsServicesRestInterface listeningOn: 8080.!

	client := WordsClientWindow open.!

	StringsServicesRestInterface allInstances do: [:anInstance | anInstance destroy].!
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/21/2021 20:26:12' overrides: 50972174!
buildMorphicWindow
		
	self layoutMorph beColumn;
	separation: 15;
	axisEdgeWeight: 0;
	addMorph: self build1stRow;
	addMorph: self build2ndRow;
	addMorph: self build2ndRow.! !

!classRenamed: #TusLibrosRestAPI as: #TusLibrosServer stamp: 'JD 11/21/2021 21:13:42'!
Smalltalk renameClassNamed: #TusLibrosRestAPI as: #TusLibrosServer!
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/21/2021 21:22:39'!
build1stRow
	| firstRowLayoutMorph usernameTextBoxMorph |
	
	usernameTextBoxMorph := TextModelMorph textProvider: self model textGetter: #userNameText textSetter: #userNameText:. 
	usernameTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | usernameTextBoxMorph innerTextMorph acceptContents ] .
	usernameTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300. 
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'Username');
	addMorph: usernameTextBoxMorph.
	
	^ firstRowLayoutMorph.! !
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/21/2021 21:38:41'!
build2ndRow
	| secondRowLayoutMorph usernameTextBoxMorph |
	
	usernameTextBoxMorph := TextModelMorph textProvider: self model textGetter: #passwordText textSetter: #passwordText:. 
	usernameTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | usernameTextBoxMorph innerTextMorph acceptContents ] .
	usernameTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300. 
		
	secondRowLayoutMorph := LayoutMorph newRow.
	secondRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents: 'Password');
	addMorph: usernameTextBoxMorph.
	
	^ secondRowLayoutMorph.! !
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/21/2021 21:38:46' prior: 50977897!
build2ndRow
	| secondRowLayoutMorph passwordTextBoxMorph |
	
	passwordTextBoxMorph := TextModelMorph textProvider: self model textGetter: #passwordText textSetter: #passwordText:. 
	passwordTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | passwordTextBoxMorph innerTextMorph acceptContents ] .
	passwordTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300. 
		
	secondRowLayoutMorph := LayoutMorph newRow.
	secondRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents: 'Password');
	addMorph: passwordTextBoxMorph.
	
	^ secondRowLayoutMorph.! !
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/21/2021 21:39:05' prior: 50977875!
build1stRow
	| firstRowLayoutMorph usernameTextBoxMorph |
	
	usernameTextBoxMorph := TextModelMorph textProvider: self model textGetter: #userNameText textSetter: #userNameText:. 
	usernameTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | usernameTextBoxMorph innerTextMorph acceptContents ] .
	usernameTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300. 
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents: 'Username');
	addMorph: usernameTextBoxMorph.
	
	^ firstRowLayoutMorph.! !
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/21/2021 21:41:03' prior: 50977861 overrides: 50972174!
buildMorphicWindow
		
	self layoutMorph beColumn;
	separation: 15;
	axisEdgeWeight: 0;
	addMorph: self build1stRow;
	addMorph: self build2ndRow;
	addMorph: self build3rdRow.! !
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/21/2021 21:54:13'!
build3rdRow
	| secondRowLayoutMorph passwordTextBoxMorph sendRequestButtonMorph |
	
	sendRequestButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #sendCreateCartRequest label: 'Create Cart'.

	secondRowLayoutMorph := LayoutMorph newRow.
	secondRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: passwordTextBoxMorph.
	
	^ secondRowLayoutMorph.! !
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/21/2021 21:54:40' prior: 50977976!
build3rdRow
	| secondRowLayoutMorph sendRequestButtonMorph |
	
	sendRequestButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #sendCreateCartRequest label: 'Create Cart'.

	secondRowLayoutMorph := LayoutMorph newRow.
	secondRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: sendRequestButtonMorph.
	
	^ sendRequestButtonMorph.! !
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/21/2021 21:59:11' prior: 50977833 overrides: 50972279!
initialize
	
	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: 'Tus Libros'.
	self model: (TusLibrosLogInWindowModel new).
	self morphExtent: 1035@485.
	self buildMorphicWindow.
	self openInWorld.
			
	"self model when: #newWordsArrived send: #refreshListOfWords to: self"! !
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/21/2021 21:59:49' prior: 50977943!
build1stRow
	| firstRowLayoutMorph usernameTextBoxMorph |
	
	usernameTextBoxMorph := TextModelMorph textProvider: self model textGetter: #usernameText textSetter: #usernameText:. 
	usernameTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | usernameTextBoxMorph innerTextMorph acceptContents ] .
	usernameTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300. 
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents: 'Username');
	addMorph: usernameTextBoxMorph.
	
	^ firstRowLayoutMorph.! !

!classDefinition: #TusLibrosRestInterface category: 'TusLibros-View' stamp: 'JD 11/21/2021 22:01:30'!
Object subclass: #TusLibrosRestInterface
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!
!TusLibrosLogInWindowModel methodsFor: 'no messages' stamp: 'JD 11/21/2021 22:01:24' overrides: 16896425!
initialize
	
	| password restInterface username |
	username := ''.
	password := ''.
	restInterface := TusLibrosRestInterface new! !
!TusLibrosLogInWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/21/2021 22:02:15' prior: 50978052 overrides: 16896425!
initialize! !

!classDefinition: #TusLibrosLogInWindowModel category: 'TusLibros-View' stamp: 'JD 11/21/2021 22:02:25'!
Object subclass: #TusLibrosLogInWindowModel
	instanceVariableNames: 'username'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!

!classDefinition: #TusLibrosLogInWindowModel category: 'TusLibros-View' stamp: 'JD 11/21/2021 22:02:27'!
Object subclass: #TusLibrosLogInWindowModel
	instanceVariableNames: 'username password'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!

!classDefinition: #TusLibrosLogInWindowModel category: 'TusLibros-View' stamp: 'JD 11/21/2021 22:02:28'!
Object subclass: #TusLibrosLogInWindowModel
	instanceVariableNames: 'username password restInterface'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!
!TusLibrosLogInWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/21/2021 22:02:23' prior: 50978061 overrides: 16896425!
initialize
	
	username := ''.
	password := ''.
	restInterface := TusLibrosRestInterface new! !
!TusLibrosLogInWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/21/2021 22:03:48'!
usernameText: aUsername
	
	username := aUsername.
	^ true! !
!TusLibrosLogInWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/21/2021 22:04:02'!
usernameText
	
	^ username ! !
!TusLibrosLogInWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/21/2021 22:04:15'!
password
	
	^ password ! !
!TusLibrosLogInWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/21/2021 22:04:28'!
passwordText
	
	^ password ! !

!methodRemoval: TusLibrosLogInWindowModel #password stamp: 'JD 11/21/2021 22:04:28'!
password
	
	^ password !
!TusLibrosLogInWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/21/2021 22:04:50'!
passwordText: aUserPassword
	
	password := aUserPassword.
	^ true! !
!TusLibrosLogInWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/21/2021 22:23:54'!
sendCreateCartRequest
	
	| cartId |
	cartId := restInterface sendCreateCartRequestWith: username and: password.
	
	self triggerEvent: #newCartCreated
	! !
!TusLibrosLogInWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/21/2021 22:25:54' prior: 50978124!
sendCreateCartRequest
	
	| cartId |
	
	cartId := restInterface sendCreateCartRequestWith: username and: password.
	
	self triggerEvent: #newCartCreated withArguments: (Array with: cartId)
	! !
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/21/2021 22:31:21' prior: 50978008 overrides: 50972279!
initialize
	
	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: 'Tus Libros'.
	self model: (TusLibrosLogInWindowModel new).
	self morphExtent: 1035@485.
	self buildMorphicWindow.
	self openInWorld.
			
	self model when: #newCartCreated send: #redirectToCatalogWindow to: self! !

----SNAPSHOT----(21 November 2021 22:32:00) CuisUniversity-4972.image priorSource: 20678216!

----STARTUP---- (22 November 2021 13:00:08) as /home/juli/Documentos/Facu/Inge1/cuis-university/CuisUniversity-4972.image!

!TusLibrosRestInterface methodsFor: 'nil' stamp: 'JD 11/22/2021 13:34:12'!
sendCreateCartRequestWith: aUsername and: aPassword
	
	| response urlFields |
	urlFields := Dictionary newFromPairs: {'user'. aUsername. 'password'. aPassword}.
	
	response := WebClient htmlSubmit: (self rootUrl, '/create-cart') fields: urlFields method: 'POST'.
	
	response isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((response content) readStream)) asOrderedCollection .] 
		ifFalse:[^self error: response content].! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 13:34:22' prior: 50978162!
sendCreateCartRequestWith: aUsername and: aPassword
	
	| response urlFields |
	
	urlFields := Dictionary newFromPairs: {'user'. aUsername. 'password'. aPassword}.
	
	response := WebClient htmlSubmit: (self rootUrl, '/create-cart') fields: urlFields method: 'POST'.
	
	response isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((response content) readStream)) asOrderedCollection .] 
		ifFalse:[^self error: response content].! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 13:35:17'!
createCartUrl

	^ self rootUrl, '/create-cart'! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 13:35:17' prior: 50978179!
sendCreateCartRequestWith: aUsername and: aPassword
	
	| response urlFields |
	
	urlFields := Dictionary newFromPairs: {'user'. aUsername. 'password'. aPassword}.
	
	response := WebClient htmlSubmit: (self createCartUrl) fields: urlFields method: 'POST'.
	
	response isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((response content) readStream)) asOrderedCollection .] 
		ifFalse:[^self error: response content].! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 13:35:24' prior: 50978201!
sendCreateCartRequestWith: aUsername and: aPassword
	
	| response urlFields |
	
	urlFields := Dictionary newFromPairs: {'user'. aUsername. 'password'. aPassword}.
	
	response := WebClient htmlSubmit: self createCartUrl fields: urlFields method: 'POST'.
	
	response isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((response content) readStream)) asOrderedCollection .] 
		ifFalse:[^self error: response content].! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 13:35:50'!
rootUrl

	^ 'http://localhost:', self port asString! !

!classDefinition: #TusLibrosRestInterface category: 'TusLibros-View' stamp: 'JD 11/22/2021 13:36:11'!
Object subclass: #TusLibrosRestInterface
	instanceVariableNames: 'port'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 13:35:59'!
port
	
	^ port ifNil: [port:=8080].! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 13:39:24' prior: 50978218!
sendCreateCartRequestWith: aUsername and: aPassword
	
	| response urlFields |
	
	urlFields := Dictionary newFromPairs: {'user'. aUsername. 'password'. aPassword}.
	
	response := WebClient htmlSubmit: self createCartUrl fields: urlFields method: 'POST'.
	
	response isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((response content) readStream)) asOrderedCollection .]
		ifFalse:[^self error: response content].! !
!TusLibrosLogInWindow class methodsFor: 'no messages' stamp: 'JD 11/22/2021 13:40:58'!
open
	
	^self new initializeWith: 'Tus Libros Login'.! !
!TusLibrosLogInWindow class methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 13:41:03' prior: 50978268!
open
	
	^ self new initializeWith: 'Tus Libros Login'.! !
!TusLibrosLogInWindow class methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 13:41:19' prior: 50978274!
open
	
	^ self new! !
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 13:41:28' prior: 50978143 overrides: 50972279!
initialize
	
	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: 'Tus Libros Login'.
	self model: (TusLibrosLogInWindowModel new).
	self morphExtent: 1035@485.
	self buildMorphicWindow.
	self openInWorld.
			
	self model when: #newCartCreated send: #redirectToCatalogWindow to: self! !

----SNAPSHOT----(22 November 2021 13:42:14) CuisUniversity-4972.image priorSource: 20688139!
!TusLibrosLogInWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 13:44:29' prior: 50978133!
sendCreateCartRequest
	
	| cartId |
	
	cartId := restInterface sendCreateCartRequestWith: username and: password.
	
	self triggerEvent: #newCartCreated with: cartId
	! !
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 13:45:42' prior: 50978285 overrides: 50972279!
initialize
	
	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: 'Tus Libros Login'.
	self model: (TusLibrosLogInWindowModel new).
	self morphExtent: 1035@485.
	self buildMorphicWindow.
	self openInWorld.
			
	self model when: #newCartCreated send: #redirectToCatalogWindowWith: to: self! !

!classDefinition: #TusLibrosCatalogWindow category: 'TusLibros-View' stamp: 'JD 11/22/2021 14:29:25'!
Object subclass: #TusLibrosCatalogWindow
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 14:29:22'!
redirectToCatalogWindowWith: aCartId
	
	TusLibrosCatalogWindow openFor: aCartId! !

	tusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

s!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog aTusLibrosServer |

	userAndPassword := Dictionary new.
	userAndPassword at: 'validUser' put: 'validUserPassword'.
	catalog := Dictionary new.
	catalog at: 'book' put: 10.

	aTusLibrosServer := TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. !

	client := TusLibrosLogInWindow open.!

Panel subclass: #TusLibrosCatalogWindow
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!

!classDefinition: #TusLibrosCatalogWindow category: 'TusLibros-View' stamp: 'JD 11/22/2021 14:34:07'!
Panel subclass: #TusLibrosCatalogWindow
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!

	client := TusLibrosLogInWindow open.!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog aTusLibrosServer |

	userAndPassword := Dictionary new.
	userAndPassword at: 'validUser' put: 'validUserPassword'.
	catalog := Dictionary new.
	catalog at: 'book' put: 10.

	aTusLibrosServer := TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
!

	client := TusLibrosLogInWindow open.!
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 14:35:29' prior: 50978311 overrides: 50972279!
initialize
	
	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: 'Tus Libros Log In'.
	self model: (TusLibrosLogInWindowModel new).
	self morphExtent: 1035@485.
	self buildMorphicWindow.
	self openInWorld.
			
	self model when: #newCartCreated send: #redirectToCatalogWindowWith: to: self! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog aTusLibrosServer tusLibrosClient |

	userAndPassword := Dictionary new.
	userAndPassword at: 'validUser' put: 'validUserPassword'.
	catalog := Dictionary new.
	catalog at: 'book' put: 10.

	aTusLibrosServer := TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	tusLibrosClient := TusLibrosLogInWindow open.!

	StringsServicesRestInterface allInstances do: [:anInstance | anInstance destroy].!


	|server client|

	server := StringsServicesRestInterface listeningOn: 8080.
	client := WordsClientWindow open.!

	StringsServicesRestInterface allInstances do: [:anInstance | anInstance destroy].!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

	StringsServicesRestInterface allInstances do: [:anInstance | anInstance destroy].!


	| userAndPassword catalog aTusLibrosServer tusLibrosClient |

	userAndPassword := Dictionary new.
	userAndPassword at: 'validUser' put: 'validUserPassword'.
	catalog := Dictionary new.
	catalog at: 'book' put: 10.

	aTusLibrosServer := TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	tusLibrosClient := TusLibrosLogInWindow open.!
!TusLibrosLogInWindow class methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 14:40:43' prior: 50978280!
open
	
	^ self new initializeWith: 'Tus Libros Log In'! !
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 14:41:03'!
initializeWith: aLabel
	
	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: aLabel.
	self model: (TusLibrosLogInWindowModel new).
	self morphExtent: 1035@485.
	self buildMorphicWindow.
	self openInWorld.
			
	self model when: #newCartCreated send: #redirectToCatalogWindowWith: to: self! !
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 14:41:15' prior: 50978395 overrides: 50972279!
initialize
	
	"self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: 'Tus Libros Log In'.
	self model: (TusLibrosLogInWindowModel new).
	self morphExtent: 1035@485.
	self buildMorphicWindow.
	self openInWorld.
			
	self model when: #newCartCreated send: #redirectToCatalogWindowWith: to: self"! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog aTusLibrosServer tusLibrosClient |

	userAndPassword := Dictionary new.
	userAndPassword at: 'validUser' put: 'validUserPassword'.
	catalog := Dictionary new.
	catalog at: 'book' put: 10.

	aTusLibrosServer := TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	tusLibrosClient := TusLibrosLogInWindow open.!

self titleMorph!
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 14:42:03' prior: 50978477 overrides: 50972279!
initialize
	
	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: 'Tus Libros Log In'.
	self model: (TusLibrosLogInWindowModel new).
	self morphExtent: 1035@485.
	self buildMorphicWindow.
	self openInWorld.
			
	self model when: #newCartCreated send: #redirectToCatalogWindowWith: to: self! !

!methodRemoval: TusLibrosLogInWindow #initializeWith: stamp: 'JD 11/22/2021 14:42:06'!
initializeWith: aLabel
	
	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: aLabel.
	self model: (TusLibrosLogInWindowModel new).
	self morphExtent: 1035@485.
	self buildMorphicWindow.
	self openInWorld.
			
	self model when: #newCartCreated send: #redirectToCatalogWindowWith: to: self!
!TusLibrosLogInWindow class methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 14:42:12' prior: 50978458!
open
	
	^ self new! !
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 14:43:16' prior: 50978512 overrides: 50972279!
initialize
	
	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: 'Tus Libros Log In'.
	self model: (TusLibrosLogInWindowModel new).
	self morphExtent: 1035@485.
	self buildMorphicWindow.
	self openInWorld.
			
	self model when: #newCartCreated send: #redirectToCatalogWindowWith: to: self! !

	tusLibrosClient := TusLibrosLogInWindow open.!

----SNAPSHOT----(22 November 2021 14:44:51) CuisUniversity-4972.image priorSource: 20692689!

----STARTUP---- (22 November 2021 14:45:01) as /home/juli/Documentos/Facu/Inge1/cuis-university/CuisUniversity-4972.image!


	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

	StringsServicesRestInterface allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog aTusLibrosServer tusLibrosClient |

	userAndPassword := Dictionary new.
	userAndPassword at: 'validUser' put: 'validUserPassword'.
	catalog := Dictionary new.
	catalog at: 'book' put: 10.

	aTusLibrosServer := TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	tusLibrosClient := TusLibrosLogInWindow open.!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

	StringsServicesRestInterface allInstances do: [:anInstance | anInstance destroy].!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

	StringsServicesRestInterface allInstances do: [:anInstance | anInstance destroy].!

!classRemoval: #TusLibrosRestInterface stamp: 'JD 11/22/2021 14:48:36'!
Object subclass: #TusLibrosRestInterface
	instanceVariableNames: 'port'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!

!classRemoval: #TusLibrosLogInWindowModel stamp: 'JD 11/22/2021 14:48:36'!
Object subclass: #TusLibrosLogInWindowModel
	instanceVariableNames: 'username password restInterface'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!

!classRemoval: #TusLibrosLogInWindow stamp: 'JD 11/22/2021 14:48:36'!
Panel subclass: #TusLibrosLogInWindow
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!

!classRemoval: #TusLibrosCatalogWindow stamp: 'JD 11/22/2021 14:48:37'!
Panel subclass: #TusLibrosCatalogWindow
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!

----End fileIn of /home/juli/Documentos/Facu/Inge1/cuis-university/TusLibros-View.st----!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog aTusLibrosServer tusLibrosClient |

	userAndPassword := Dictionary new.
	userAndPassword at: 'validUser' put: 'validUserPassword'.
	catalog := Dictionary new.
	catalog at: 'book' put: 10.

	aTusLibrosServer := TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	tusLibrosClient := TusLibrosLogInWindow open.!

!classRemoval: #TusLibrosRestInterface stamp: 'JD 11/22/2021 14:49:30'!
Object subclass: #TusLibrosRestInterface
	instanceVariableNames: 'port'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!

!classRemoval: #TusLibrosLogInWindowModel stamp: 'JD 11/22/2021 14:49:31'!
Object subclass: #TusLibrosLogInWindowModel
	instanceVariableNames: 'username password restInterface'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!

!classRemoval: #TusLibrosLogInWindow stamp: 'JD 11/22/2021 14:49:31'!
Panel subclass: #TusLibrosLogInWindow
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!

!classRemoval: #TusLibrosCatalogWindow stamp: 'JD 11/22/2021 14:49:31'!
Panel subclass: #TusLibrosCatalogWindow
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!

!classRemoval: #StringsServicesRestInterface stamp: 'JD 11/22/2021 14:49:48'!
Object subclass: #StringsServicesRestInterface
	instanceVariableNames: 'webServer port stringGenius'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'StringsServicesServer'!

!classRemoval: #StringGenius stamp: 'JD 11/22/2021 14:49:48'!
Object subclass: #StringGenius
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'StringsServicesServer'!

----End fileIn of /home/juli/Documentos/Facu/Inge1/2021-2c/20-TusLibros/Iteracion 4/WebClient.pck.st----!

CodePackage subclass: #MorphicMisc1Package
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Misc1'!

!classDefinition: #MorphicMisc1Package category: 'Morphic-Misc1' stamp: 'Install-Morphic-Misc1 11/22/2021 14:50:52'!
CodePackage subclass: #MorphicMisc1Package
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Misc1'!
!MorphicMisc1Package commentStamp: '<historical>' prior: 50968835!
My purpose in life is to check that any base image methods overridden have not been updated.
See #MorphMisc1Package class>>prePackageInstall!

MorphicMisc1Package class
	instanceVariableNames: ''!

!classDefinition: 'MorphicMisc1Package class' category: 'Morphic-Misc1' stamp: 'Install-Morphic-Misc1 11/22/2021 14:50:52'!
MorphicMisc1Package class
	instanceVariableNames: ''!

----End fileIn of /home/juli/Documentos/Facu/Inge1/cuis-university/Packages/Morphic/Morphic-Misc1/Morphic-Misc1.pck.st----!

----End fileIn of /home/juli/Documentos/Facu/Inge1/cuis-university/Packages/Morphic/Morphic-Widgets-Extras.pck.st----!

----End fileIn of /home/juli/Documentos/Facu/Inge1/cuis-university/TusLibros-View.st----!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog aTusLibrosServer tusLibrosClient |

	userAndPassword := Dictionary new.
	userAndPassword at: 'validUser' put: 'validUserPassword'.
	catalog := Dictionary new.
	catalog at: 'book' put: 10.

	aTusLibrosServer := TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	tusLibrosClient := TusLibrosLogInWindow open.!

----End fileIn of /home/juli/Documentos/Facu/Inge1/2021-2c/20-TusLibros/Iteracion 4/WordsClientDemo.st----!

----End fileIn of /home/juli/Documentos/Facu/Inge1/2021-2c/20-TusLibros/Iteracion 4/StringsServicesServer.st----!

	StringsServicesRestInterface allInstances do: [:anInstance | anInstance destroy].!

	|server client|

	server := StringsServicesRestInterface listeningOn: 8080.
	client := WordsClientWindow open.
!

	StringsServicesRestInterface allInstances do: [:anInstance | anInstance destroy].!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

!classRemoval: #SamplePlotterMorph stamp: 'JD 11/22/2021 14:55:13'!
WidgetMorph subclass: #SamplePlotterMorph
	instanceVariableNames: 'domain sampleSequences colors yMax yMin'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Widgets-Extras'!

!classRemoval: #OneLineEditorMorph stamp: 'JD 11/22/2021 14:55:13'!
WidgetMorph subclass: #OneLineEditorMorph
	instanceVariableNames: 'font emphasis contents editor showTextCursor pauseBlinking textCursorRect keyboardFocusWatcher crAction'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Widgets-Extras'!

!classRemoval: #MinimalStringMorph stamp: 'JD 11/22/2021 14:55:14'!
WidgetMorph subclass: #MinimalStringMorph
	instanceVariableNames: 'font emphasis contents'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Widgets-Extras'!

!classRemoval: #MagnifierMorph stamp: 'JD 11/22/2021 14:55:14'!
WidgetMorph subclass: #MagnifierMorph
	instanceVariableNames: 'magnification trackPointer lastPos srcExtent auxCanvas magnifiedForm'
	classVariableNames: 'RecursionLock'
	poolDictionaries: ''
	category: 'Morphic-Widgets-Extras'!

!classRemoval: #FunctionGraphMorph stamp: 'JD 11/22/2021 14:55:15'!
WidgetMorph subclass: #FunctionGraphMorph
	instanceVariableNames: 'xMin xMax yMin yMax functions colors yRangeInvalid'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Widgets-Extras'!

!classRemoval: #FrameRateMorph stamp: 'JD 11/22/2021 14:55:15'!
WidgetMorph subclass: #FrameRateMorph
	instanceVariableNames: 'lastStepDelta meanStepDelta'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Widgets-Extras'!

!classRemoval: #HandleMorph stamp: 'JD 11/22/2021 14:55:15'!
EllipseMorph subclass: #HandleMorph
	instanceVariableNames: 'pointBlock'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Widgets-Extras'!

!classRemoval: #EllipseMorph stamp: 'JD 11/22/2021 14:55:15'!
WidgetMorph subclass: #EllipseMorph
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Widgets-Extras'!

!classRemoval: #PartsBinMorph stamp: 'JD 11/22/2021 14:55:16'!
DragAndDropAreaMorph subclass: #PartsBinMorph
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Widgets-Extras'!

!classRemoval: #DragAndDropAreaMorph stamp: 'JD 11/22/2021 14:55:16'!
WidgetMorph subclass: #DragAndDropAreaMorph
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Widgets-Extras'!

!classRemoval: #LimitedHeightTextMorph stamp: 'JD 11/22/2021 14:55:16'!
TextModelMorph subclass: #LimitedHeightTextMorph
	instanceVariableNames: 'maxHeight'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Widgets-Extras'!

!classRemoval: #SimpleEditor stamp: 'JD 11/22/2021 14:55:17'!
Editor subclass: #SimpleEditor
	instanceVariableNames: 'string pointIndex markIndex'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Widgets-Extras'!

!classRemoval: #TextEditorTest stamp: 'JD 11/22/2021 14:55:20'!
TestCase subclass: #TextEditorTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Widgets-Extras-Tests'!

!classRemoval: #StringsServicesRestInterface stamp: 'JD 11/22/2021 14:55:31'!
Object subclass: #StringsServicesRestInterface
	instanceVariableNames: 'webServer port stringGenius'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'StringsServicesServer'!

!classRemoval: #StringGenius stamp: 'JD 11/22/2021 14:55:31'!
Object subclass: #StringGenius
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'StringsServicesServer'!

!classRemoval: #WordsRestInterface stamp: 'JD 11/22/2021 14:55:38'!
Object subclass: #WordsRestInterface
	instanceVariableNames: 'port'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'WordsClientDemo'!

!classRemoval: #WordsClientWindowModel stamp: 'JD 11/22/2021 14:55:38'!
Object subclass: #WordsClientWindowModel
	instanceVariableNames: 'sentence words selectedIndex restInterface'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'WordsClientDemo'!

!classRemoval: #WordsClientWindow stamp: 'JD 11/22/2021 14:55:39'!
Panel subclass: #WordsClientWindow
	instanceVariableNames: 'sentenceTextBoxMorph wordsListMorph'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'WordsClientDemo'!

!classRemoval: #TusLibrosRestInterface stamp: 'JD 11/22/2021 14:55:43'!
Object subclass: #TusLibrosRestInterface
	instanceVariableNames: 'port'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!

!classRemoval: #TusLibrosLogInWindowModel stamp: 'JD 11/22/2021 14:55:43'!
Object subclass: #TusLibrosLogInWindowModel
	instanceVariableNames: 'username password restInterface'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!

!classRemoval: #TusLibrosLogInWindow stamp: 'JD 11/22/2021 14:55:43'!
Panel subclass: #TusLibrosLogInWindow
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!

!classRemoval: #TusLibrosCatalogWindow stamp: 'JD 11/22/2021 14:55:44'!
Panel subclass: #TusLibrosCatalogWindow
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!

!classRemoval: #FrameMorph stamp: 'JD 11/22/2021 14:55:47'!
WidgetMorph subclass: #FrameMorph
	instanceVariableNames: 'colorIndex frameSelector'
	classVariableNames: 'Colors'
	poolDictionaries: ''
	category: 'Morphic-Misc1'!

!classRemoval: #FontMorph stamp: 'JD 11/22/2021 14:55:47'!
WidgetMorph subclass: #FontMorph
	instanceVariableNames: 'labelMorph'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Misc1'!

!classRemoval: #BorderedRectMorph stamp: 'JD 11/22/2021 14:55:47'!
WidgetMorph subclass: #BorderedRectMorph
	instanceVariableNames: 'borderStyle'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Misc1'!

!classRemoval: #MultiSelectMenu stamp: 'JD 11/22/2021 14:55:48'!
MenuMorph subclass: #MultiSelectMenu
	instanceVariableNames: 'choices seed result'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Misc1'!

!classRemoval: #SignMorph stamp: 'JD 11/22/2021 14:55:48'!
HoverHelpMorph subclass: #SignMorph
	instanceVariableNames: 'object'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Misc1'!

!classRemoval: #StringEntryPanel stamp: 'JD 11/22/2021 14:55:48'!
ValueEntryPanel subclass: #StringEntryPanel
	instanceVariableNames: 'stringEditMorph'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Misc1'!

!classRemoval: #PositiveIntegerEntryPanel stamp: 'JD 11/22/2021 14:55:49'!
ValueEntryPanel subclass: #PositiveIntegerEntryPanel
	instanceVariableNames: 'numberEntryMorph'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Misc1'!

!classRemoval: #PointEntryPanel stamp: 'JD 11/22/2021 14:55:49'!
ValueEntryPanel subclass: #PointEntryPanel
	instanceVariableNames: 'xEntryMorph yEntryMorph'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Misc1'!

!classRemoval: #CharacterEntryPanel stamp: 'JD 11/22/2021 14:55:49'!
ValueEntryPanel subclass: #CharacterEntryPanel
	instanceVariableNames: 'characterEditMorph'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Misc1'!

!classRemoval: #ValueEntryPanel stamp: 'JD 11/22/2021 14:55:50'!
Panel subclass: #ValueEntryPanel
	instanceVariableNames: 'kind'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Misc1'!

!classRemoval: #PickALargerIconPallet stamp: 'JD 11/22/2021 14:55:50'!
ImagePickerPanel subclass: #PickALargerIconPallet
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Misc1'!

!classRemoval: #PickAIconPallet stamp: 'JD 11/22/2021 14:55:50'!
ImagePickerPanel subclass: #PickAIconPallet
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Misc1'!

!classRemoval: #PickAColorPallet stamp: 'JD 11/22/2021 14:55:51'!
ImagePickerPanel subclass: #PickAColorPallet
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Misc1'!

!classRemoval: #ImagePickerPanel stamp: 'JD 11/22/2021 14:55:51'!
Panel subclass: #ImagePickerPanel
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Misc1'!

!classRemoval: #LayoutSpecEditPanel stamp: 'JD 11/22/2021 14:55:51'!
EditPanel subclass: #LayoutSpecEditPanel
	instanceVariableNames: 'widthArea heightArea paddingArea padRadio padEntry'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Misc1'!

!classRemoval: #LayoutMorphEditPanel stamp: 'JD 11/22/2021 14:55:52'!
EditPanel subclass: #LayoutMorphEditPanel
	instanceVariableNames: 'directionArea paddingArea separationArea colorArea padRadio padEntry'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Misc1'!

!classRemoval: #EditPanel stamp: 'JD 11/22/2021 14:55:52'!
Panel subclass: #EditPanel
	instanceVariableNames: 'editModel buttonArea'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Misc1'!

!classRemoval: #Panel stamp: 'JD 11/22/2021 14:55:52'!
PluggableMorph subclass: #Panel
	instanceVariableNames: 'widgetsColor titleMorph layoutMorph stayUp'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Misc1'!

!classRemoval: #DropTargetMorph stamp: 'JD 11/22/2021 14:55:53'!
SystemWindow subclass: #DropTargetMorph
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Misc1'!

!classRemoval: #MorphMessageBox stamp: 'JD 11/22/2021 14:55:53'!
WorkspaceWindow subclass: #MorphMessageBox
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Misc1'!

!classRemoval: #PluggableScrollBar stamp: 'JD 11/22/2021 14:55:54'!
ScrollBar subclass: #PluggableScrollBar
	instanceVariableNames: 'refreshValueSelector'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Misc1'!

!classRemoval: #PluggableImagePallet stamp: 'JD 11/22/2021 14:55:54'!
PluggableScrollPane subclass: #PluggableImagePallet
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Misc1'!

!classRemoval: #SqueezeLabelMorph stamp: 'JD 11/22/2021 14:55:54'!
LabelMorph subclass: #SqueezeLabelMorph
	instanceVariableNames: 'minChars'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Misc1'!

!classRemoval: #InnerPluggableImagePallet stamp: 'JD 11/22/2021 14:55:55'!
InnerPluggableMorph subclass: #InnerPluggableImagePallet
	instanceVariableNames: 'nameImageCollection imageFilter imageExtent calculatedExtent'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Misc1'!

!classRemoval: #DropColorMorph stamp: 'JD 11/22/2021 14:55:55'!
ImageMorph subclass: #DropColorMorph
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Misc1'!

!classRemoval: #ClickColorMorph stamp: 'JD 11/22/2021 14:55:55'!
ImageMorph subclass: #ClickColorMorph
	instanceVariableNames: 'colorTargetMorph'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Misc1'!

!classRemoval: #BorderedImageMorph stamp: 'JD 11/22/2021 14:55:56'!
ImageMorph subclass: #BorderedImageMorph
	instanceVariableNames: 'borderStyle'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Misc1'!

!classRemoval: #WindowTitleMorph stamp: 'JD 11/22/2021 14:55:56'!
LayoutMorph subclass: #WindowTitleMorph
	instanceVariableNames: 'titleMorph'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Misc1'!

!classRemoval: #RadioGroup stamp: 'JD 11/22/2021 14:55:56'!
LayoutMorph subclass: #RadioGroup
	instanceVariableNames: 'list font buttonOnLeft buttons'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Misc1'!

!classRemoval: #PalletLayoutMorph stamp: 'JD 11/22/2021 14:55:57'!
LayoutMorph subclass: #PalletLayoutMorph
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Misc1'!

!classRemoval: #PointerLineMorph stamp: 'JD 11/22/2021 14:55:57'!
LineMorph subclass: #PointerLineMorph
	instanceVariableNames: 'endPointMorph'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Misc1'!

!classRemoval: #LineMorph stamp: 'JD 11/22/2021 14:55:57'!
KernelMorph subclass: #LineMorph
	instanceVariableNames: 'startPointSelector endPointSelector lineWidth'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Misc1'!

!classRemoval: #AddedCursors stamp: 'JD 11/22/2021 14:55:58'!
CursorWithMask subclass: #AddedCursors
	instanceVariableNames: ''
	classVariableNames: 'ClosedHand OpenHand'
	poolDictionaries: ''
	category: 'Morphic-Misc1'!

!classRemoval: #MorphicMisc1Package stamp: 'JD 11/22/2021 14:55:58'!
CodePackage subclass: #MorphicMisc1Package
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Misc1'!

!classRemoval: #ColorExtrasPackage stamp: 'JD 11/22/2021 14:56:37'!
CodePackage subclass: #ColorExtrasPackage
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Color-Extras'!

!classRemoval: #WebUtils stamp: 'JD 11/22/2021 14:56:52'!
Object subclass: #WebUtils
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'WebClient-Core'!

!classRemoval: #WebSocket07 stamp: 'JD 11/22/2021 14:56:53'!
WebSocket subclass: #WebSocket07
	instanceVariableNames: 'frameType frameData closing masking'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'WebClient-Core'!

!classRemoval: #WebSocket00 stamp: 'JD 11/22/2021 14:56:53'!
WebSocket subclass: #WebSocket00
	instanceVariableNames: 'frameType frameData'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'WebClient-Core'!

!classRemoval: #WebSocket stamp: 'JD 11/22/2021 14:56:53'!
Object subclass: #WebSocket
	instanceVariableNames: 'name process stream handlers'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'WebClient-Core'!

!classRemoval: #WebServer stamp: 'JD 11/22/2021 14:56:54'!
Object subclass: #WebServer
	instanceVariableNames: 'listenerSocket listenerProcess interface port mutex connections entryPoints vault logAction nonceCache sessions serverString errorHandler accessLog certName siteUrl'
	classVariableNames: 'Default Registry'
	poolDictionaries: ''
	category: 'WebClient-Core'!

!classRemoval: #WebResponse stamp: 'JD 11/22/2021 14:56:54'!
WebMessage subclass: #WebResponse
	instanceVariableNames: 'request status code url'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'WebClient-Core'!

!classRemoval: #WebRequest stamp: 'JD 11/22/2021 14:56:55'!
WebMessage subclass: #WebRequest
	instanceVariableNames: 'method request rawUrl server'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'WebClient-Core'!

!classRemoval: #WebMessage stamp: 'JD 11/22/2021 14:56:55'!
Object subclass: #WebMessage
	instanceVariableNames: 'stream protocol headers content'
	classVariableNames: 'StatusCodes'
	poolDictionaries: ''
	category: 'WebClient-Core'!

!classRemoval: #WebCookie stamp: 'JD 11/22/2021 14:56:56'!
Object subclass: #WebCookie
	instanceVariableNames: 'name value path domain expiry version secure httpOnly comment'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'WebClient-Core'!

!classRemoval: #WebClient stamp: 'JD 11/22/2021 14:56:56'!
Object subclass: #WebClient
	instanceVariableNames: 'flags server scheme timeout stream cookies proxyServer lastScheme lastServer lastPort maxRedirect redirections userAgent authParams proxyParams accessLog debugLog'
	classVariableNames: 'DebugLog FlagAcceptCookies FlagAllowAuth FlagAllowRedirect ProxyHandler'
	poolDictionaries: ''
	category: 'WebClient-Core'!

!classRemoval: #WebAuthRequired stamp: 'JD 11/22/2021 14:56:57'!
Exception subclass: #WebAuthRequired
	instanceVariableNames: 'client request response authParams message'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'WebClient-Core'!

!classRemoval: #WebChunkedStream stamp: 'JD 11/22/2021 14:56:57'!
ReadStream subclass: #WebChunkedStream
	instanceVariableNames: 'sourceStream chunkSize'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'WebClient-Core'!

!classRemoval: #SqueakSSL stamp: 'JD 11/22/2021 14:57:03'!
Object subclass: #SqueakSSL
	instanceVariableNames: 'handle readBlock writeBlock'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'WebClient-SqueakSSL-Core'!

!classRemoval: #SecureSocketStream stamp: 'JD 11/22/2021 14:57:03'!
SocketStream subclass: #SecureSocketStream
	instanceVariableNames: 'ssl sendBuf readBuf decoded certIssues'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'WebClient-SqueakSSL-Core'!

!classRemoval: #SecureSocket stamp: 'JD 11/22/2021 14:57:04'!
Socket subclass: #SecureSocket
	instanceVariableNames: 'ssl decoded readBuf sendBuf'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'WebClient-SqueakSSL-Core'!

!classRemoval: #SqueakSSLCertificateError stamp: 'JD 11/22/2021 14:57:04'!
Error subclass: #SqueakSSLCertificateError
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'WebClient-SqueakSSL-Core'!

!classRemoval: #SocketStream stamp: 'JD 11/22/2021 14:58:28'!
Object subclass: #SocketStream
	instanceVariableNames: 'recentlyRead socket inBuffer outBuffer inNextToWrite outNextToWrite lastRead timeout autoFlush bufferSize binary shouldSignal'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Network-Kernel'!

!classRemoval: #Socket stamp: 'JD 11/22/2021 14:58:29'!
Object subclass: #Socket
	instanceVariableNames: 'semaphore socketHandle readSemaphore writeSemaphore'
	classVariableNames: 'Connected DeadServer InvalidSocket OtherEndClosed Registry RegistryThreshold TCPSocketType ThisEndClosed UDPSocketType Unconnected WaitingForConnection'
	poolDictionaries: ''
	category: 'Network-Kernel'!

!classRemoval: #NetNameResolver stamp: 'JD 11/22/2021 14:58:30'!
Object subclass: #NetNameResolver
	instanceVariableNames: ''
	classVariableNames: 'DefaultHostName HaveNetwork ResolverBusy ResolverError ResolverMutex ResolverReady ResolverSemaphore ResolverUninitialized'
	poolDictionaries: ''
	category: 'Network-Kernel'!

!classRemoval: #ConnectionQueue stamp: 'JD 11/22/2021 14:58:30'!
Object subclass: #ConnectionQueue
	instanceVariableNames: 'portNumber maxQueueLength connections accessSema socket process'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Network-Kernel'!

!classRemoval: #SocketPrimitiveFailed stamp: 'JD 11/22/2021 14:58:31'!
NetworkError subclass: #SocketPrimitiveFailed
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Network-Kernel'!

!classRemoval: #NoNetworkError stamp: 'JD 11/22/2021 14:58:31'!
NetworkError subclass: #NoNetworkError
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Network-Kernel'!

!classRemoval: #NameLookupFailure stamp: 'JD 11/22/2021 14:58:31'!
NetworkError subclass: #NameLookupFailure
	instanceVariableNames: 'hostName'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Network-Kernel'!

!classRemoval: #ConnectionTimedOut stamp: 'JD 11/22/2021 14:58:31'!
NetworkError subclass: #ConnectionTimedOut
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Network-Kernel'!

!classRemoval: #ConnectionRefused stamp: 'JD 11/22/2021 14:58:32'!
NetworkError subclass: #ConnectionRefused
	instanceVariableNames: 'host port'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Network-Kernel'!

!classRemoval: #ConnectionClosed stamp: 'JD 11/22/2021 14:58:32'!
NetworkError subclass: #ConnectionClosed
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Network-Kernel'!

!classRemoval: #NetworkError stamp: 'JD 11/22/2021 14:58:32'!
Error subclass: #NetworkError
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Network-Kernel'!

!classRemoval: #InvalidSocketStatusException stamp: 'JD 11/22/2021 14:58:33'!
Error subclass: #InvalidSocketStatusException
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Network-Kernel'!

----End fileIn of /home/juli/Documentos/Facu/Inge1/cuis-university-test/Packages/Morphic/Morphic-Widgets-Extras.pck.st----!

CodePackage subclass: #MorphicMisc1Package
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Misc1'!

!classDefinition: #MorphicMisc1Package category: 'Morphic-Misc1' stamp: 'Install-Morphic-Misc1 11/22/2021 15:06:12'!
CodePackage subclass: #MorphicMisc1Package
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Misc1'!
!MorphicMisc1Package commentStamp: '<historical>' prior: 0!
My purpose in life is to check that any base image methods overridden have not been updated.
See #MorphMisc1Package class>>prePackageInstall!

MorphicMisc1Package class
	instanceVariableNames: ''!

!classDefinition: 'MorphicMisc1Package class' category: 'Morphic-Misc1' stamp: 'Install-Morphic-Misc1 11/22/2021 15:06:12'!
MorphicMisc1Package class
	instanceVariableNames: ''!

----End fileIn of /home/juli/Documentos/Facu/Inge1/cuis-university-test/Packages/Morphic/Morphic-Misc1/Morphic-Misc1.pck.st----!

----End fileIn of /home/juli/Documentos/Facu/Inge1/2021-2c/20-TusLibros/Iteracion 4/WebClient.pck.st----!

----End fileIn of /home/juli/Documentos/Facu/Inge1/2021-2c/20-TusLibros/Iteracion 4/StringsServicesServer.st----!

----End fileIn of /home/juli/Documentos/Facu/Inge1/2021-2c/20-TusLibros/Iteracion 4/WordsClientDemo.st----!

----End fileIn of /home/juli/Documentos/Facu/Inge1/cuis-university/TusLibros-View.st----!

	|server client|

	server := StringsServicesRestInterface listeningOn: 8080.
	client := WordsClientWindow open.!

----End fileIn of /home/juli/Documentos/Facu/Inge1/2021-2c/20-TusLibros/Iteracion 4/WebClient.pck.st----!

	|server client|

	server := StringsServicesRestInterface listeningOn: 8080.
	client := WordsClientWindow open.!

----STARTUP---- (22 November 2021 15:07:49) as /home/juli/Documentos/Facu/Inge1/cuis-university/CuisUniversity-4972.image!


	|server client|

	server := StringsServicesRestInterface listeningOn: 8080.
	client := WordsClientWindow open.!

	StringsServicesRestInterface allInstances do: [:anInstance | anInstance destroy].!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog aTusLibrosServer tusLibrosClient |

	userAndPassword := Dictionary new.
	userAndPassword at: 'validUser' put: 'validUserPassword'.
	catalog := Dictionary new.
	catalog at: 'book' put: 10.

	aTusLibrosServer := TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	tusLibrosClient := TusLibrosLogInWindow open.!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 15:09:45'!
initializeWithTitle: aTitle
	
	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: aTitle.
	self model: (TusLibrosLogInWindowModel new).
	self morphExtent: 1035@485.
	self buildMorphicWindow.
	self openInWorld.
			
	self model when: #newCartCreated send: #redirectToCatalogWindowWith: to: self! !

!methodRemoval: TusLibrosLogInWindow #initialize stamp: 'JD 11/22/2021 15:09:50'!
initialize
	
	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: 'Tus Libros Log In'.
	self model: (TusLibrosLogInWindowModel new).
	self morphExtent: 1035@485.
	self buildMorphicWindow.
	self openInWorld.
			
	self model when: #newCartCreated send: #redirectToCatalogWindowWith: to: self!
!TusLibrosLogInWindow class methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 15:10:02' prior: 50978538!
open
	
	^ self new initializeWithTitle: 'Tus Libros Log In'! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog aTusLibrosServer tusLibrosClient |

	userAndPassword := Dictionary new.
	userAndPassword at: 'validUser' put: 'validUserPassword'.
	catalog := Dictionary new.
	catalog at: 'book' put: 10.

	aTusLibrosServer := TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	tusLibrosClient := TusLibrosLogInWindow open.
	!

----SNAPSHOT----(22 November 2021 15:10:32) CuisUniversity-4972.image priorSource: 20701000!

c!

c!

	StringsServicesRestInterface allInstances do: [:anInstance | anInstance destroy].!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

	|server client|

	server := StringsServicesRestInterface listeningOn: 8080.
	client := WordsClientWindow open.
!

	StringsServicesRestInterface allInstances do: [:anInstance | anInstance destroy].!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog aTusLibrosServer tusLibrosClient |

	userAndPassword := Dictionary new.
	userAndPassword at: 'validUser' put: 'validUserPassword'.
	catalog := Dictionary new.
	catalog at: 'book' put: 10.

	aTusLibrosServer := TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	tusLibrosClient := TusLibrosLogInWindow open.!
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 15:16:39' prior: 50978021!
build1stRow
	| firstRowLayoutMorph usernameTextBoxMorph |
	
	usernameTextBoxMorph := TextModelMorph textProvider: self model textGetter: #usernameText textSetter: #usernameText:. 
	usernameTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | usernameTextBoxMorph innerTextMorph acceptContents ] .
	usernameTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300. 
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 15;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents: 'Username');
	addMorph: usernameTextBoxMorph.
	
	^ firstRowLayoutMorph.! !

	tusLibrosClient := TusLibrosLogInWindow open.!

	tusLibrosClient := TusLibrosLogInWindow open.!
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 15:18:25' prior: 50978679!
build1stRow
	| firstRowLayoutMorph usernameTextBoxMorph |
	
	usernameTextBoxMorph := TextModelMorph textProvider: self model textGetter: #usernameText textSetter: #usernameText:. 
	usernameTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | usernameTextBoxMorph innerTextMorph acceptContents ] .
	usernameTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300. 
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 5;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents: 'Username');
	addMorph: usernameTextBoxMorph.
	
	^ firstRowLayoutMorph.! !

	tusLibrosClient := TusLibrosLogInWindow open.!
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 15:18:49' prior: 50978705!
build1stRow
	| firstRowLayoutMorph usernameTextBoxMorph |
	
	usernameTextBoxMorph := TextModelMorph textProvider: self model textGetter: #usernameText textSetter: #usernameText:. 
	usernameTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | usernameTextBoxMorph innerTextMorph acceptContents ] .
	usernameTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300. 
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents: 'Username');
	addMorph: usernameTextBoxMorph.
	
	^ firstRowLayoutMorph.! !

	tusLibrosClient := TusLibrosLogInWindow open.!
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 15:18:59' prior: 50978729!
build1stRow
	| firstRowLayoutMorph usernameTextBoxMorph |
	
	usernameTextBoxMorph := TextModelMorph textProvider: self model textGetter: #usernameText textSetter: #usernameText:. 
	usernameTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | usernameTextBoxMorph innerTextMorph acceptContents ] .
	usernameTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300. 
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents: 'Username');
	addMorph: usernameTextBoxMorph.
	
	^ firstRowLayoutMorph.! !

	tusLibrosClient := TusLibrosLogInWindow open.!
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 15:19:35' prior: 50977992!
build3rdRow
	| secondRowLayoutMorph sendRequestButtonMorph |
	
	sendRequestButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #sendCreateCartRequest label: 'Create Cart'.

	secondRowLayoutMorph := LayoutMorph newRow.
	secondRowLayoutMorph separation: 25;
	addMorph: sendRequestButtonMorph.
	
	^ sendRequestButtonMorph.! !

	tusLibrosClient := TusLibrosLogInWindow open.!
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 15:19:44' prior: 50978777!
build3rdRow
	| secondRowLayoutMorph sendRequestButtonMorph |
	
	sendRequestButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #sendCreateCartRequest label: 'Create Cart'.

	secondRowLayoutMorph := LayoutMorph newRow.
	secondRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: sendRequestButtonMorph.
	
	^ sendRequestButtonMorph.! !

	tusLibrosClient := TusLibrosLogInWindow open.!
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 15:19:57' prior: 50977967 overrides: 50972174!
buildMorphicWindow
		
	self layoutMorph beColumn;
	axisEdgeWeight: 0;
	addMorph: self build1stRow;
	addMorph: self build2ndRow;
	addMorph: self build3rdRow.! !

	tusLibrosClient := TusLibrosLogInWindow open.!
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 15:20:10' prior: 50978811 overrides: 50972174!
buildMorphicWindow
		
	self layoutMorph beColumn;
	separation: 35;
	axisEdgeWeight: 0;
	addMorph: self build1stRow;
	addMorph: self build2ndRow;
	addMorph: self build3rdRow.! !

	tusLibrosClient := TusLibrosLogInWindow open.!
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 15:20:20' prior: 50978822 overrides: 50972174!
buildMorphicWindow
		
	self layoutMorph beColumn;
	separation: 60;
	axisEdgeWeight: 0;
	addMorph: self build1stRow;
	addMorph: self build2ndRow;
	addMorph: self build3rdRow.! !

	tusLibrosClient := TusLibrosLogInWindow open.!
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 15:20:30' prior: 50978833 overrides: 50972174!
buildMorphicWindow
		
	self layoutMorph beColumn;
	separation: 0;
	axisEdgeWeight: 0;
	addMorph: self build1stRow;
	addMorph: self build2ndRow;
	addMorph: self build3rdRow.! !

	tusLibrosClient := TusLibrosLogInWindow open.!
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 15:20:37' prior: 50978844 overrides: 50972174!
buildMorphicWindow
		
	self layoutMorph beColumn;
	separation: 5;
	axisEdgeWeight: 0;
	addMorph: self build1stRow;
	addMorph: self build2ndRow;
	addMorph: self build3rdRow.! !

	tusLibrosClient := TusLibrosLogInWindow open.!
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 15:20:49' prior: 50978855 overrides: 50972174!
buildMorphicWindow
		
	self layoutMorph beColumn;
	separation: 15;
	axisEdgeWeight: 0;
	addMorph: self build1stRow;
	addMorph: self build2ndRow;
	addMorph: self build3rdRow.! !
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 15:20:55' prior: 50978866 overrides: 50972174!
buildMorphicWindow
		
	self layoutMorph beColumn;
	separation: 15;
	axisEdgeWeight: 20;
	addMorph: self build1stRow;
	addMorph: self build2ndRow;
	addMorph: self build3rdRow.! !

	tusLibrosClient := TusLibrosLogInWindow open.!
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 15:21:01' prior: 50978876 overrides: 50972174!
buildMorphicWindow
		
	self layoutMorph beColumn;
	separation: 15;
	axisEdgeWeight: 10;
	addMorph: self build1stRow;
	addMorph: self build2ndRow;
	addMorph: self build3rdRow.! !

	tusLibrosClient := TusLibrosLogInWindow open.!
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 15:21:09' prior: 50978887 overrides: 50972174!
buildMorphicWindow
		
	self layoutMorph beColumn;
	separation: 15;
	axisEdgeWeight: 1.0;
	addMorph: self build1stRow;
	addMorph: self build2ndRow;
	addMorph: self build3rdRow.! !

	tusLibrosClient := TusLibrosLogInWindow open.!
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 15:21:23' prior: 50978898 overrides: 50972174!
buildMorphicWindow
		
	self layoutMorph beColumn;
	separation: 15;
	axisEdgeWeight: 0;
	addMorph: self build1stRow;
	addMorph: self build2ndRow;
	addMorph: self build3rdRow.! !

	tusLibrosClient := TusLibrosLogInWindow open.!
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 15:22:02' prior: 50978753!
build1stRow
	| firstRowLayoutMorph usernameTextBoxMorph |
	
	usernameTextBoxMorph := TextModelMorph textProvider: self model textGetter: #usernameText textSetter: #usernameText:. 
	usernameTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | usernameTextBoxMorph innerTextMorph acceptContents ] .
	usernameTextBoxMorph  borderWidth: 0.5; borderColor: Color skyBlue; morphWidth: 300. 
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents: 'Username');
	addMorph: usernameTextBoxMorph.
	
	^ firstRowLayoutMorph.! !

	tusLibrosClient := TusLibrosLogInWindow open.!
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 15:22:10' prior: 50978921!
build1stRow
	| firstRowLayoutMorph usernameTextBoxMorph |
	
	usernameTextBoxMorph := TextModelMorph textProvider: self model textGetter: #usernameText textSetter: #usernameText:. 
	usernameTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | usernameTextBoxMorph innerTextMorph acceptContents ] .
	usernameTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300. 
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents: 'Username');
	addMorph: usernameTextBoxMorph.
	
	^ firstRowLayoutMorph.! !
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 15:22:13' prior: 50978946!
build1stRow
	| firstRowLayoutMorph usernameTextBoxMorph |
	
	usernameTextBoxMorph := TextModelMorph textProvider: self model textGetter: #usernameText textSetter: #usernameText:. 
	usernameTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | usernameTextBoxMorph innerTextMorph acceptContents ] .
	usernameTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 50. 
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents: 'Username');
	addMorph: usernameTextBoxMorph.
	
	^ firstRowLayoutMorph.! !

	tusLibrosClient := TusLibrosLogInWindow open.!
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 15:22:19' prior: 50978969!
build1stRow
	| firstRowLayoutMorph usernameTextBoxMorph |
	
	usernameTextBoxMorph := TextModelMorph textProvider: self model textGetter: #usernameText textSetter: #usernameText:. 
	usernameTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | usernameTextBoxMorph innerTextMorph acceptContents ] .
	usernameTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 200. 
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents: 'Username');
	addMorph: usernameTextBoxMorph.
	
	^ firstRowLayoutMorph.! !

	tusLibrosClient := TusLibrosLogInWindow open.!
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 15:23:36' prior: 50978993!
build1stRow
	| firstRowLayoutMorph usernameTextBoxMorph |
	
	usernameTextBoxMorph := TextModelMorph textProvider: self model textGetter: #usernameText textSetter: #usernameText:. 
	usernameTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | usernameTextBoxMorph innerTextMorph acceptContents ] .
	usernameTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 200; morphHeight: 100. 
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents: 'Username');
	addMorph: usernameTextBoxMorph.
	
	^ firstRowLayoutMorph.! !

	tusLibrosClient := TusLibrosLogInWindow open.!
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 15:23:42' prior: 50979017!
build1stRow
	| firstRowLayoutMorph usernameTextBoxMorph |
	
	usernameTextBoxMorph := TextModelMorph textProvider: self model textGetter: #usernameText textSetter: #usernameText:. 
	usernameTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | usernameTextBoxMorph innerTextMorph acceptContents ] .
	usernameTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 200; morphHeight: 20. 
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents: 'Username');
	addMorph: usernameTextBoxMorph.
	
	^ firstRowLayoutMorph.! !

	tusLibrosClient := TusLibrosLogInWindow open.!
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 15:23:54' prior: 50979042!
build1stRow
	| firstRowLayoutMorph usernameTextBoxMorph |
	
	usernameTextBoxMorph := TextModelMorph textProvider: self model textGetter: #usernameText textSetter: #usernameText:. 
	usernameTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | usernameTextBoxMorph innerTextMorph acceptContents ] .
	usernameTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 200; morphHeight: 30. 
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents: 'Username');
	addMorph: usernameTextBoxMorph.
	
	^ firstRowLayoutMorph.! !

	tusLibrosClient := TusLibrosLogInWindow open.!
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 15:24:03' prior: 50979067!
build1stRow
	| firstRowLayoutMorph usernameTextBoxMorph |
	
	usernameTextBoxMorph := TextModelMorph textProvider: self model textGetter: #usernameText textSetter: #usernameText:. 
	usernameTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | usernameTextBoxMorph innerTextMorph acceptContents ] .
	usernameTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 250; morphHeight: 30. 
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents: 'Username');
	addMorph: usernameTextBoxMorph.
	
	^ firstRowLayoutMorph.! !

	tusLibrosClient := TusLibrosLogInWindow open.!
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 15:24:15' prior: 50979092!
build1stRow
	| firstRowLayoutMorph usernameTextBoxMorph |
	
	usernameTextBoxMorph := TextModelMorph textProvider: self model textGetter: #usernameText textSetter: #usernameText:. 
	usernameTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | usernameTextBoxMorph innerTextMorph acceptContents ] .
	usernameTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300; morphHeight: 30. 
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents: 'Username');
	addMorph: usernameTextBoxMorph.
	
	^ firstRowLayoutMorph.! !

	tusLibrosClient := TusLibrosLogInWindow open.!
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 15:24:30' prior: 50977920!
build2ndRow
	| secondRowLayoutMorph passwordTextBoxMorph |
	
	passwordTextBoxMorph := TextModelMorph textProvider: self model textGetter: #passwordText textSetter: #passwordText:. 
	passwordTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | passwordTextBoxMorph innerTextMorph acceptContents ] .
	passwordTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300; morphHeight: 30.
		
	secondRowLayoutMorph := LayoutMorph newRow.
	secondRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents: 'Password');
	addMorph: passwordTextBoxMorph.
	
	^ secondRowLayoutMorph.! !

	tusLibrosClient := TusLibrosLogInWindow open.!
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 15:24:44' prior: 50978910 overrides: 50972174!
buildMorphicWindow
		
	self layoutMorph beColumn;
	separation: 1;
	axisEdgeWeight: 0;
	addMorph: self build1stRow;
	addMorph: self build2ndRow;
	addMorph: self build3rdRow.! !

	tusLibrosClient := TusLibrosLogInWindow open.!
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 15:24:55' prior: 50979168 overrides: 50972174!
buildMorphicWindow
		
	self layoutMorph beColumn;
	separation: -3;
	axisEdgeWeight: 0;
	addMorph: self build1stRow;
	addMorph: self build2ndRow;
	addMorph: self build3rdRow.! !

	tusLibrosClient := TusLibrosLogInWindow open.!
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 15:25:09' prior: 50979179 overrides: 50972174!
buildMorphicWindow
		
	self layoutMorph beColumn;
	separation: 200;
	axisEdgeWeight: 0;
	addMorph: self build1stRow;
	addMorph: self build2ndRow;
	addMorph: self build3rdRow.! !

	tusLibrosClient := TusLibrosLogInWindow open.!
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 15:25:18' prior: 50979190 overrides: 50972174!
buildMorphicWindow
		
	self layoutMorph beColumn;
	separation: 15;
	axisEdgeWeight: 0;
	addMorph: self build1stRow;
	addMorph: self build2ndRow;
	addMorph: self build3rdRow.! !
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 15:31:40' prior: 50979201 overrides: 50972174!
buildMorphicWindow
		
	self layoutMorph beColumn;
	separation: 15;
	axisEdgeWeight: 0;
	addMorph: self build1stRow;
	addMorph: self build2ndRow;
	addMorph: self build3rdRow;
	editMe.! !

	tusLibrosClient := TusLibrosLogInWindow open.!

	tusLibrosClient := TusLibrosLogInWindow open.!

	tusLibrosClient := TusLibrosLogInWindow open.!

	tusLibrosClient := TusLibrosLogInWindow open.!

	tusLibrosClient := TusLibrosLogInWindow open.!
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 15:43:46' prior: 50979211 overrides: 50972174!
buildMorphicWindow
		
	self layoutMorph beRow;
	separation: 15;
	axisEdgeWeight: 0;
	addMorph: self build1stRow;
	addMorph: self build2ndRow;
	addMorph: self build3rdRow;
	editMe.! !
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 15:45:19'!
build1stColumn
	| firstColumnLayoutMorph |
		
	firstColumnLayoutMorph := LayoutMorph newColumn.
	firstColumnLayoutMorph separation: 5;
	axisEdgeWeight: 0.5;
	addMorph: self build1stRow;
	addMorph: self build2ndRow;
	addMorph: self build3rdRow.
	
	^ firstColumnLayoutMorph.! !
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 15:45:33' prior: 50979229 overrides: 50972174!
buildMorphicWindow
		
	self layoutMorph beRow;
	separation: 15;
	axisEdgeWeight: 0;
	addMorph: self build1stColumn.! !

	tusLibrosClient := TusLibrosLogInWindow open.!
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 15:46:04' prior: 50979117!
build1stRow
	| firstRowLayoutMorph usernameTextBoxMorph |
	
	usernameTextBoxMorph := TextModelMorph textProvider: self model textGetter: #usernameText textSetter: #usernameText:. 
	usernameTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | usernameTextBoxMorph innerTextMorph acceptContents ] .
	usernameTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300; morphHeight: 30. 
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 5;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents: 'Username');
	addMorph: usernameTextBoxMorph.
	
	^ firstRowLayoutMorph.! !
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 15:46:07' prior: 50979142!
build2ndRow
	| secondRowLayoutMorph passwordTextBoxMorph |
	
	passwordTextBoxMorph := TextModelMorph textProvider: self model textGetter: #passwordText textSetter: #passwordText:. 
	passwordTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | passwordTextBoxMorph innerTextMorph acceptContents ] .
	passwordTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300; morphHeight: 30.
		
	secondRowLayoutMorph := LayoutMorph newRow.
	secondRowLayoutMorph separation: 5;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents: 'Password');
	addMorph: passwordTextBoxMorph.
	
	^ secondRowLayoutMorph.! !
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 15:46:11' prior: 50978793!
build3rdRow
	| secondRowLayoutMorph sendRequestButtonMorph |
	
	sendRequestButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #sendCreateCartRequest label: 'Create Cart'.

	secondRowLayoutMorph := LayoutMorph newRow.
	secondRowLayoutMorph separation: 5;
	axisEdgeWeight: 0.5;
	addMorph: sendRequestButtonMorph.
	
	^ sendRequestButtonMorph.! !

	tusLibrosClient := TusLibrosLogInWindow open.!
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 15:46:26' prior: 50979307!
build3rdRow
	| secondRowLayoutMorph sendRequestButtonMorph |
	
	sendRequestButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #sendCreateCartRequest label: 'Create Cart'.

	secondRowLayoutMorph := LayoutMorph newRow.
	secondRowLayoutMorph separation: 5;
	axisEdgeWeight: 0;
	addMorph: sendRequestButtonMorph.
	
	^ sendRequestButtonMorph.! !

	tusLibrosClient := TusLibrosLogInWindow open.!
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 15:46:38' prior: 50979324!
build3rdRow
	| secondRowLayoutMorph sendRequestButtonMorph |
	
	sendRequestButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #sendCreateCartRequest label: 'Create Cart'.

	secondRowLayoutMorph := LayoutMorph newRow.
	secondRowLayoutMorph separation: 5;
	axisEdgeWeight: 0.5;
	addMorph: sendRequestButtonMorph.
	
	^ sendRequestButtonMorph.! !
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 15:46:41' prior: 50979341!
build3rdRow
	| secondRowLayoutMorph sendRequestButtonMorph |
	
	sendRequestButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #sendCreateCartRequest label: 'Create Cart'.

	secondRowLayoutMorph := LayoutMorph newRow.
	secondRowLayoutMorph separation: 5;
	axisEdgeWeight: 0;
	addMorph: sendRequestButtonMorph.
	
	^ sendRequestButtonMorph.! !
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 15:46:47' prior: 50979283!
build2ndRow
	| secondRowLayoutMorph passwordTextBoxMorph |
	
	passwordTextBoxMorph := TextModelMorph textProvider: self model textGetter: #passwordText textSetter: #passwordText:. 
	passwordTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | passwordTextBoxMorph innerTextMorph acceptContents ] .
	passwordTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300; morphHeight: 30.
		
	secondRowLayoutMorph := LayoutMorph newRow.
	secondRowLayoutMorph separation: 5;
	axisEdgeWeight: 0;
	addMorph: (LabelMorph contents: 'Password');
	addMorph: passwordTextBoxMorph.
	
	^ secondRowLayoutMorph.! !
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 15:46:50' prior: 50979260!
build1stRow
	| firstRowLayoutMorph usernameTextBoxMorph |
	
	usernameTextBoxMorph := TextModelMorph textProvider: self model textGetter: #usernameText textSetter: #usernameText:. 
	usernameTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | usernameTextBoxMorph innerTextMorph acceptContents ] .
	usernameTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300; morphHeight: 30. 
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 5;
	axisEdgeWeight: 0;
	addMorph: (LabelMorph contents: 'Username');
	addMorph: usernameTextBoxMorph.
	
	^ firstRowLayoutMorph.! !

	tusLibrosClient := TusLibrosLogInWindow open.!
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 15:46:57' prior: 50979394!
build1stRow
	| firstRowLayoutMorph usernameTextBoxMorph |
	
	usernameTextBoxMorph := TextModelMorph textProvider: self model textGetter: #usernameText textSetter: #usernameText:. 
	usernameTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | usernameTextBoxMorph innerTextMorph acceptContents ] .
	usernameTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300; morphHeight: 30. 
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 5;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents: 'Username');
	addMorph: usernameTextBoxMorph.
	
	^ firstRowLayoutMorph.! !
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 15:47:03' prior: 50979371!
build2ndRow
	| secondRowLayoutMorph passwordTextBoxMorph |
	
	passwordTextBoxMorph := TextModelMorph textProvider: self model textGetter: #passwordText textSetter: #passwordText:. 
	passwordTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | passwordTextBoxMorph innerTextMorph acceptContents ] .
	passwordTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300; morphHeight: 30.
		
	secondRowLayoutMorph := LayoutMorph newRow.
	secondRowLayoutMorph separation: 5;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents: 'Password');
	addMorph: passwordTextBoxMorph.
	
	^ secondRowLayoutMorph.! !
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 15:47:08' prior: 50979356!
build3rdRow
	| secondRowLayoutMorph sendRequestButtonMorph |
	
	sendRequestButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #sendCreateCartRequest label: 'Create Cart'.

	secondRowLayoutMorph := LayoutMorph newRow.
	secondRowLayoutMorph separation: 5;
	axisEdgeWeight: 0.5;
	addMorph: sendRequestButtonMorph.
	
	^ sendRequestButtonMorph.! !

	tusLibrosClient := TusLibrosLogInWindow open.!
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 15:49:27' prior: 50979466!
build3rdRow
	| thirdRowLayoutMorph sendRequestButtonMorph |
	
	sendRequestButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #sendCreateCartRequest label: 'Create Cart'.

	thirdRowLayoutMorph := LayoutMorph newRow.
	thirdRowLayoutMorph separation: 5;
	axisEdgeWeight: 0.5;
	addMorph: sendRequestButtonMorph.
	
	^ thirdRowLayoutMorph.! !

	tusLibrosClient := TusLibrosLogInWindow open.!
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 15:50:58' prior: 50979251 overrides: 50972174!
buildMorphicWindow
		
	self layoutMorph beRow;
	separation: 5;
	axisEdgeWeight: 0;
	addMorph: self build1stColumn.! !

	tusLibrosClient := TusLibrosLogInWindow open.!
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 15:51:05' prior: 50979500 overrides: 50972174!
buildMorphicWindow
		
	self layoutMorph beRow;
	separation: 0;
	axisEdgeWeight: 0;
	addMorph: self build1stColumn.! !

	tusLibrosClient := TusLibrosLogInWindow open.!
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 15:51:35' prior: 50979510 overrides: 50972174!
buildMorphicWindow
		
	self layoutMorph beRow;
	axisEdgeWeight: 0;
	addMorph: self build1stColumn.! !

	tusLibrosClient := TusLibrosLogInWindow open.!
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 15:57:58' prior: 50979520 overrides: 50972174!
buildMorphicWindow
		
	self layoutMorph beRow;
	separation: 100;
	axisEdgeWeight: 0;
	addMorph: self build1stColumn.! !

	tusLibrosClient := TusLibrosLogInWindow open.!
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 15:58:11' prior: 50979529 overrides: 50972174!
buildMorphicWindow
		
	self layoutMorph beRow;
	separation: 200;
	axisEdgeWeight: 0;
	addMorph: self build1stColumn.! !

	tusLibrosClient := TusLibrosLogInWindow open.!
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 15:58:58' prior: 50979539 overrides: 50972174!
buildMorphicWindow
		
	self layoutMorph beRow;
	separation: 150;
	axisEdgeWeight: 0;
	addMorph: self build1stColumn.! !

	tusLibrosClient := TusLibrosLogInWindow open.!

----SNAPSHOT----(22 November 2021 15:59:25) CuisUniversity-4972.image priorSource: 20703768!

----SNAPSHOT----(22 November 2021 17:18:27) CuisUniversity-4972.image priorSource: 20733000!
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 17:21:17' prior: 50978332!
redirectToCatalogWindowWith: aCartId
	
	TusLibrosCatalogWindow openFor: aCartId in: self world! !
!TusLibrosCatalogWindow class methodsFor: 'no messages' stamp: 'JD 11/22/2021 17:22:57'!
openFor: aCartId in: aWorld
	
	^ self new initializeWithTitle: 'Tus Libros Catalog' for: aCartId in: aWorld! !

!classDefinition: #TusLibrosCatalogWindowModel category: 'TusLibros-View' stamp: 'JD 11/22/2021 17:41:16'!
Object subclass: #TusLibrosCatalogWindowModel
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!
!TusLibrosCatalogWindow methodsFor: 'nil' stamp: 'JD 11/22/2021 17:41:12'!
initializeWithTitle: aTitle for: aCartId in: aWorld
	
	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: aTitle.
	self model: (TusLibrosCatalogWindowModel new).
	self morphExtent: 1035@485.
	self buildMorphicWindow.
	self openInWorld: aWorld.
			
	self model when: #itemsAddedToCatalog send: #refreshCart to: self.
	self model when: #purchasesRequested send: #redirectToPurchases to: self.
	self model when: #cartCheckouted send: #redirectToSuccessfullyCheckout to: self! !

	StringsServicesRestInterface allInstances do: [:anInstance | anInstance destroy].!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog aTusLibrosServer tusLibrosClient |

	userAndPassword := Dictionary new.
	userAndPassword at: 'validUser' put: 'validUserPassword'.
	catalog := Dictionary new.
	catalog at: 'book' put: 10.

	aTusLibrosServer := TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	tusLibrosClient := TusLibrosLogInWindow open.!
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 17:43:05' prior: 50978252!
sendCreateCartRequestWith: aUsername and: aPassword
	
	| response urlFields |
	
	urlFields := Dictionary newFromPairs: {'user'. aUsername. 'password'. aPassword}.
	
	response := WebClient htmlSubmit: self createCartUrl fields: urlFields method: 'GET'.
	
	response isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((response content) readStream)) asOrderedCollection .]
		ifFalse:[^self error: response content].! !

	tusLibrosClient := TusLibrosLogInWindow open.!

response content!

(response content) readStream!
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 17:46:29' prior: 50979626!
sendCreateCartRequestWith: aUsername and: aPassword
	
	| response urlFields |
	
	urlFields := Dictionary newFromPairs: {'user'. aUsername. 'password'. aPassword}.
	
	response := WebClient htmlSubmit: self createCartUrl fields: urlFields method: 'GET'.
	
	response isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((response content) readStream) asOrderedCollection) .]
		ifFalse:[^self error: response content].! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog aTusLibrosServer tusLibrosClient |

	userAndPassword := Dictionary new.
	userAndPassword at: 'validUser' put: 'validUserPassword'.
	catalog := Dictionary new.
	catalog at: 'book' put: 10.

	aTusLibrosServer := TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	tusLibrosClient := TusLibrosLogInWindow open.!
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 17:48:18' prior: 50979646!
sendCreateCartRequestWith: aUsername and: aPassword
	
	| response urlFields |
	
	urlFields := Dictionary newFromPairs: {'user'. aUsername. 'password'. aPassword}.
	
	response := WebClient htmlSubmit: self createCartUrl fields: urlFields method: 'GET'.
	
	response isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((response content) readStream)) asOrderedCollection .]
		ifFalse:[^self error: response content].! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 17:48:34' prior: 50979682!
sendCreateCartRequestWith: aUsername and: aPassword
	
	| response urlFields |
	
	urlFields := Dictionary newFromPairs: {'user'. aUsername. 'password'. aPassword}.
	
	response := WebClient htmlSubmit: self createCartUrl fields: urlFields.
	
	response isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((response content) readStream)) asOrderedCollection .]
		ifFalse:[^self error: response content].! !

	TusLibrosLogInWindow open.!

(WebUtils jsonDecode: ((response content) readStream))!
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 17:49:27' prior: 50979699!
sendCreateCartRequestWith: aUsername and: aPassword
	
	| response urlFields |
	
	urlFields := Dictionary newFromPairs: {'user'. aUsername. 'password'. aPassword}.
	
	response := WebClient htmlSubmit: self createCartUrl fields: urlFields.
	
	response isSuccess 
		ifTrue:[^WebUtils jsonDecode: ((response content) readStream)]
		ifFalse:[^self error: response content].! !
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 18:07:51' prior: 50979564!
redirectToCatalogWindowWith: aCartId
	
	self model: (TusLibrosCatalogWindowModel newFor: aCartId).
	self buildMorphicCatalogWindow.! !
!TusLibrosLogInWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 18:09:55' prior: 50978593!
initializeWithTitle: aTitle
	
	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: aTitle.
	self model: (TusLibrosLogInWindowModel new).
	self morphExtent: 1035@485.
	self buildMorphicWindow.
	self openInWorld.
			
	self model when: #newCartCreated send: #redirectToCatalogWindowWith: to: self.
	self model when: #itemsAddedToCatalog send: #refreshCart to: self.
	self model when: #purchasesRequested send: #redirectToPurchases to: self.
	self model when: #cartCheckouted send: #redirectToSuccessfullyCheckout to: self! !

!classRemoval: #TusLibrosCatalogWindow stamp: 'JD 11/22/2021 18:10:06'!
Panel subclass: #TusLibrosCatalogWindow
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!

!classRenamed: #TusLibrosLogInWindow as: #TusLibrosWindow stamp: 'JD 11/22/2021 18:10:15'!
Smalltalk renameClassNamed: #TusLibrosLogInWindow as: #TusLibrosWindow!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

	StringsServicesRestInterface allInstances do: [:anInstance | anInstance destroy].!

	TusLibrosWindow open.!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: 'validUser' put: 'validUserPassword'.
	catalog := Dictionary new.
	catalog at: 'book' put: 10.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. !

!classDefinition: 'TusLibrosCatalogWindowModel class' category: 'TusLibros-View' stamp: 'JD 11/22/2021 18:16:02'!
TusLibrosCatalogWindowModel class
	instanceVariableNames: 'cartId'!

!classDefinition: 'TusLibrosCatalogWindowModel class' category: 'TusLibros-View' stamp: 'JD 11/22/2021 18:16:03'!
TusLibrosCatalogWindowModel class
	instanceVariableNames: 'cartId restInterface'!
!TusLibrosCatalogWindowModel class methodsFor: 'nil' stamp: 'JD 11/22/2021 18:16:00'!
newFor: aCartId
	
	cartId := aCartId.
	restInterface := TusLibrosRestInterface new
	! !
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 18:28:52'!
buildMorphicCatalogWindow
		
	self layoutMorph beRow;
	separation: 150;
	axisEdgeWeight: 0;
	addMorph: self buildCatalog;
	addMorph: self buildCart;	
	addMorph: self buildButtons.! !
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 18:30:52' prior: 50979238!
build1stColumn
	| firstColumnLayoutMorph |
		
	firstColumnLayoutMorph := LayoutMorph newColumn.
	firstColumnLayoutMorph separation: 5;
	axisEdgeWeight: 0.5;
	addMorph: self build1stRow;
	addMorph: self build2ndRow;
	addMorph: self build3rdRow.
	
	^ firstColumnLayoutMorph.! !
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 18:31:23' prior: 50979549 overrides: 50972174!
buildMorphicWindow
		
	self layoutMorph beRow;
	separation: 150;
	axisEdgeWeight: 0;
	addMorph: self build1stRow;
	addMorph: self build2ndRow;
	addMorph: self build3rdRow.! !

	TusLibrosWindow open.!
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 18:31:39' prior: 50979833 overrides: 50972174!
buildMorphicWindow
		
	self layoutMorph beColumn;
	separation: 150;
	axisEdgeWeight: 0;
	addMorph: self build1stRow;
	addMorph: self build2ndRow;
	addMorph: self build3rdRow.! !

	TusLibrosWindow open.!
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 18:31:48' prior: 50979843 overrides: 50972174!
buildMorphicWindow
		
	self layoutMorph beColumn;
	separation: 300;
	axisEdgeWeight: 0;
	addMorph: self build1stRow;
	addMorph: self build2ndRow;
	addMorph: self build3rdRow.! !

	TusLibrosWindow open.!
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 18:31:54' prior: 50979854 overrides: 50972174!
buildMorphicWindow
		
	self layoutMorph beColumn;
	separation: 1;
	axisEdgeWeight: 0;
	addMorph: self build1stRow;
	addMorph: self build2ndRow;
	addMorph: self build3rdRow.! !

	TusLibrosWindow open.!
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 18:32:08' prior: 50979865 overrides: 50972174!
buildMorphicWindow
		
	self layoutMorph beRow;
	separation: 1;
	axisEdgeWeight: 0;
	addMorph: self build1stRow;
	addMorph: self build2ndRow;
	addMorph: self build3rdRow.! !

	TusLibrosWindow open.!
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 18:32:23' prior: 50979876 overrides: 50972174!
buildMorphicWindow
		
	self layoutMorph beRow;
	separation: 150;
	axisEdgeWeight: 0;
	addMorph: self build1stColumn.! !
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 18:32:46'!
buildUsernameRow
	| firstRowLayoutMorph usernameTextBoxMorph |
	
	usernameTextBoxMorph := TextModelMorph textProvider: self model textGetter: #usernameText textSetter: #usernameText:. 
	usernameTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | usernameTextBoxMorph innerTextMorph acceptContents ] .
	usernameTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300; morphHeight: 30. 
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 5;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents: 'Username');
	addMorph: usernameTextBoxMorph.
	
	^ firstRowLayoutMorph.! !
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 18:32:46' prior: 50979820!
build1stColumn
	| firstColumnLayoutMorph |
		
	firstColumnLayoutMorph := LayoutMorph newColumn.
	firstColumnLayoutMorph separation: 5;
	axisEdgeWeight: 0.5;
	addMorph: self buildUsernameRow;
	addMorph: self build2ndRow;
	addMorph: self build3rdRow.
	
	^ firstColumnLayoutMorph.! !

!methodRemoval: TusLibrosWindow #build1stRow stamp: 'JD 11/22/2021 18:32:46'!
build1stRow
	| firstRowLayoutMorph usernameTextBoxMorph |
	
	usernameTextBoxMorph := TextModelMorph textProvider: self model textGetter: #usernameText textSetter: #usernameText:. 
	usernameTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | usernameTextBoxMorph innerTextMorph acceptContents ] .
	usernameTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300; morphHeight: 30. 
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 5;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents: 'Username');
	addMorph: usernameTextBoxMorph.
	
	^ firstRowLayoutMorph.!
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 18:32:58'!
buildPasswordRow
	| secondRowLayoutMorph passwordTextBoxMorph |
	
	passwordTextBoxMorph := TextModelMorph textProvider: self model textGetter: #passwordText textSetter: #passwordText:. 
	passwordTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | passwordTextBoxMorph innerTextMorph acceptContents ] .
	passwordTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300; morphHeight: 30.
		
	secondRowLayoutMorph := LayoutMorph newRow.
	secondRowLayoutMorph separation: 5;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents: 'Password');
	addMorph: passwordTextBoxMorph.
	
	^ secondRowLayoutMorph.! !
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 18:32:58' prior: 50979916!
build1stColumn
	| firstColumnLayoutMorph |
		
	firstColumnLayoutMorph := LayoutMorph newColumn.
	firstColumnLayoutMorph separation: 5;
	axisEdgeWeight: 0.5;
	addMorph: self buildUsernameRow;
	addMorph: self buildPasswordRow;
	addMorph: self build3rdRow.
	
	^ firstColumnLayoutMorph.! !

!methodRemoval: TusLibrosWindow #build2ndRow stamp: 'JD 11/22/2021 18:32:58'!
build2ndRow
	| secondRowLayoutMorph passwordTextBoxMorph |
	
	passwordTextBoxMorph := TextModelMorph textProvider: self model textGetter: #passwordText textSetter: #passwordText:. 
	passwordTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | passwordTextBoxMorph innerTextMorph acceptContents ] .
	passwordTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300; morphHeight: 30.
		
	secondRowLayoutMorph := LayoutMorph newRow.
	secondRowLayoutMorph separation: 5;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents: 'Password');
	addMorph: passwordTextBoxMorph.
	
	^ secondRowLayoutMorph.!
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 18:33:14'!
buildCreateCartButtonRow
	| thirdRowLayoutMorph sendRequestButtonMorph |
	
	sendRequestButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #sendCreateCartRequest label: 'Create Cart'.

	thirdRowLayoutMorph := LayoutMorph newRow.
	thirdRowLayoutMorph separation: 5;
	axisEdgeWeight: 0.5;
	addMorph: sendRequestButtonMorph.
	
	^ thirdRowLayoutMorph.! !
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 18:33:14' prior: 50979974!
build1stColumn
	| firstColumnLayoutMorph |
		
	firstColumnLayoutMorph := LayoutMorph newColumn.
	firstColumnLayoutMorph separation: 5;
	axisEdgeWeight: 0.5;
	addMorph: self buildUsernameRow;
	addMorph: self buildPasswordRow;
	addMorph: self buildCreateCartButtonRow.
	
	^ firstColumnLayoutMorph.! !

!methodRemoval: TusLibrosWindow #build3rdRow stamp: 'JD 11/22/2021 18:33:14'!
build3rdRow
	| thirdRowLayoutMorph sendRequestButtonMorph |
	
	sendRequestButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #sendCreateCartRequest label: 'Create Cart'.

	thirdRowLayoutMorph := LayoutMorph newRow.
	thirdRowLayoutMorph separation: 5;
	axisEdgeWeight: 0.5;
	addMorph: sendRequestButtonMorph.
	
	^ thirdRowLayoutMorph.!
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 18:34:01'!
buildLogInColumn
	| firstColumnLayoutMorph |
		
	firstColumnLayoutMorph := LayoutMorph newColumn.
	firstColumnLayoutMorph separation: 5;
	axisEdgeWeight: 0.5;
	addMorph: self buildUsernameRow;
	addMorph: self buildPasswordRow;
	addMorph: self buildCreateCartButtonRow.
	
	^ firstColumnLayoutMorph.! !
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 18:34:01' prior: 50979886 overrides: 50972174!
buildMorphicWindow
		
	self layoutMorph beRow;
	separation: 150;
	axisEdgeWeight: 0;
	addMorph: self buildLogInColumn.! !

!methodRemoval: TusLibrosWindow #build1stColumn stamp: 'JD 11/22/2021 18:34:01'!
build1stColumn
	| firstColumnLayoutMorph |
		
	firstColumnLayoutMorph := LayoutMorph newColumn.
	firstColumnLayoutMorph separation: 5;
	axisEdgeWeight: 0.5;
	addMorph: self buildUsernameRow;
	addMorph: self buildPasswordRow;
	addMorph: self buildCreateCartButtonRow.
	
	^ firstColumnLayoutMorph.!
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 18:38:50' prior: 50980063 overrides: 50972174!
buildMorphicWindow
		
	self layoutMorph beColumn;
	separation: 150;
	axisEdgeWeight: 0;
	addMorph: self buildUsernameRow;
	addMorph: self buildPasswordRow;
	addMorph: self buildCreateCartButtonRow.! !

	TusLibrosWindow open.!
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 18:39:00' prior: 50980083 overrides: 50972174!
buildMorphicWindow
		
	self layoutMorph beColumn;
	separation: 0;
	axisEdgeWeight: 0;
	addMorph: self buildUsernameRow;
	addMorph: self buildPasswordRow;
	addMorph: self buildCreateCartButtonRow.! !

	TusLibrosWindow open.!
!TusLibrosWindow methodsFor: 'log in - layouts' stamp: 'JD 11/22/2021 18:39:16' prior: 50980008!
buildCreateCartButtonRow
	| thirdRowLayoutMorph sendRequestButtonMorph |
	
	sendRequestButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #sendCreateCartRequest label: 'Create Cart'.

	thirdRowLayoutMorph := LayoutMorph newRow.
	thirdRowLayoutMorph separation: 150;
	axisEdgeWeight: 0.5;
	addMorph: sendRequestButtonMorph.
	
	^ thirdRowLayoutMorph.! !

	TusLibrosWindow open.!
!TusLibrosWindow methodsFor: 'log in - layouts' stamp: 'JD 11/22/2021 18:39:28' prior: 50979950!
buildPasswordRow
	| secondRowLayoutMorph passwordTextBoxMorph |
	
	passwordTextBoxMorph := TextModelMorph textProvider: self model textGetter: #passwordText textSetter: #passwordText:. 
	passwordTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | passwordTextBoxMorph innerTextMorph acceptContents ] .
	passwordTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300; morphHeight: 30.
		
	secondRowLayoutMorph := LayoutMorph newRow.
	secondRowLayoutMorph separation: 150;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents: 'Password');
	addMorph: passwordTextBoxMorph.
	
	^ secondRowLayoutMorph.! !

	TusLibrosWindow open.!
!TusLibrosWindow methodsFor: 'log in - layouts' stamp: 'JD 11/22/2021 18:39:37' prior: 50979893!
buildUsernameRow
	| firstRowLayoutMorph usernameTextBoxMorph |
	
	usernameTextBoxMorph := TextModelMorph textProvider: self model textGetter: #usernameText textSetter: #usernameText:. 
	usernameTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | usernameTextBoxMorph innerTextMorph acceptContents ] .
	usernameTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300; morphHeight: 30. 
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 150;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents: 'Username');
	addMorph: usernameTextBoxMorph.
	
	^ firstRowLayoutMorph.! !

	TusLibrosWindow open.!
!TusLibrosWindow methodsFor: 'log in - layouts' stamp: 'JD 11/22/2021 18:39:52' prior: 50980105!
buildCreateCartButtonRow
	| thirdRowLayoutMorph sendRequestButtonMorph |
	
	sendRequestButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #sendCreateCartRequest label: 'Create Cart'.

	thirdRowLayoutMorph := LayoutMorph newRow.
	thirdRowLayoutMorph separation: 10;
	axisEdgeWeight: 0.5;
	addMorph: sendRequestButtonMorph.
	
	^ thirdRowLayoutMorph.! !
!TusLibrosWindow methodsFor: 'log in - layouts' stamp: 'JD 11/22/2021 18:39:55' prior: 50980121!
buildPasswordRow
	| secondRowLayoutMorph passwordTextBoxMorph |
	
	passwordTextBoxMorph := TextModelMorph textProvider: self model textGetter: #passwordText textSetter: #passwordText:. 
	passwordTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | passwordTextBoxMorph innerTextMorph acceptContents ] .
	passwordTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300; morphHeight: 30.
		
	secondRowLayoutMorph := LayoutMorph newRow.
	secondRowLayoutMorph separation: 10;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents: 'Password');
	addMorph: passwordTextBoxMorph.
	
	^ secondRowLayoutMorph.! !
!TusLibrosWindow methodsFor: 'log in - layouts' stamp: 'JD 11/22/2021 18:39:58' prior: 50980145!
buildUsernameRow
	| firstRowLayoutMorph usernameTextBoxMorph |
	
	usernameTextBoxMorph := TextModelMorph textProvider: self model textGetter: #usernameText textSetter: #usernameText:. 
	usernameTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | usernameTextBoxMorph innerTextMorph acceptContents ] .
	usernameTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300; morphHeight: 30. 
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 10;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents: 'Username');
	addMorph: usernameTextBoxMorph.
	
	^ firstRowLayoutMorph.! !

	TusLibrosWindow open.!
!TusLibrosWindow methodsFor: 'log in - layouts' stamp: 'JD 11/22/2021 18:40:34' prior: 50980169!
buildCreateCartButtonRow
	| thirdRowLayoutMorph sendRequestButtonMorph |
	
	sendRequestButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #sendCreateCartRequest label: 'Create Cart'.

	thirdRowLayoutMorph := LayoutMorph newRow.
	thirdRowLayoutMorph separation: 50;
	axisEdgeWeight: 0.5;
	addMorph: sendRequestButtonMorph.
	
	^ thirdRowLayoutMorph.! !

	TusLibrosWindow open.!
!TusLibrosWindow methodsFor: 'log in - layouts' stamp: 'JD 11/22/2021 18:40:44' prior: 50980184!
buildPasswordRow
	| secondRowLayoutMorph passwordTextBoxMorph |
	
	passwordTextBoxMorph := TextModelMorph textProvider: self model textGetter: #passwordText textSetter: #passwordText:. 
	passwordTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | passwordTextBoxMorph innerTextMorph acceptContents ] .
	passwordTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300; morphHeight: 30.
		
	secondRowLayoutMorph := LayoutMorph newRow.
	secondRowLayoutMorph separation: 50;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents: 'Password');
	addMorph: passwordTextBoxMorph.
	
	^ secondRowLayoutMorph.! !

	TusLibrosWindow open.!
!TusLibrosWindow methodsFor: 'log in - layouts' stamp: 'JD 11/22/2021 18:40:52' prior: 50980207!
buildUsernameRow
	| firstRowLayoutMorph usernameTextBoxMorph |
	
	usernameTextBoxMorph := TextModelMorph textProvider: self model textGetter: #usernameText textSetter: #usernameText:. 
	usernameTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | usernameTextBoxMorph innerTextMorph acceptContents ] .
	usernameTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300; morphHeight: 30. 
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 50;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents: 'Username');
	addMorph: usernameTextBoxMorph.
	
	^ firstRowLayoutMorph.! !

	TusLibrosWindow open.!
!TusLibrosWindow methodsFor: 'log in - layouts' stamp: 'JD 11/22/2021 18:40:59' prior: 50980271!
buildUsernameRow
	| firstRowLayoutMorph usernameTextBoxMorph |
	
	usernameTextBoxMorph := TextModelMorph textProvider: self model textGetter: #usernameText textSetter: #usernameText:. 
	usernameTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | usernameTextBoxMorph innerTextMorph acceptContents ] .
	usernameTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300; morphHeight: 30. 
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 100;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents: 'Username');
	addMorph: usernameTextBoxMorph.
	
	^ firstRowLayoutMorph.! !

	TusLibrosWindow open.!
!TusLibrosWindow methodsFor: 'log in - layouts' stamp: 'JD 11/22/2021 18:41:20' prior: 50980247!
buildPasswordRow
	| secondRowLayoutMorph passwordTextBoxMorph |
	
	passwordTextBoxMorph := TextModelMorph textProvider: self model textGetter: #passwordText textSetter: #passwordText:. 
	passwordTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | passwordTextBoxMorph innerTextMorph acceptContents ] .
	passwordTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300; morphHeight: 30.
		
	secondRowLayoutMorph := LayoutMorph newRow.
	secondRowLayoutMorph separation: 100;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents: 'Password');
	addMorph: passwordTextBoxMorph.
	
	^ secondRowLayoutMorph.! !

	TusLibrosWindow open.!
!TusLibrosWindow methodsFor: 'log in - layouts' stamp: 'JD 11/22/2021 18:41:30' prior: 50980231!
buildCreateCartButtonRow
	| thirdRowLayoutMorph sendRequestButtonMorph |
	
	sendRequestButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #sendCreateCartRequest label: 'Create Cart'.

	thirdRowLayoutMorph := LayoutMorph newRow.
	thirdRowLayoutMorph separation: 100;
	axisEdgeWeight: 0.5;
	addMorph: sendRequestButtonMorph.
	
	^ thirdRowLayoutMorph.! !

	TusLibrosWindow open.!
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 18:43:22' prior: 50980094 overrides: 50972174!
buildMorphicWindow
		
	self layoutMorph beColumn;
	separation: 150;
	axisEdgeWeight: 0;
	addMorph: self buildUsernameRow;
	addMorph: self buildPasswordRow;
	addMorph: self buildCreateCartButtonRow.! !

	TusLibrosWindow open.!
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 18:43:32' prior: 50980360 overrides: 50972174!
buildMorphicWindow
		
	self layoutMorph beColumn;
	separation: -150;
	axisEdgeWeight: 0;
	addMorph: self buildUsernameRow;
	addMorph: self buildPasswordRow;
	addMorph: self buildCreateCartButtonRow.! !

	TusLibrosWindow open.!
!TusLibrosWindow methodsFor: 'log in - layouts' stamp: 'JD 11/22/2021 18:43:47' prior: 50980343!
buildCreateCartButtonRow
	| thirdRowLayoutMorph sendRequestButtonMorph |
	
	sendRequestButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #sendCreateCartRequest label: 'Create Cart'.

	thirdRowLayoutMorph := LayoutMorph newRow.
	thirdRowLayoutMorph separation: -150;
	axisEdgeWeight: 0.5;
	addMorph: sendRequestButtonMorph.
	
	^ thirdRowLayoutMorph.! !

	TusLibrosWindow open.!
!TusLibrosWindow methodsFor: 'log in - layouts' stamp: 'JD 11/22/2021 18:44:00' prior: 50980319!
buildPasswordRow
	| secondRowLayoutMorph passwordTextBoxMorph |
	
	passwordTextBoxMorph := TextModelMorph textProvider: self model textGetter: #passwordText textSetter: #passwordText:. 
	passwordTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | passwordTextBoxMorph innerTextMorph acceptContents ] .
	passwordTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300; morphHeight: 30.
		
	secondRowLayoutMorph := LayoutMorph newRow.
	secondRowLayoutMorph separation: -150;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents: 'Password');
	addMorph: passwordTextBoxMorph.
	
	^ secondRowLayoutMorph.! !

	TusLibrosWindow open.!
!TusLibrosWindow methodsFor: 'log in - layouts' stamp: 'JD 11/22/2021 18:44:46' prior: 50980398!
buildPasswordRow
	| secondRowLayoutMorph passwordTextBoxMorph |
	
	passwordTextBoxMorph := TextModelMorph textProvider: self model textGetter: #passwordText textSetter: #passwordText:. 
	passwordTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | passwordTextBoxMorph innerTextMorph acceptContents ] .
	passwordTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300; morphHeight: 30.
		
	secondRowLayoutMorph := LayoutMorph newRow.
	secondRowLayoutMorph separation: 5;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents: 'Password');
	addMorph: passwordTextBoxMorph.
	
	^ secondRowLayoutMorph.! !
!TusLibrosWindow methodsFor: 'log in - layouts' stamp: 'JD 11/22/2021 18:44:52' prior: 50980295!
buildUsernameRow
	| firstRowLayoutMorph usernameTextBoxMorph |
	
	usernameTextBoxMorph := TextModelMorph textProvider: self model textGetter: #usernameText textSetter: #usernameText:. 
	usernameTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | usernameTextBoxMorph innerTextMorph acceptContents ] .
	usernameTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300; morphHeight: 30. 
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 5;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents: 'Username');
	addMorph: usernameTextBoxMorph.
	
	^ firstRowLayoutMorph.! !
!TusLibrosWindow methodsFor: 'log in - layouts' stamp: 'JD 11/22/2021 18:45:00' prior: 50980382!
buildCreateCartButtonRow
	| thirdRowLayoutMorph sendRequestButtonMorph |
	
	sendRequestButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #sendCreateCartRequest label: 'Create Cart'.

	thirdRowLayoutMorph := LayoutMorph newRow.
	thirdRowLayoutMorph separation: 5;
	axisEdgeWeight: 0.5;
	addMorph: sendRequestButtonMorph.
	
	^ thirdRowLayoutMorph.! !

	TusLibrosWindow open.!
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 18:45:11' prior: 50980371 overrides: 50972174!
buildMorphicWindow
		
	self layoutMorph beColumn;
	separation: -300;
	axisEdgeWeight: 0;
	addMorph: self buildUsernameRow;
	addMorph: self buildPasswordRow;
	addMorph: self buildCreateCartButtonRow.! !

	TusLibrosWindow open.!
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 18:45:27' prior: 50980485 overrides: 50972174!
buildMorphicWindow
		
	self layoutMorph beColumn;
	separation: 500;
	axisEdgeWeight: 0;
	addMorph: self buildUsernameRow;
	addMorph: self buildPasswordRow;
	addMorph: self buildCreateCartButtonRow.! !

	TusLibrosWindow open.!
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 18:45:33' prior: 50980496 overrides: 50972174!
buildMorphicWindow
		
	self layoutMorph beColumn;
	separation: 20;
	axisEdgeWeight: 0;
	addMorph: self buildUsernameRow;
	addMorph: self buildPasswordRow;
	addMorph: self buildCreateCartButtonRow.! !

	TusLibrosWindow open.!
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 18:45:39' prior: 50980507 overrides: 50972174!
buildMorphicWindow
		
	self layoutMorph beColumn;
	separation: 5;
	axisEdgeWeight: 0;
	addMorph: self buildUsernameRow;
	addMorph: self buildPasswordRow;
	addMorph: self buildCreateCartButtonRow.! !

	TusLibrosWindow open.!
!TusLibrosWindow methodsFor: 'log in - layouts' stamp: 'JD 11/22/2021 18:47:22' prior: 50980422!
buildPasswordRow
	| secondRowLayoutMorph passwordTextBoxMorph |
	
	passwordTextBoxMorph := TextModelMorph textProvider: self model textGetter: #passwordText textSetter: #passwordText:. 
	passwordTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | passwordTextBoxMorph innerTextMorph acceptContents ] .
	passwordTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300; morphHeight: 30.
		
	secondRowLayoutMorph := LayoutMorph newRow.
	secondRowLayoutMorph separation: 5;
	axisEdgeWeight: 0.0;
	addMorph: (LabelMorph contents: 'Password');
	addMorph: passwordTextBoxMorph.
	
	^ secondRowLayoutMorph.! !

	TusLibrosWindow open.!
!TusLibrosWindow methodsFor: 'log in - layouts' stamp: 'JD 11/22/2021 18:47:28' prior: 50980529!
buildPasswordRow
	| secondRowLayoutMorph passwordTextBoxMorph |
	
	passwordTextBoxMorph := TextModelMorph textProvider: self model textGetter: #passwordText textSetter: #passwordText:. 
	passwordTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | passwordTextBoxMorph innerTextMorph acceptContents ] .
	passwordTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300; morphHeight: 30.
		
	secondRowLayoutMorph := LayoutMorph newRow.
	secondRowLayoutMorph separation: 5;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents: 'Password');
	addMorph: passwordTextBoxMorph.
	
	^ secondRowLayoutMorph.! !
!TusLibrosWindow methodsFor: 'log in - layouts' stamp: 'JD 11/22/2021 18:47:37' prior: 50980553!
buildPasswordRow
	| secondRowLayoutMorph passwordTextBoxMorph |
	
	passwordTextBoxMorph := TextModelMorph textProvider: self model textGetter: #passwordText textSetter: #passwordText:. 
	passwordTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | passwordTextBoxMorph innerTextMorph acceptContents ] .
	passwordTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300; morphHeight: 30.
		
	secondRowLayoutMorph := LayoutMorph newRow.
	secondRowLayoutMorph separation: 5;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents: 'Password');
	addMorph: passwordTextBoxMorph.
	
	^ secondRowLayoutMorph.! !
!TusLibrosWindow methodsFor: 'log in - layouts' stamp: 'JD 11/22/2021 18:48:28' prior: 50980576!
buildPasswordRow
	| secondRowLayoutMorph passwordTextBoxMorph |
	
	passwordTextBoxMorph := TextModelMorph textProvider: self model textGetter: #passwordText textSetter: #passwordText:. 
	passwordTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | passwordTextBoxMorph innerTextMorph acceptContents ] .
	passwordTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300.
		
	secondRowLayoutMorph := LayoutMorph newRow.
	secondRowLayoutMorph separation: 5;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents: 'Password');
	addMorph: passwordTextBoxMorph.
	
	^ secondRowLayoutMorph.! !

	TusLibrosWindow open.!
!TusLibrosWindow methodsFor: 'log in - layouts' stamp: 'JD 11/22/2021 18:48:39' prior: 50980599!
buildPasswordRow
	| secondRowLayoutMorph passwordTextBoxMorph |
	
	passwordTextBoxMorph := TextModelMorph textProvider: self model textGetter: #passwordText textSetter: #passwordText:. 
	passwordTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | passwordTextBoxMorph innerTextMorph acceptContents ] .
	passwordTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300; morphHeight: 30.
		
	secondRowLayoutMorph := LayoutMorph newRow.
	secondRowLayoutMorph separation: 5;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents: 'Password');
	addMorph: passwordTextBoxMorph.
	
	^ secondRowLayoutMorph.! !

	TusLibrosWindow open.!
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 18:50:04' prior: 50980518 overrides: 50972174!
buildMorphicWindow
		
	self layoutMorph beColumn;
	separation: 5;
	axisEdgeWeight: 0.5;
	addMorph: self buildUsernameRow;
	addMorph: self buildPasswordRow;
	addMorph: self buildCreateCartButtonRow.! !

	TusLibrosWindow open.!
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 18:32:23' prior: 50980648 overrides: 50972174!
buildMorphicWindow
		
	self layoutMorph beRow;
	separation: 150;
	axisEdgeWeight: 0;
	addMorph: self build1stColumn.! !
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 18:59:40' prior: 50980659 overrides: 50972174!
buildMorphicWindow
		
	self layoutMorph beRow;
	separation: 150;
	axisEdgeWeight: 0;
	addMorph: self buildLogInColumn.! !

	TusLibrosWindow open.!
!TusLibrosWindow methodsFor: 'windows build' stamp: 'JD 11/22/2021 19:27:31'!
buildCatalog
	
	| addToCartButtonMorph catalogListMorph catalogRow firstColumnLayoutMorph itemQuantityTextBoxMorph secondColumnLayoutMorph |
	catalogListMorph := PluggableListMorph model: self model listGetter: #catalog indexGetter: #catalogListIndex indexSetter: #catalogListIndex:.
	catalogListMorph borderColor: Color skyBlue; borderWidth: 1; morphWidth:300.
	
	firstColumnLayoutMorph := LayoutMorph newColumn.
	firstColumnLayoutMorph separation: 5; 
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents: 'Catalog');
	addMorph: catalogListMorph.
	
	itemQuantityTextBoxMorph := TextModelMorph textProvider: self model textGetter: #itemQuantityText textSetter: #itemQuantityText:. 
	itemQuantityTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | itemQuantityTextBoxMorph innerTextMorph acceptContents].
	itemQuantityTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300.
	
	addToCartButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #sendAddToCartRequest  label: 'Add To Cart'.
	
	secondColumnLayoutMorph := LayoutMorph newColumn.
	secondColumnLayoutMorph separation: 5; 
	axisEdgeWeight: 0.5;
	addMorph: itemQuantityTextBoxMorph;
	addMorph: addToCartButtonMorph.
	
	catalogRow := LayoutMorph newRow.
	catalogRow separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: firstColumnLayoutMorph;
	addMorph: secondColumnLayoutMorph.
	! !

----SNAPSHOT----(22 November 2021 19:27:48) CuisUniversity-4972.image priorSource: 20733094!

----STARTUP---- (22 November 2021 20:55:24) as /home/juli/Documentos/Facu/Inge1/cuis-university/CuisUniversity-4972.image!

!TusLibrosWindow methodsFor: 'windows build' stamp: 'JD 11/22/2021 20:57:15'!
buildCatalogColumn

	| catalogListMorph firstColumnLayoutMorph |
	catalogListMorph := PluggableListMorph model: self model listGetter: #catalog indexGetter: #catalogListIndex indexSetter: #catalogListIndex:.
	catalogListMorph borderColor: Color skyBlue; borderWidth: 1; morphWidth:300.
	
	firstColumnLayoutMorph := LayoutMorph newColumn.
	firstColumnLayoutMorph separation: 5; 
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents: 'Catalog');
	addMorph: catalogListMorph.
	
	^ firstColumnLayoutMorph! !
!TusLibrosWindow methodsFor: 'windows build' stamp: 'JD 11/22/2021 20:57:20' prior: 50980728!
buildCatalogColumn

	| catalogListMorph firstColumnLayoutMorph |

	catalogListMorph := PluggableListMorph model: self model listGetter: #catalog indexGetter: #catalogListIndex indexSetter: #catalogListIndex:.
	catalogListMorph borderColor: Color skyBlue; borderWidth: 1; morphWidth:300.
	
	firstColumnLayoutMorph := LayoutMorph newColumn.
	firstColumnLayoutMorph separation: 5; 
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents: 'Catalog');
	addMorph: catalogListMorph.
	
	^ firstColumnLayoutMorph! !
!TusLibrosWindow methodsFor: 'windows build' stamp: 'JD 11/22/2021 21:01:13'!
buildItemQuantityAndAddToCartButton
	
	| addToCartButtonMorph itemQuantityTextBoxMorph secondColumnLayoutMorph |
	itemQuantityTextBoxMorph := TextModelMorph textProvider: self model textGetter: #itemQuantityText textSetter: #itemQuantityText:. 
	itemQuantityTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | itemQuantityTextBoxMorph innerTextMorph acceptContents].
	itemQuantityTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300.
	
	addToCartButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #sendAddToCartRequest  label: 'Add To Cart'.
	
	secondColumnLayoutMorph := LayoutMorph newColumn.
	secondColumnLayoutMorph separation: 5; 
	axisEdgeWeight: 0.5;
	addMorph: itemQuantityTextBoxMorph;
	addMorph: addToCartButtonMorph.
	
	^ secondColumnLayoutMorph
! !
!TusLibrosWindow methodsFor: 'windows build' stamp: 'JD 11/22/2021 21:01:19' prior: 50980766!
buildItemQuantityAndAddToCartButton
	
	| addToCartButtonMorph itemQuantityTextBoxMorph secondColumnLayoutMorph |
	
	itemQuantityTextBoxMorph := TextModelMorph textProvider: self model textGetter: #itemQuantityText textSetter: #itemQuantityText:. 
	itemQuantityTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | itemQuantityTextBoxMorph innerTextMorph acceptContents].
	itemQuantityTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300.
	
	addToCartButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #sendAddToCartRequest  label: 'Add To Cart'.
	
	secondColumnLayoutMorph := LayoutMorph newColumn.
	secondColumnLayoutMorph separation: 5; 
	axisEdgeWeight: 0.5;
	addMorph: itemQuantityTextBoxMorph;
	addMorph: addToCartButtonMorph.
	
	^ secondColumnLayoutMorph
! !
!TusLibrosWindow methodsFor: 'windows build' stamp: 'JD 11/22/2021 21:03:02' prior: 50980675!
buildCatalog
	
	| catalogRow secondColumnLayoutMorph |

	
	secondColumnLayoutMorph := self buildItemQuantityAndAddToCartButton.	
	catalogRow := LayoutMorph newRow.
	catalogRow separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: self buildCatalogColumn ;
	addMorph: self buildItemQuantityAndAddToCartButton.
	! !
!TusLibrosWindow methodsFor: 'windows build' stamp: 'JD 11/22/2021 21:03:11' prior: 50980824!
buildCatalog
	
	| catalogRow |

	catalogRow := LayoutMorph newRow.
	catalogRow separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: self buildCatalogColumn ;
	addMorph: self buildItemQuantityAndAddToCartButton.
	! !
!TusLibrosWindow methodsFor: 'windows build' stamp: 'JD 11/22/2021 21:03:32' prior: 50980837!
buildCatalog
	
	| catalogRow |

	catalogRow := LayoutMorph newRow.
	catalogRow separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: self buildCatalogColumn ;
	addMorph: self buildItemQuantityAndAddToCartButton.
	
	^ catalogRow
	! !
!TusLibrosWindow methodsFor: 'windows build' stamp: 'JD 11/22/2021 21:03:52'!
buildItemQuantityAndAddToCartButtonColumn
	
	| addToCartButtonMorph itemQuantityTextBoxMorph secondColumnLayoutMorph |
	
	itemQuantityTextBoxMorph := TextModelMorph textProvider: self model textGetter: #itemQuantityText textSetter: #itemQuantityText:. 
	itemQuantityTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | itemQuantityTextBoxMorph innerTextMorph acceptContents].
	itemQuantityTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300.
	
	addToCartButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #sendAddToCartRequest  label: 'Add To Cart'.
	
	secondColumnLayoutMorph := LayoutMorph newColumn.
	secondColumnLayoutMorph separation: 5; 
	axisEdgeWeight: 0.5;
	addMorph: itemQuantityTextBoxMorph;
	addMorph: addToCartButtonMorph.
	
	^ secondColumnLayoutMorph
! !
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 21:03:52' prior: 50980847!
buildCatalog
	
	| catalogRow |

	catalogRow := LayoutMorph newRow.
	catalogRow separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: self buildCatalogColumn ;
	addMorph: self buildItemQuantityAndAddToCartButtonColumn.
	
	^ catalogRow
	! !

!methodRemoval: TusLibrosWindow #buildItemQuantityAndAddToCartButton stamp: 'JD 11/22/2021 21:03:52'!
buildItemQuantityAndAddToCartButton
	
	| addToCartButtonMorph itemQuantityTextBoxMorph secondColumnLayoutMorph |
	
	itemQuantityTextBoxMorph := TextModelMorph textProvider: self model textGetter: #itemQuantityText textSetter: #itemQuantityText:. 
	itemQuantityTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | itemQuantityTextBoxMorph innerTextMorph acceptContents].
	itemQuantityTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300.
	
	addToCartButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #sendAddToCartRequest  label: 'Add To Cart'.
	
	secondColumnLayoutMorph := LayoutMorph newColumn.
	secondColumnLayoutMorph separation: 5; 
	axisEdgeWeight: 0.5;
	addMorph: itemQuantityTextBoxMorph;
	addMorph: addToCartButtonMorph.
	
	^ secondColumnLayoutMorph
!
!TusLibrosWindow methodsFor: 'windows build' stamp: 'JD 11/22/2021 21:04:09'!
buildCatalogAndAddToCartColumn
	
	| catalogRow |

	catalogRow := LayoutMorph newRow.
	catalogRow separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: self buildCatalogColumn ;
	addMorph: self buildItemQuantityAndAddToCartButtonColumn.
	
	^ catalogRow
	! !
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 21:04:09' prior: 50979811!
buildMorphicCatalogWindow
		
	self layoutMorph beRow;
	separation: 150;
	axisEdgeWeight: 0;
	addMorph: self buildCatalogAndAddToCartColumn;
	addMorph: self buildCart;	
	addMorph: self buildButtons.! !

!methodRemoval: TusLibrosWindow #buildCatalog stamp: 'JD 11/22/2021 21:04:09'!
buildCatalog
	
	| catalogRow |

	catalogRow := LayoutMorph newRow.
	catalogRow separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: self buildCatalogColumn ;
	addMorph: self buildItemQuantityAndAddToCartButtonColumn.
	
	^ catalogRow
	!
!TusLibrosWindow methodsFor: 'windows build' stamp: 'JD 11/22/2021 21:04:13' prior: 50980926!
buildCatalogAndAddToCartColumn
	
	| catalogRow |

	catalogRow := LayoutMorph newRow.
	catalogRow separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: self buildCatalogColumn;
	addMorph: self buildItemQuantityAndAddToCartButtonColumn.
	
	^ catalogRow
	! !
!TusLibrosWindow methodsFor: 'windows build' stamp: 'JD 11/22/2021 21:04:33'!
buildCatalogAndAddToCartRow
	
	| catalogRow |

	catalogRow := LayoutMorph newRow.
	catalogRow separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: self buildCatalogColumn;
	addMorph: self buildItemQuantityAndAddToCartButtonColumn.
	
	^ catalogRow
	! !
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 21:04:33' prior: 50980937!
buildMorphicCatalogWindow
		
	self layoutMorph beRow;
	separation: 150;
	axisEdgeWeight: 0;
	addMorph: self buildCatalogAndAddToCartRow;
	addMorph: self buildCart;	
	addMorph: self buildButtons.! !

!methodRemoval: TusLibrosWindow #buildCatalogAndAddToCartColumn stamp: 'JD 11/22/2021 21:04:33'!
buildCatalogAndAddToCartColumn
	
	| catalogRow |

	catalogRow := LayoutMorph newRow.
	catalogRow separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: self buildCatalogColumn;
	addMorph: self buildItemQuantityAndAddToCartButtonColumn.
	
	^ catalogRow
	!
!TusLibrosWindow methodsFor: 'windows build' stamp: 'JD 11/22/2021 21:04:43' prior: 50980967!
buildCatalogAndAddToCartRow
	
	| row |

	row := LayoutMorph newRow.
	row separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: self buildCatalogColumn;
	addMorph: self buildItemQuantityAndAddToCartButtonColumn.
	
	^ row
	! !
!TusLibrosWindow methodsFor: 'windows build' stamp: 'JD 11/22/2021 21:05:24' prior: 50980857!
buildItemQuantityAndAddToCartButtonColumn
	
	| addToCartButtonMorph itemQuantityTextBoxMorph column |
	
	itemQuantityTextBoxMorph := TextModelMorph textProvider: self model textGetter: #itemQuantityText textSetter: #itemQuantityText:. 
	itemQuantityTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | itemQuantityTextBoxMorph innerTextMorph acceptContents].
	itemQuantityTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300.
	
	addToCartButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #sendAddToCartRequest  label: 'Add To Cart'.
	
	column := LayoutMorph newColumn.
	column separation: 5; 
	axisEdgeWeight: 0.5;
	addMorph: itemQuantityTextBoxMorph;
	addMorph: addToCartButtonMorph.
	
	^ column
! !
!TusLibrosWindow methodsFor: 'windows build' stamp: 'JD 11/22/2021 21:05:40' prior: 50980747!
buildCatalogColumn

	| catalogListMorph column |

	catalogListMorph := PluggableListMorph model: self model listGetter: #catalog indexGetter: #catalogListIndex indexSetter: #catalogListIndex:.
	catalogListMorph borderColor: Color skyBlue; borderWidth: 1; morphWidth:300.
	
	column := LayoutMorph newColumn.
	column separation: 5; 
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents: 'Catalog');
	addMorph: catalogListMorph.
	
	^ column! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

	StringsServicesRestInterface allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: 'validUser' put: 'validUserPassword'.
	catalog := Dictionary new.
	catalog at: 'book' put: 10.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.
	!
!TusLibrosCatalogWindowModel class methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 21:11:04' prior: 50979805!
newFor: aCartId
	
	^ self new initializeFor: aCartId! !

!classDefinition: #TusLibrosCatalogWindowModel category: 'TusLibros-View' stamp: 'JD 11/22/2021 21:11:22'!
Object subclass: #TusLibrosCatalogWindowModel
	instanceVariableNames: 'cartId'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!

!classDefinition: #TusLibrosCatalogWindowModel category: 'TusLibros-View' stamp: 'JD 11/22/2021 21:11:22'!
Object subclass: #TusLibrosCatalogWindowModel
	instanceVariableNames: 'cartId restInterface'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!
!TusLibrosCatalogWindowModel methodsFor: 'no messages' stamp: 'JD 11/22/2021 21:11:21'!
initializeFor: aCartId
	
	cartId := aCartId.
	restInterface := TusLibrosRestInterface new
! !

TusLibrosCatalogWindowModel class
	instanceVariableNames: ''!

!classDefinition: 'TusLibrosCatalogWindowModel class' category: 'TusLibros-View' stamp: 'JD 11/22/2021 21:11:28'!
TusLibrosCatalogWindowModel class
	instanceVariableNames: ''!
!TusLibrosWindow methodsFor: 'catalog - layouts' stamp: 'JD 11/22/2021 21:16:49' prior: 50981035!
buildCatalogColumn

	| catalogListMorph column |

	catalogListMorph := PluggableListMorph model: self model listGetter: #listCatalog indexGetter: #catalogListIndex indexSetter: #catalogListIndex:.
	catalogListMorph borderColor: Color skyBlue; borderWidth: 1; morphWidth:300.
	
	column := LayoutMorph newColumn.
	column separation: 5; 
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents: 'Catalog');
	addMorph: catalogListMorph.
	
	^ column! !
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 21:20:43'!
catalog

	restInterface sendListCartRequest: cartId! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 21:24:53'!
sendListCartRequest: aCartId
	
	| response urlFields |
	
	urlFields := Dictionary newFromPairs: {'cartId'. aCartId.}.
	
	response := WebClient htmlSubmit: self listCartUrl fields: urlFields.
	
	response isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((response content) readStream)) asOrderedCollection]
		ifFalse:[^self error: response content].! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 21:25:08'!
listCartUrl

	^ self rootUrl, '/list-cart'! !

	TusLibrosWindow open.!
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 21:25:55'!
sendListCatalogRequest: aCartId
	
	| response urlFields |
	
	urlFields := Dictionary newFromPairs: {'cartId'. aCartId.}.
	
	response := WebClient htmlSubmit: self listCartUrl fields: urlFields.
	
	response isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((response content) readStream)) asOrderedCollection]
		ifFalse:[^self error: response content].! !
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 21:25:55' prior: 50981126!
catalog

	restInterface sendListCatalogRequest: cartId! !

!methodRemoval: TusLibrosRestInterface #sendListCartRequest: stamp: 'JD 11/22/2021 21:25:55'!
sendListCartRequest: aCartId
	
	| response urlFields |
	
	urlFields := Dictionary newFromPairs: {'cartId'. aCartId.}.
	
	response := WebClient htmlSubmit: self listCartUrl fields: urlFields.
	
	response isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((response content) readStream)) asOrderedCollection]
		ifFalse:[^self error: response content].!
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 21:26:29'!
sendListCatalogRequest
	
	| response urlFields |
	
	urlFields := Dictionary new.
	
	response := WebClient htmlSubmit: self listCatalogUrl fields: urlFields.
	
	response isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((response content) readStream)) asOrderedCollection]
		ifFalse:[^self error: response content].! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 21:26:40'!
listCatalogUrl

	^ self rootUrl, '/list-catalog'! !

	TusLibrosWindow open.!

!methodRemoval: TusLibrosRestInterface #sendListCatalogRequest: stamp: 'JD 11/22/2021 21:27:29'!
sendListCatalogRequest: aCartId
	
	| response urlFields |
	
	urlFields := Dictionary newFromPairs: {'cartId'. aCartId.}.
	
	response := WebClient htmlSubmit: self listCartUrl fields: urlFields.
	
	response isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((response content) readStream)) asOrderedCollection]
		ifFalse:[^self error: response content].!
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 21:27:49'!
listCatalog
	
	^ self sendListCatalogRequest! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

	StringsServicesRestInterface allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: 'user' put: 'pass'.
	catalog := Dictionary new.
	catalog at: 'book' put: 10.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!

!methodRemoval: TusLibrosRestInterface #listCatalog stamp: 'JD 11/22/2021 21:28:30'!
listCatalog
	
	^ self sendListCatalogRequest!
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 21:28:58'!
listCatalog

	^ restInterface sendListCatalogRequest! !

	TusLibrosWindow open.!
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 21:30:16' prior: 50981247!
listCatalog

	restInterface sendListCatalogRequest! !

!methodRemoval: TusLibrosCatalogWindowModel #catalog stamp: 'JD 11/22/2021 21:30:20'!
catalog

	restInterface sendListCatalogRequest: cartId!

!classDefinition: #TusLibrosCatalogWindowModel category: 'TusLibros-View' stamp: 'JD 11/22/2021 21:30:36'!
Object subclass: #TusLibrosCatalogWindowModel
	instanceVariableNames: 'cartId restInterface catalogListIndex'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 21:30:36'!
catalogListIndex
	
	^ catalogListIndex! !
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 21:30:47'!
catalogListIndex: anIndex
	
	catalogListIndex := anIndex! !

	TusLibrosWindow open.!

	TusLibrosWindow open.!
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 21:41:08' prior: 50981185!
sendListCatalogRequest
	
	| response urlFields |
	
	urlFields := Dictionary new.
	
	response := WebClient htmlSubmit: self listCatalogUrl fields: urlFields.
	
	response isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((response content) readStream))]
		ifFalse:[^self error: response content].! !

	TusLibrosWindow open.!
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 21:46:13' prior: 50981285!
sendListCatalogRequest
	
	| response |
	
	response := WebClient httpGet: self listCatalogUrl.
	
	response isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((response content) readStream))]
		ifFalse:[^self error: response content].! !

	TusLibrosWindow open.!

	TusLibrosWindow open.!

	TusLibrosWindow open.!
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 21:47:30' prior: 50981299!
sendListCatalogRequest
	
	| response |
	
	response := WebClient httpGet: self listCatalogUrl.
	
	response isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((response content) readStream)) asArray]
		ifFalse:[^self error: response content].! !

	TusLibrosWindow open.!
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 21:48:02' prior: 50981312!
sendListCatalogRequest
	
	| response |
	
	response := WebClient httpGet: self listCatalogUrl.
	
	response isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((response content) readStream))]
		ifFalse:[^self error: response content].! !
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 21:48:18' prior: 50981254!
listCatalog

	^ restInterface sendListCatalogRequest! !

	TusLibrosWindow open.!
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 21:49:01' prior: 50981324!
sendListCatalogRequest
	
	| response |
	
	response := WebClient httpGet: self listCatalogUrl.
	
	response isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((response content) readStream)) asOrderedCollection]
		ifFalse:[^self error: response content].! !

	TusLibrosWindow open.!
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 21:49:47' prior: 50981341!
sendListCatalogRequest
	
	| response |
	
	response := WebClient httpGet: self listCatalogUrl.
	self halt.
	response isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((response content) readStream)) asOrderedCollection]
		ifFalse:[^self error: response content].! !

WebUtils jsonDecode: ((response content) readStream)!

(WebUtils jsonDecode: ((response content) readStream)) asOrderedCollection!
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 21:56:58' prior: 50981353!
sendListCatalogRequest
	
	| response |
	
	response := WebClient httpGet: self listCatalogUrl.
	self halt.
	response isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((response content) readStream))]
		ifFalse:[^self error: response content].! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 21:57:09' prior: 50981369!
sendListCatalogRequest
	
	| response |
	
	response := WebClient httpGet: self listCatalogUrl.
	response isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((response content) readStream))]
		ifFalse:[^self error: response content].! !

----SNAPSHOT----(22 November 2021 21:57:22) CuisUniversity-4972.image priorSource: 20770261!
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 22:37:09' prior: 50981380!
sendListCatalogRequest
	
	| response |
	
	response := WebClient httpGet: self listCatalogUrl.
	response isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((response content) readStream)) keys]
		ifFalse:[^self error: response content].! !

	TusLibrosWindow open.!
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 22:37:50' prior: 50981394!
sendListCatalogRequest
	
	| response |
	
	response := WebClient httpGet: self listCatalogUrl.
	response isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((response content) readStream)) keys asOrderedCollection]
		ifFalse:[^self error: response content].! !

	TusLibrosWindow open.!
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 22:38:14' prior: 50981406!
sendListCatalogRequest
	
	| response |
	
	response := WebClient httpGet: self listCatalogUrl.
	response isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((response content) readStream)) keys]
		ifFalse:[^self error: response content].! !
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 22:38:34' prior: 50981095!
initializeFor: aCartId
	
	cartId := aCartId.
	catalogListIndex := 0.
	restInterface := TusLibrosRestInterface new
! !

	TusLibrosWindow open.!
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 22:38:39' prior: 50981430!
initializeFor: aCartId
	
	cartId := aCartId.
	catalogListIndex := 1.
	restInterface := TusLibrosRestInterface new
! !

	TusLibrosWindow open.!

!classDefinition: #TusLibrosCatalogWindowModel category: 'TusLibros-View' stamp: 'JD 11/22/2021 22:39:28'!
Object subclass: #TusLibrosCatalogWindowModel
	instanceVariableNames: 'cartId restInterface catalogListIndex itemQuantity'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 22:39:27' prior: 50981438!
initializeFor: aCartId
	
	cartId := aCartId.
	catalogListIndex := 1.
	itemQuantity := 0.
	restInterface := TusLibrosRestInterface new
! !
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 22:39:53'!
itemQuantityText
	
	^ itemQuantity! !
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 22:40:07'!
itemQuantityText: aQuantity
	
	itemQuantity := aQuantity! !

	TusLibrosWindow open.!
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 22:41:21' prior: 50981469!
itemQuantityText: aQuantity
	
	itemQuantity := aQuantity.
	^ true! !

	TusLibrosWindow open.!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'book' put: 10.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 22:42:07' prior: 50981456!
initializeFor: aCartId
	
	cartId := aCartId.
	catalogListIndex := 1.
	itemQuantity := ''.
	restInterface := TusLibrosRestInterface new
! !

	TusLibrosWindow open.!
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 22:51:16' prior: 50979733!
redirectToCatalogWindowWith: aCartId

	self model: (TusLibrosCatalogWindowModel newFor: aCartId).
	self removeAllMorphs.
	self buildMorphicCatalogWindow.! !

	TusLibrosWindow open.!
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 22:51:46' prior: 50981509!
redirectToCatalogWindowWith: aCartId

	self model: (TusLibrosCatalogWindowModel newFor: aCartId).
	self buildMorphicCatalogWindow.! !
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 22:53:02' prior: 50981518!
redirectToCatalogWindowWith: aCartId

	self model: (TusLibrosCatalogWindowModel newFor: aCartId).
	self replaceArea: self layoutMorph with: self buildMorphicCatalogWindow.! !

	TusLibrosWindow open.!
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 22:54:14' prior: 50981526!
redirectToCatalogWindowWith: aCartId

	self model: (TusLibrosCatalogWindowModel newFor: aCartId).
	self replaceSubmorph: self layoutMorph by: self buildMorphicCatalogWindow.! !

	TusLibrosWindow open.!
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 22:56:23' prior: 50981536!
redirectToCatalogWindowWith: aCartId

	self model: (TusLibrosCatalogWindowModel newFor: aCartId).
	self setLabel: 'Catalog'.
	self replaceSubmorph: self layoutMorph by: self buildMorphicCatalogWindow.! !

	TusLibrosWindow open.!
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 23:02:35' prior: 50981546!
redirectToCatalogWindowWith: aCartId

	self model: (TusLibrosCatalogWindowModel newFor: aCartId).
	self setLabel: 'Catalog'.
	self buildMorphicCatalogWindow.! !
!TusLibrosWindow methodsFor: 'windows build' stamp: 'JD 11/22/2021 23:03:20' prior: 50980978!
buildMorphicCatalogWindow
		
	^ LayoutMorph newRow;
	separation: 150;
	axisEdgeWeight: 0;
	addMorph: self buildCatalogAndAddToCartRow;
	addMorph: self buildCart;	
	addMorph: self buildButtons.! !

	TusLibrosWindow open.!
!TusLibrosWindow methodsFor: 'windows build' stamp: 'JD 11/22/2021 23:03:52' prior: 50981565!
buildMorphicCatalogWindow
		
	| morphicCatalogWindow |
	morphicCatalogWindow := LayoutMorph newRow.
	morphicCatalogWindow separation: 150;
	axisEdgeWeight: 0;
	addMorph: self buildCatalogAndAddToCartRow;
	addMorph: self buildCart;	
	addMorph: self buildButtons.! !

	TusLibrosWindow open.!
!TusLibrosWindow methodsFor: 'windows build' stamp: 'JD 11/22/2021 23:04:25' prior: 50981575!
buildMorphicCatalogWindow
		
	| morphicCatalogWindow |
	morphicCatalogWindow := LayoutMorph newRow.
	morphicCatalogWindow separation: 150;
	axisEdgeWeight: 0;
	addMorph: self buildCatalogAndAddToCartRow;
	addMorph: self buildCart;	
	addMorph: self buildButtons.
	^ morphicCatalogWindow! !
!TusLibrosWindow methodsFor: 'windows build' stamp: 'JD 11/22/2021 23:04:26' prior: 50981587!
buildMorphicCatalogWindow
		
	| morphicCatalogWindow |
	morphicCatalogWindow := LayoutMorph newRow.
	morphicCatalogWindow separation: 150;
	axisEdgeWeight: 0;
	addMorph: self buildCatalogAndAddToCartRow;
	addMorph: self buildCart;	
	addMorph: self buildButtons.
	
	^ morphicCatalogWindow! !
!TusLibrosWindow methodsFor: 'windows build' stamp: 'JD 11/22/2021 23:04:28' prior: 50981599!
buildMorphicCatalogWindow
		
	| morphicCatalogWindow |

	morphicCatalogWindow := LayoutMorph newRow.
	morphicCatalogWindow separation: 150;
	axisEdgeWeight: 0;
	addMorph: self buildCatalogAndAddToCartRow;
	addMorph: self buildCart;	
	addMorph: self buildButtons.
	
	^ morphicCatalogWindow! !
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 23:04:44' prior: 50981557!
redirectToCatalogWindowWith: aCartId

	self model: (TusLibrosCatalogWindowModel newFor: aCartId).
	self setLabel: 'Catalog'.
	self buildMorphicCatalogWindow openInHand.! !

	TusLibrosWindow open.!
!TusLibrosWindow methodsFor: 'windows build' stamp: 'JD 11/22/2021 23:05:27' prior: 50981612!
buildMorphicCatalogWindow
		
	| morphicCatalogWindow |

	morphicCatalogWindow := LayoutMorph newRow.
	morphicCatalogWindow separation: 150;
	axisEdgeWeight: 0;
	addMorph: self buildCatalogAndAddToCartRow.
	"addMorph: self buildCart;	
	addMorph: self buildButtons."
	
	^ morphicCatalogWindow! !

	TusLibrosWindow open.!
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 23:06:20' prior: 50981625!
redirectToCatalogWindowWith: aCartId

	self model: (TusLibrosCatalogWindowModel newFor: aCartId).
	self setLabel: 'Catalog'.
	self buildMorphicCatalogWindow openInWorld: self world.! !

	TusLibrosWindow open.!
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 23:09:07' prior: 50981649!
redirectToCatalogWindowWith: aCartId

	self model: (TusLibrosCatalogWindowModel newFor: aCartId).
	self setLabel: 'Catalog'.
	self layoutMorph dismissMorph.
	self layoutMorph addMorph: self buildMorphicCatalogWindow.! !

	TusLibrosWindow open.!
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 23:09:28' prior: 50981659!
redirectToCatalogWindowWith: aCartId

	self model: (TusLibrosCatalogWindowModel newFor: aCartId).
	self setLabel: 'Catalog'.
	self layoutMorph submorphs dismissMorph.
	self layoutMorph addMorph: self buildMorphicCatalogWindow.! !

	TusLibrosWindow open.!
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 23:09:52' prior: 50981670!
redirectToCatalogWindowWith: aCartId

	self model: (TusLibrosCatalogWindowModel newFor: aCartId).
	self setLabel: 'Catalog'.
	self layoutMorph submorphs first dismissMorph.
	self layoutMorph addMorph: self buildMorphicCatalogWindow.! !

	TusLibrosWindow open.!
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/22/2021 23:11:41' prior: 50981682!
redirectToCatalogWindowWith: aCartId

	self model: (TusLibrosCatalogWindowModel newFor: aCartId).
	self setLabel: 'Catalog'.
	self layoutMorph submorphs first dismissMorph.
	self buildMorphicCatalogWindow.! !
!TusLibrosWindow methodsFor: 'windows build' stamp: 'JD 11/22/2021 21:04:33' prior: 50981635!
buildMorphicCatalogWindow
		
	self layoutMorph beRow;
	separation: 150;
	axisEdgeWeight: 0;
	addMorph: self buildCatalogAndAddToCartRow;
	addMorph: self buildCart;	
	addMorph: self buildButtons.! !
!TusLibrosWindow methodsFor: 'windows build' stamp: 'JD 11/22/2021 23:13:34' prior: 50981704!
buildMorphicCatalogWindow
		
	self layoutMorph beRow;
	separation: 150;
	axisEdgeWeight: 0;
	addMorph: self buildCatalogAndAddToCartRow.
	"addMorph: self buildCart;	
	addMorph: self buildButtons."! !

	TusLibrosWindow open.!

----STARTUP---- (22 November 2021 23:15:04) as /home/juli/Documentos/Facu/Inge1/cuis-university/CuisUniversity-4972.image!


	TusLibrosWindow open.!

----End fileIn of /home/juli/Documentos/Facu/Inge1/cuis-university/TusLibros-View.st----!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

	StringsServicesRestInterface allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'book' put: 10.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.
	!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

	StringsServicesRestInterface allInstances do: [:anInstance | anInstance destroy].!

----SNAPSHOT----(22 November 2021 23:16:26) CuisUniversity-4972.image priorSource: 20791651!

----STARTUP---- (26 November 2021 17:07:48) as /home/juli/Documentos/Facu/Inge1/cuis-university/CuisUniversity-4972.image!


"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'book' put: 10.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 17:08:51' prior: 50981431!
redirectToCatalogWindowWith: aCartId

	self model: (TusLibrosCatalogWindowModel newFor: aCartId).
	self setLabel: 'Catalog'.
	self layoutMorph submorphs do: [:aSubmorph | aSubmorph dismissMorph].
	self buildMorphicCatalogWindow.! !

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'book' put: 10.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!
!TusLibrosWindow methodsFor: 'catalog - layouts' stamp: 'JD 11/26/2021 17:11:09' prior: 50981559!
buildItemQuantityAndAddToCartButtonColumn
	
	| addToCartButtonMorph itemQuantityTextBoxMorph column |
	
	itemQuantityTextBoxMorph := TextModelMorph textProvider: self model textGetter: #itemQuantityText textSetter: #itemQuantityText:. 
	itemQuantityTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | itemQuantityTextBoxMorph innerTextMorph acceptContents].
	itemQuantityTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 50.
	
	addToCartButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #sendAddToCartRequest  label: 'Add To Cart'.
	
	column := LayoutMorph newColumn.
	column separation: 5; 
	axisEdgeWeight: 0.5;
	addMorph: itemQuantityTextBoxMorph;
	addMorph: addToCartButtonMorph.
	
	^ column
! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'book' put: 10.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!
!TusLibrosWindow methodsFor: 'catalog - layouts' stamp: 'JD 11/26/2021 17:12:52' prior: 50981860!
buildItemQuantityAndAddToCartButtonColumn
	
	| addToCartButtonMorph itemQuantityTextBoxMorph column |
	
	itemQuantityTextBoxMorph := TextModelMorph textProvider: self model textGetter: #itemQuantityText textSetter: #itemQuantityText:. 
	itemQuantityTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | itemQuantityTextBoxMorph innerTextMorph acceptContents].
	itemQuantityTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 50; morphHeight: 50.
	
	addToCartButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #sendAddToCartRequest  label: 'Add To Cart'.
	
	column := LayoutMorph newColumn.
	column separation: 5; 
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'Quantity');
	addMorph: itemQuantityTextBoxMorph;
	addMorph: addToCartButtonMorph.
	
	^ column
! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'book' put: 10.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!
!TusLibrosWindow methodsFor: 'catalog - layouts' stamp: 'JD 11/26/2021 17:13:16' prior: 50981904!
buildItemQuantityAndAddToCartButtonColumn
	
	| addToCartButtonMorph itemQuantityTextBoxMorph column |
	
	itemQuantityTextBoxMorph := TextModelMorph textProvider: self model textGetter: #itemQuantityText textSetter: #itemQuantityText:. 
	itemQuantityTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | itemQuantityTextBoxMorph innerTextMorph acceptContents].
	itemQuantityTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 25; morphHeight: 25.
	
	addToCartButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #sendAddToCartRequest  label: 'Add To Cart'.
	
	column := LayoutMorph newColumn.
	column separation: 5; 
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'Quantity');
	addMorph: itemQuantityTextBoxMorph;
	addMorph: addToCartButtonMorph.
	
	^ column
! !
!TusLibrosWindow methodsFor: 'catalog - layouts' stamp: 'JD 11/26/2021 17:13:19' prior: 50981950!
buildItemQuantityAndAddToCartButtonColumn
	
	| addToCartButtonMorph itemQuantityTextBoxMorph column |
	
	itemQuantityTextBoxMorph := TextModelMorph textProvider: self model textGetter: #itemQuantityText textSetter: #itemQuantityText:. 
	itemQuantityTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | itemQuantityTextBoxMorph innerTextMorph acceptContents].
	itemQuantityTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 25; morphHeight: 25.
	
	addToCartButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #sendAddToCartRequest  label: 'Add To Cart'.
	
	column := LayoutMorph newColumn.
	column separation: 5; 
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'Quantity');
	addMorph: itemQuantityTextBoxMorph;
	addMorph: addToCartButtonMorph.
	
	^ column
! !

	TusLibrosWindow open.!
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 17:28:49' prior: 50981410!
initializeWithTitle: aTitle
	
	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: aTitle.
	self model: (TusLibrosLogInWindowModel new).
	self morphExtent: 1035@485.
	self buildMorphicWindow.
	self openInWorld.
			
	self model when: #newCartCreated send: #redirectToCatalogWindowWith: to: self.
	self model when: #itemsAddedToCart send: #refreshCart to: self.
	self model when: #purchasesRequested send: #redirectToPurchases to: self.
	self model when: #cartCheckouted send: #redirectToSuccessfullyCheckout to: self! !
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 17:29:53'!
sendAddToCartRequest

	| catalog |
	catalog := self listCatalog.
	restInterface sendAddToCartRequest: self itemQuantityText of: (catalog at: self catalogListIndex) to: cartId.
	
	self triggerEvent: #itemsAddedToCart
	! !
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 17:29:59' prior: 50982029!
sendAddToCartRequest

	| catalog |

	catalog := self listCatalog.
	restInterface sendAddToCartRequest: self itemQuantityText of: (catalog at: self catalogListIndex) to: cartId.
	
	self triggerEvent: #itemsAddedToCart
	! !
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 17:30:16' prior: 50982040!
sendAddToCartRequest

	| catalog |

	catalog := self listCatalog.
	restInterface sendAddToCartRequest: itemQuantity of: (catalog at: self catalogListIndex) to: cartId.
	
	self triggerEvent: #itemsAddedToCart
	! !
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 17:30:26' prior: 50982051!
sendAddToCartRequest

	| catalog |

	catalog := self listCatalog.
	restInterface sendAddToCartRequest: itemQuantity of: (catalog at: catalogListIndex) to: cartId.
	
	self triggerEvent: #itemsAddedToCart
	! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 17:35:12'!
sendAddToCartRequest: aQuantity of: aBook to: aCartId
	| response urlFields |
	
	urlFields := Dictionary newFromPairs: {'bookAmount'. aQuantity. 'book'. aBook. 'cartId'. aCartId}.
	
	response := WebClient htmlSubmit: self addToCartUrl fields: urlFields.
	
	response isSuccess 
		ifTrue:[^WebUtils jsonDecode: ((response content) readStream)]
		ifFalse:[^self error: response content].! !
!TusLibrosRestInterface methodsFor: 'urls' stamp: 'JD 11/26/2021 17:35:30'!
AddToCartUrl

	^ self rootUrl, '/add-to-cart'! !
!TusLibrosRestInterface methodsFor: 'urls' stamp: 'JD 11/26/2021 17:35:35'!
addToCartUrl

	^ self rootUrl, '/add-to-cart'! !

!methodRemoval: TusLibrosRestInterface #AddToCartUrl stamp: 'JD 11/26/2021 17:35:35'!
AddToCartUrl

	^ self rootUrl, '/add-to-cart'!
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 17:35:52' prior: 50982072!
sendAddToCartRequest: aQuantity of: aBook to: aCartId

	| response urlFields |
	
	urlFields := Dictionary newFromPairs: {'bookAmount'. aQuantity. 'book'. aBook. 'cartId'. aCartId}.
	
	response := WebClient htmlSubmit: self addToCartUrl fields: urlFields.
	
	response isSuccess 
		ifTrue:[^WebUtils jsonDecode: ((response content) readStream)]
		ifFalse:[^self error: response content].! !
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 17:38:58' prior: 50982062!
sendAddToCartRequest

	| catalog |

	catalog := self listCatalog.
	restInterface sendAddToCartRequest: itemQuantity of: (catalog at: catalogListIndex) to: cartId.
	
	self triggerEvent: #itemsAddedToCart with: cartId
	! !
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 17:39:19'!
refreshCart: aCartId

	self redirectToCatalogWindowWith: aCartId! !

	TusLibrosWindow open.!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!
!TusLibrosWindow methodsFor: 'catalog - layouts' stamp: 'JD 11/26/2021 17:41:07'!
buildCartRow
	
	| row |

	row := LayoutMorph newRow.
	row separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: self buildCart.
	
	^ row
	! !
!TusLibrosWindow methodsFor: 'catalog - layouts' stamp: 'JD 11/26/2021 17:45:59'!
buildCart

	| cartListMorph column |

	cartListMorph := PluggableListMorph model: self model listGetter: #listCart indexGetter: nil indexSetter: nil.
	cartListMorph borderColor: Color skyBlue; borderWidth: 1; morphWidth:300.
	
	column := LayoutMorph newColumn.
	column separation: 5; 
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents: 'Cart');
	addMorph: cartListMorph.

	^ column! !
!TusLibrosWindow methodsFor: 'windows build' stamp: 'JD 11/26/2021 17:46:31' prior: 50981515!
buildMorphicCatalogWindow
		
	self layoutMorph beRow;
	separation: 150;
	axisEdgeWeight: 0;
	addMorph: self buildCatalogAndAddToCartRow;
	addMorph: self buildCart.
	"addMorph: self buildButtons."! !
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 17:46:49'!
listCart

	^ restInterface sendListCartRequest! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 17:47:14'!
sendListCartRequest
	
	| response |
	
	response := WebClient httpGet: self listCartUrl.
	response isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((response content) readStream)) keys]
		ifFalse:[^self error: response content].! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'book' put: 10.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!
!TusLibrosWindow methodsFor: 'windows build' stamp: 'JD 11/26/2021 17:49:00' prior: 50982158!
buildMorphicCatalogWindow
		
	self layoutMorph beRow;
	separation: 150;
	axisEdgeWeight: 0;
	addMorph: self buildCatalogAndAddToCartRow;
	addMorph: self buildCartRow.
	"addMorph: self buildButtons."! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 17:50:25'!
sendListCartRequest: aCartId
	
	| response urlFields |
	
	urlFields := Dictionary newFromPairs: {'cartId'. aCartId.}.
	response := WebClient htmlSubmit: self createCartUrl fields: urlFields.
	response isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((response content) readStream)) keys]
		ifFalse:[^self error: response content].! !
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 17:50:43' prior: 50982168!
listCart

	^ restInterface sendListCartRequest: cartId! !

!methodRemoval: TusLibrosRestInterface #sendListCartRequest stamp: 'JD 11/26/2021 17:50:49'!
sendListCartRequest
	
	| response |
	
	response := WebClient httpGet: self listCartUrl.
	response isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((response content) readStream)) keys]
		ifFalse:[^self error: response content].!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'book' put: 10.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.
	!
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 17:52:26' prior: 50982210!
sendListCartRequest: aCartId
	
	| response urlFields |
	
	urlFields := Dictionary newFromPairs: {'cartId'. aCartId.}.
	response := WebClient htmlSubmit: self listCartUrl fields: urlFields.
	response isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((response content) readStream)) keys]
		ifFalse:[^self error: response content].! !

	TusLibrosWindow open.!
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 17:52:57' prior: 50982256!
sendListCartRequest: aCartId
	
	| response urlFields |
	
	urlFields := Dictionary newFromPairs: {'cartId'. aCartId.}.
	response := WebClient htmlSubmit: self listCartUrl fields: urlFields.
	response isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((response content) readStream))]
		ifFalse:[^self error: response content].! !

----SNAPSHOT----(26 November 2021 17:53:24) CuisUniversity-4972.image priorSource: 20805112!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

	|server client|

	server := StringsServicesRestInterface listeningOn: 8080.
	client := WordsClientWindow open.
!

	StringsServicesRestInterface allInstances do: [:anInstance | anInstance destroy].!
!TusLibrosWindow methodsFor: 'catalog - layouts' stamp: 'JD 11/26/2021 18:14:13' prior: 50982142!
buildCart

	| cartListMorphh column |

	cartListMorphh := PluggableListMorph model: self model listGetter: #listCart indexGetter: nil indexSetter: nil.
	cartListMorphh borderColor: Color skyBlue; borderWidth: 1; morphWidth:300.
	
	column := LayoutMorph newColumn.
	column separation: 5; 
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents: 'Cart');
	addMorph: cartListMorphh.

	^ column! !

!classDefinition: #TusLibrosWindow category: 'TusLibros-View' stamp: 'JD 11/26/2021 18:14:24'!
Panel subclass: #TusLibrosWindow
	instanceVariableNames: 'cartListMorph'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!
!TusLibrosWindow methodsFor: 'catalog - layouts' stamp: 'JD 11/26/2021 18:14:23' prior: 50982296!
buildCart

	| column |

	cartListMorph := PluggableListMorph model: self model listGetter: #listCart indexGetter: nil indexSetter: nil.
	cartListMorph borderColor: Color skyBlue; borderWidth: 1; morphWidth:300.
	
	column := LayoutMorph newColumn.
	column separation: 5; 
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents: 'Cart');
	addMorph: cartListMorph.

	^ column! !
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 18:15:47'!
refreshCartList

	cartListMorph updateList! !

!methodRemoval: TusLibrosWindow #refreshCart: stamp: 'JD 11/26/2021 18:16:22'!
refreshCart: aCartId

	self redirectToCatalogWindowWith: aCartId!
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 18:16:55' prior: 50982117!
sendAddToCartRequest

	| catalog |

	catalog := self listCatalog.
	restInterface sendAddToCartRequest: itemQuantity of: (catalog at: catalogListIndex) to: cartId.
	
	self triggerEvent: #itemsAddedToCart
	! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

	StringsServicesRestInterface allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'book' put: 10.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 18:29:34' prior: 50982334!
refreshCartList

	cartListMorph updateList.
	cartListMorph setSelectionIndex: 0.
! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'book' put: 10.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 18:31:26' prior: 50982009!
initializeWithTitle: aTitle
	
	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: aTitle.
	self model: (TusLibrosLogInWindowModel new).
	self morphExtent: 1035@485.
	self buildMorphicWindow.
	self openInWorld.
			
	self model when: #newCartCreated send: #redirectToCatalogWindowWith: to: self.
	self model when: #itemsAddedToCart send: #refreshCartList to: self.
	self model when: #purchasesRequested send: #redirectToPurchases to: self.
	self model when: #cartCheckouted send: #redirectToSuccessfullyCheckout to: self! !

	TusLibrosWindow open.!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!
!TusLibrosWindow methodsFor: 'windows build' stamp: 'JD 11/26/2021 18:36:06' prior: 50982200!
buildMorphicCatalogWindow
		
	self layoutMorph beColumn;
	separation: 150;
	axisEdgeWeight: 0;
	addMorph: self buildCatalogAndAddToCartRow;
	addMorph: self buildCartRow.
	"addMorph: self buildButtons."! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!


	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'book' put: 10.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!
!TusLibrosWindow methodsFor: 'windows build' stamp: 'JD 11/26/2021 18:36:53' prior: 50982419!
buildMorphicCatalogWindow
		
	self layoutMorph beColumn;
	separation: 20;
	axisEdgeWeight: 0;
	addMorph: self buildCatalogAndAddToCartRow;
	addMorph: self buildCartRow.
	"addMorph: self buildButtons."! !

	TusLibrosWindow open.!
!TusLibrosWindow methodsFor: 'catalog - layouts' stamp: 'JD 11/26/2021 18:37:28' prior: 50982135!
buildCartRow
	
	| row |

	row := LayoutMorph newRow.
	row separation: 20;
	axisEdgeWeight: 0.5;
	addMorph: self buildCart.
	
	^ row
	! !
!TusLibrosWindow methodsFor: 'catalog - layouts' stamp: 'JD 11/26/2021 18:37:34' prior: 50981532!
buildCatalogAndAddToCartRow
	
	| row |

	row := LayoutMorph newRow.
	row separation: 20;
	axisEdgeWeight: 0.5;
	addMorph: self buildCatalogColumn;
	addMorph: self buildItemQuantityAndAddToCartButtonColumn.
	
	^ row
	! !

	TusLibrosWindow open.!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'book' put: 10.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!

	TusLibrosWindow open.!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 18:52:48' prior: 50982224!
listCart
	
	self halt.
	^ restInterface sendListCartRequest: cartId! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'book' put: 10.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 18:54:18' prior: 50982494!
listCart

	^ restInterface sendListCartRequest: cartId! !
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 18:54:30' prior: 50982344!
sendAddToCartRequest

	| catalog |

	catalog := self listCatalog.
	restInterface sendAddToCartRequest: itemQuantity of: (catalog at: catalogListIndex) to: cartId.
	self halt.
	self triggerEvent: #itemsAddedToCart
	! !

	TusLibrosWindow open.!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 18:55:05' prior: 50982523!
sendAddToCartRequest

	| catalog |

	catalog := self listCatalog.
	restInterface sendAddToCartRequest: itemQuantity of: (catalog at: catalogListIndex) to: cartId.

	self triggerEvent: #itemsAddedToCart
	! !
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 18:55:59' prior: 50982373!
refreshCartList
	
	self halt.
	cartListMorph updateList.
	cartListMorph setSelectionIndex: 0.
! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

	TusLibrosWindow open.!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'book' put: 10.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 19:00:02' prior: 50982537!
sendAddToCartRequest

	| catalog |

	catalog := self listCatalog.
	"restInterface sendAddToCartRequest: itemQuantity of: (catalog at: catalogListIndex) to: cartId."

	self triggerEvent: #itemsAddedToCart
	! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'book' put: 10.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 19:04:34' prior: 50982574!
sendAddToCartRequest

	| catalog |

	catalog := self listCatalog.
	restInterface sendAddToCartRequest: itemQuantity of: (catalog at: catalogListIndex) to: cartId.

	self triggerEvent: #itemsAddedToCart
	! !
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 19:04:56' prior: 50982603!
sendAddToCartRequest

	| catalog |

	catalog := self listCatalog.
	restInterface sendAddToCartRequest: itemQuantity of: (catalog at: catalogListIndex) to: cartId.
	self halt.
	self triggerEvent: #itemsAddedToCart
	! !

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'book' put: 10.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 19:05:26' prior: 50982613!
sendAddToCartRequest

	| catalog |

	catalog := self listCatalog.
	restInterface sendAddToCartRequest: itemQuantity of: (catalog at: catalogListIndex) to: cartId.
	self triggerEvent: #itemsAddedToCart
	! !
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 19:08:12' prior: 50982396!
initializeWithTitle: aTitle
	
	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: aTitle.
	self model: (TusLibrosLogInWindowModel new).
	self morphExtent: 1035@485.
	self buildMorphicWindow.
	self openInWorld.
			
	self model when: #newCartCreated send: #redirectToCatalogWindowWith: to: self.
	self model when: #purchasesRequested send: #redirectToPurchases to: self.
	self model when: #cartCheckouted send: #redirectToSuccessfullyCheckout to: self! !
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 19:08:26' prior: 50981835!
redirectToCatalogWindowWith: aCartId

	self model: (TusLibrosCatalogWindowModel newFor: aCartId).
	self setLabel: 'Catalog'.
	self layoutMorph submorphs do: [:aSubmorph | aSubmorph dismissMorph].
	self buildMorphicCatalogWindow.

	self model when: #itemsAddedToCart send: #refreshCartList to: self.! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'book' put: 10.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!

----SNAPSHOT----(26 November 2021 19:09:22) CuisUniversity-4972.image priorSource: 20820258!
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 19:16:09'!
addToCart

	| catalog |

	catalog := self listCatalog.
	restInterface sendAddToCartRequest: itemQuantity of: (catalog at: catalogListIndex) to: cartId.
	self triggerEvent: #itemsAddedToCart
	! !

!methodRemoval: TusLibrosCatalogWindowModel #sendAddToCartRequest stamp: 'JD 11/26/2021 19:16:09'!
sendAddToCartRequest

	| catalog |

	catalog := self listCatalog.
	restInterface sendAddToCartRequest: itemQuantity of: (catalog at: catalogListIndex) to: cartId.
	self triggerEvent: #itemsAddedToCart
	!
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 19:20:25' prior: 50981753!
sendListCatalogRequest
	
	| response |
	
	response := WebClient httpGet: self listCatalogUrl.
	response isSuccess 
		ifTrue:[^ WebUtils jsonDecode: ((response content) readStream)]
		ifFalse:[^self error: response content].! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 19:20:33' prior: 50982271!
sendListCartRequest: aCartId
	
	| response urlFields |
	
	urlFields := Dictionary newFromPairs: {'cartId'. aCartId.}.
	response := WebClient htmlSubmit: self listCartUrl fields: urlFields.
	response isSuccess 
		ifTrue:[^ WebUtils jsonDecode: ((response content) readStream)]
		ifFalse:[^self error: response content].! !
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 19:21:03' prior: 50981647!
listCatalog

	| catalog |
	catalog := restInterface sendListCatalogRequest.
	^ self presentCatalog: catalog! !
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 19:21:06' prior: 50982744!
listCatalog

	| catalog |

	catalog := restInterface sendListCatalogRequest.
	^ self presentCatalog: catalog! !
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 19:26:14'!
presentCatalog: aCatalog
	
	| presentedCatalog |
	presentedCatalog := OrderedCollection new.
	aCatalog keysDo: [:aBook |
		| bookPrice |
		bookPrice := aCatalog at: aBook.
		presentedCatalog add: (aBook, '-', bookPrice, '$')
	].
	^ presentedCatalog! !
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 19:26:17' prior: 50982758!
presentCatalog: aCatalog
	
	| presentedCatalog |

	presentedCatalog := OrderedCollection new.
	aCatalog keysDo: [:aBook |
		| bookPrice |
		bookPrice := aCatalog at: aBook.
		presentedCatalog add: (aBook, '-', bookPrice, '$')
	].
	^ presentedCatalog! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'book' put: 10.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 19:26:40' prior: 50982770!
presentCatalog: aCatalog
	
	| presentedCatalog |

	presentedCatalog := OrderedCollection new.
	aCatalog keysDo: [:aBook |
		| bookPrice |
		bookPrice := aCatalog at: aBook.
		presentedCatalog add: (aBook, '-', bookPrice asString, '$')
	].
	^ presentedCatalog! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'book' put: 10.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!
!TusLibrosWindow methodsFor: 'catalog - layouts' stamp: 'JD 11/26/2021 19:28:21' prior: 50981979!
buildItemQuantityAndAddToCartButtonColumn
	
	| addToCartButtonMorph itemQuantityTextBoxMorph column |
	
	itemQuantityTextBoxMorph := TextModelMorph textProvider: self model textGetter: #itemQuantityText textSetter: #itemQuantityText:. 
	itemQuantityTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | itemQuantityTextBoxMorph innerTextMorph acceptContents].
	itemQuantityTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 25; morphHeight: 25.
	
	addToCartButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #addToCart  label: 'Add To Cart'.
	
	column := LayoutMorph newColumn.
	column separation: 5; 
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'Quantity');
	addMorph: itemQuantityTextBoxMorph;
	addMorph: addToCartButtonMorph.
	
	^ column
! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'book' put: 10.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 19:30:04' prior: 50982700!
addToCart

	| catalog |

	catalog := restInterface sendListCatalogRequest.
	restInterface sendAddToCartRequest: itemQuantity of: (catalog at: catalogListIndex) to: cartId.
	self triggerEvent: #itemsAddedToCart
	! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'book' put: 10.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.
	!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'book' put: 10.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 19:31:43' prior: 50982872!
addToCart

	| books |

	books := restInterface sendListCatalogRequest keys.
	restInterface sendAddToCartRequest: itemQuantity of: (books at: catalogListIndex) to: cartId.
	self triggerEvent: #itemsAddedToCart
	! !
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 19:31:53' prior: 50982547!
refreshCartList

	cartListMorph updateList.
	cartListMorph setSelectionIndex: 0.
! !
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 19:33:14' prior: 50982517!
listCart

	| cart |
	cart := restInterface sendListCartRequest: cartId.
	^ self presentCart: cart! !
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 19:33:18' prior: 50982933!
listCart

	| cart |

	cart := restInterface sendListCartRequest: cartId.
	^ self presentCart: cart! !
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 19:43:43'!
presentCart: aCart
	
	| cartAsSet cartPrice catalog presentedCart |
	presentedCart := OrderedCollection new.
	cartPrice := 0.
	catalog := restInterface sendListCatalogRequest.
	cartAsSet := aCart asSet.
	cartAsSet do: [:aBook | 
		| bookOccurrences |
		
		bookOccurrences := aCart occurrencesOf: aBook.
		presentedCart add: (aBook, ' ', 'Quantity:', bookOccurrences asString).
		cartPrice := cartPrice + ((catalog at: aBook) * bookOccurrences)
	].
	
	presentedCart add: 'Cart Total: ', cartPrice asString.
	^ presentedCart! !
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 19:43:51' prior: 50982947!
presentCart: aCart
	
	| cartAsSet cartPrice catalog presentedCart |

	presentedCart := OrderedCollection new.
	cartPrice := 0.
	catalog := restInterface sendListCatalogRequest.
	cartAsSet := aCart asSet.
	cartAsSet do: [:aBook | 
		| bookOccurrences |
		
		bookOccurrences := aCart occurrencesOf: aBook.
		presentedCart add: (aBook, ' ', 'Quantity:', bookOccurrences asString).
		cartPrice := cartPrice + ((catalog at: aBook) * bookOccurrences)
	].
	
	presentedCart add: 'Cart Total: ', cartPrice asString.
	^ presentedCart! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'book' put: 10.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 19:45:41' prior: 50982967!
presentCart: aCart
	
	| cartAsSet cartPrice catalog presentedCart |

	presentedCart := OrderedCollection new.
	cartPrice := 0.
	catalog := restInterface sendListCatalogRequest.
	cartAsSet := aCart asSet.
	cartAsSet do: [:aBook | 
		| bookOccurrences |
		
		bookOccurrences := aCart occurrencesOf: aBook.
		presentedCart add: (aBook, '-', 'Quantity:', bookOccurrences asString).
		cartPrice := cartPrice + ((catalog at: aBook) * bookOccurrences)
	].
	presentedCart add: ''.
	presentedCart add: 'Cart Total: ', cartPrice asString.

	^ presentedCart! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'book' put: 10.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 19:48:16' prior: 50983004!
presentCart: aCart
	
	| cartAsSet cartPrice catalog presentedCart |

	presentedCart := OrderedCollection new.
	cartPrice := 0.
	catalog := restInterface sendListCatalogRequest.
	cartAsSet := aCart asSet.
	cartAsSet do: [:aBook | 
		| bookOccurrences |
		
		bookOccurrences := aCart occurrencesOf: aBook.
		presentedCart add: (bookOccurrences asString, ' of ', aBook).
		cartPrice := cartPrice + ((catalog at: aBook) * bookOccurrences)
	].
	presentedCart add: ''.
	presentedCart add: 'Cart Total: ', cartPrice asString, '$'.

	^ presentedCart! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'book' put: 10.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.
	!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

----SNAPSHOT----(26 November 2021 19:51:44) CuisUniversity-4972.image priorSource: 20833472!
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 19:57:31' prior: 50983042!
presentCart: aCart
	
	| cartAsSet cartPrice catalog presentedCart |

	presentedCart := OrderedCollection new.
	cartPrice := 0.
	catalog := restInterface sendListCatalogRequest.
	cartAsSet := aCart asSet sorted.
	cartAsSet do: [:aBook | 
		| bookOccurrences |
		
		bookOccurrences := aCart occurrencesOf: aBook.
		presentedCart add: (bookOccurrences asString, ' of ', aBook).
		cartPrice := cartPrice + ((catalog at: aBook) * bookOccurrences)
	].
	presentedCart add: ''.
	presentedCart add: 'Cart Total: ', cartPrice asString, '$'.

	^ presentedCart! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 19:59:16' prior: 50982798!
presentCatalog: aCatalog
	
	| presentedCatalog |

	presentedCatalog := OrderedCollection new.
	aCatalog keysDo: [:aBook |
		| bookPrice |
		bookPrice := aCatalog at: aBook.
		presentedCatalog add: (aBook, '-', bookPrice asString, '$')
	].
	^ presentedCatalog sorted! !

	TusLibrosWindow open.!
!WordsClientWindow methodsFor: 'access' stamp: 'JD 11/26/2021 20:04:33' prior: 50977570!
refreshListOfWords
	
	wordsListMorph updateList.
	! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!
!TusLibrosWindow methodsFor: 'catalog - layouts' stamp: 'JD 11/26/2021 20:06:26' prior: 50982319!
buildCart

	| column |

	cartListMorph := PluggableListMorph model: self model listGetter: #listCart indexGetter: nil indexSetter: nil.
	cartListMorph borderColor: Color skyBlue; borderWidth: 1; morphWidth:300.
	cartListMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | cartListMorph innerTextMorph acceptContents ] .
	
	column := LayoutMorph newColumn.
	column separation: 5; 
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents: 'Cart');
	addMorph: cartListMorph.

	^ column! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!
!TusLibrosWindow methodsFor: 'catalog - layouts' stamp: 'JD 11/26/2021 20:07:33' prior: 50983183!
buildCart

	| column |

	cartListMorph := PluggableListMorph model: self model listGetter: #listCart indexGetter: nil indexSetter: nil.
	cartListMorph borderColor: Color skyBlue; borderWidth: 1; morphWidth:300.
	cartListMorph setProperty: #keyStroke: toValue: [ :key | cartListMorph innerTextMorph acceptContents ] .
	
	column := LayoutMorph newColumn.
	column separation: 5; 
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents: 'Cart');
	addMorph: cartListMorph.

	^ column! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!
!TusLibrosWindow methodsFor: 'catalog - layouts' stamp: 'JD 11/26/2021 20:12:00' prior: 50983221!
buildCart

	| column |

	cartListMorph := PluggableListMorph model: self model listGetter: #listCart indexGetter: nil indexSetter: nil.
	cartListMorph borderColor: Color skyBlue; borderWidth: 1; morphWidth:300.
	
	column := LayoutMorph newColumn.
	column separation: 5; 
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents: 'Cart');
	addMorph: cartListMorph.

	^ column! !
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 20:12:10' prior: 50982926!
refreshCartList

	cartListMorph updateList.
	cartListMorph updateList.
	cartListMorph setSelectionIndex: 0.
! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 20:13:19' prior: 50983273!
refreshCartList

	cartListMorph updateList.
	cartListMorph setSelectionIndex: 0.
! !
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 20:14:58' prior: 50983299!
refreshCartList

	cartListMorph updateList.
	cartListMorph verifyContents.
	cartListMorph setSelectionIndex: 0.
! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 20:15:38' prior: 50983305!
refreshCartList

	cartListMorph updateList.
	cartListMorph setSelectionIndex: 0.
! !
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 20:19:21' prior: 50983333!
refreshCartList

	cartListMorph updateList.
	cartListMorph someSubmorphPositionOrExtentChanged.
	cartListMorph setSelectionIndex: 0.
! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 20:20:03' prior: 50983339!
refreshCartList

	cartListMorph updateList.
	cartListMorph someSubmorphPositionOrExtentChanged.
	cartListMorph updateList.
	cartListMorph setSelectionIndex: 0.
! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 20:21:36' prior: 50983368!
refreshCartList

	cartListMorph updateList.
	cartListMorph someSubmorphPositionOrExtentChanged.
	cartListMorph updateList.
	cartListMorph update: '$'.
	cartListMorph setSelectionIndex: 0.
! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 20:25:03' prior: 50983395!
refreshCartList

	cartListMorph updateList.
	cartListMorph someSubmorphPositionOrExtentChanged.
	cartListMorph getList.
	cartListMorph setSelectionIndex: 0.
! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 20:29:05' prior: 50983444!
refreshCartList

	cartListMorph updateList.
	cartListMorph someSubmorphPositionOrExtentChanged.
	cartListMorph submorphs do: [:aSubmorph | aSubmorph listChanged].
	cartListMorph setSelectionIndex: 0.
! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 20:35:14' prior: 50983471!
refreshCartList

	cartListMorph updateList.
	cartListMorph someSubmorphPositionOrExtentChanged.
	(cartListMorph submorphs collect: [:aSubmorph | aSubmorph class = #InnerListMorph]) do: [:anInnerListMorph | anInnerListMorph listChanged].
	cartListMorph setSelectionIndex: 0.
! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 20:37:00' prior: 50983499!
refreshCartList

	cartListMorph updateList.
	cartListMorph someSubmorphPositionOrExtentChanged.
	(cartListMorph submorphs select: [:aSubmorph | aSubmorph class = #InnerListMorph]) do: [:anInnerListMorph | anInnerListMorph listChanged].
	cartListMorph setSelectionIndex: 0.
! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 20:39:19' prior: 50983530!
refreshCartList

	cartListMorph updateList.
	cartListMorph someSubmorphPositionOrExtentChanged.
	cartListMorph submorphs do: [:aSubmorph | aSubmorph class = #InnerListMorph ifTrue: [aSubmorph listChanged]].
	cartListMorph setSelectionIndex: 0.
! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 20:39:42' prior: 50983563!
refreshCartList

	cartListMorph updateList! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 20:40:15' prior: 50983593!
refreshCartList

	cartListMorph updateList! !
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 20:41:30' prior: 50983617!
refreshCartList
	
	"El contenido de la lista se actualiza solo al llevar el mouse sobre ella o clickear, no pudimos solucionarlo"
	cartListMorph updateList! !

----SNAPSHOT----(26 November 2021 20:41:49) CuisUniversity-4972.image priorSource: 20846349!

----SNAPSHOT----(26 November 2021 21:02:34) CuisUniversity-4972.image priorSource: 20863326!
!TusLibrosWindow methodsFor: 'windows build' stamp: 'JD 11/26/2021 21:04:15' prior: 50982444!
buildMorphicCatalogWindow
		
	self layoutMorph beColumn;
	separation: 20;
	axisEdgeWeight: 0;
	addMorph: self buildCatalogAndAddToCartRow;
	addMorph: self buildCartRow.
	"addMorph: self buildButtonCheckoutAndPurchasesButtons."! !
!TusLibrosWindow methodsFor: 'catalog - layouts' stamp: 'JD 11/26/2021 21:06:48'!
buildButtonCheckoutAndPurchasesButtons

	| buttonsLayoutMorph checkoutCartButtonMorph showPurchasesButtonMorph |
	checkoutCartButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #checkoutCart label: 'Checkout Cart'.
	
	showPurchasesButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #showPurchases label: 'Show Purchases'.
	
	buttonsLayoutMorph := LayoutMorph newRow.
	buttonsLayoutMorph separation: 5;
	axisEdgeWeight: 0.5;
	addMorph: checkoutCartButtonMorph;
	addMorph: showPurchasesButtonMorph.
	
	^ buttonsLayoutMorph! !
!TusLibrosWindow methodsFor: 'catalog - layouts' stamp: 'JD 11/26/2021 21:06:54' prior: 50983646!
buildButtonCheckoutAndPurchasesButtons

	| buttonsLayoutMorph checkoutCartButtonMorph showPurchasesButtonMorph |

	checkoutCartButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #checkoutCart label: 'Checkout Cart'.
	
	showPurchasesButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #showPurchases label: 'Show Purchases'.
	
	buttonsLayoutMorph := LayoutMorph newRow.
	buttonsLayoutMorph separation: 5;
	axisEdgeWeight: 0.5;
	addMorph: checkoutCartButtonMorph;
	addMorph: showPurchasesButtonMorph.
	
	^ buttonsLayoutMorph! !
!TusLibrosWindow methodsFor: 'catalog - layouts' stamp: 'JD 11/26/2021 21:07:07'!
buildCheckoutAndPurchasesButtons

	| buttonsLayoutMorph checkoutCartButtonMorph showPurchasesButtonMorph |

	checkoutCartButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #checkoutCart label: 'Checkout Cart'.
	
	showPurchasesButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #showPurchases label: 'Show Purchases'.
	
	buttonsLayoutMorph := LayoutMorph newRow.
	buttonsLayoutMorph separation: 5;
	axisEdgeWeight: 0.5;
	addMorph: checkoutCartButtonMorph;
	addMorph: showPurchasesButtonMorph.
	
	^ buttonsLayoutMorph! !

!methodRemoval: TusLibrosWindow #buildButtonCheckoutAndPurchasesButtons stamp: 'JD 11/26/2021 21:07:07'!
buildButtonCheckoutAndPurchasesButtons

	| buttonsLayoutMorph checkoutCartButtonMorph showPurchasesButtonMorph |

	checkoutCartButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #checkoutCart label: 'Checkout Cart'.
	
	showPurchasesButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #showPurchases label: 'Show Purchases'.
	
	buttonsLayoutMorph := LayoutMorph newRow.
	buttonsLayoutMorph separation: 5;
	axisEdgeWeight: 0.5;
	addMorph: checkoutCartButtonMorph;
	addMorph: showPurchasesButtonMorph.
	
	^ buttonsLayoutMorph!
!TusLibrosWindow methodsFor: 'windows build' stamp: 'JD 11/26/2021 21:07:21' prior: 50983636!
buildMorphicCatalogWindow
		
	self layoutMorph beColumn;
	separation: 20;
	axisEdgeWeight: 0;
	addMorph: self buildCatalogAndAddToCartRow;
	addMorph: self buildCartRow.
	"addMorph: self buildCheckoutAndPurchasesButtons"! !
!TusLibrosWindow methodsFor: 'windows build' stamp: 'JD 11/26/2021 21:07:29' prior: 50983732!
buildMorphicCatalogWindow
		
	self layoutMorph beColumn;
	separation: 20;
	axisEdgeWeight: 0;
	addMorph: self buildCatalogAndAddToCartRow;
	addMorph: self buildCartRow;
	addMorph: self buildCheckoutAndPurchasesButtons! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!
!TusLibrosWindow methodsFor: 'windows build' stamp: 'JD 11/26/2021 21:08:24' prior: 50983742!
buildMorphicCatalogWindow
		
	self layoutMorph beColumn;
	separation: 10;
	axisEdgeWeight: 0;
	addMorph: self buildCatalogAndAddToCartRow;
	addMorph: self buildCartRow;
	addMorph: self buildCheckoutAndPurchasesButtons! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 21:16:50' prior: 50983143!
presentCatalog: aCatalog
	
	| presentedCatalog |

	presentedCatalog := OrderedCollection new.
	aCatalog keysDo: [:aBook |
		| bookPrice |
		bookPrice := aCatalog at: aBook.
		presentedCatalog add: (aBook, '-', bookPrice asString, '$')
	].
	^ presentedCatalog! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 21:21:40'!
showPurchases

	TranscriptWindow openTranscript.
	Transcript clear.
	Transcript show: restInterface sendShowPurchasesRequest.
	Transcript show: ' '.
! !
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 21:29:10' prior: 50982668!
redirectToCatalogWindowWith: aCartId

	self model: (TusLibrosCatalogWindowModel newFor: aCartId authenticating: self model usernameText with: self model passwordText).
	self setLabel: 'Catalog'.
	self layoutMorph submorphs do: [:aSubmorph | aSubmorph dismissMorph].
	self buildMorphicCatalogWindow.

	self model when: #itemsAddedToCart send: #refreshCartList to: self.! !
!TusLibrosCatalogWindowModel class methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 21:29:38'!
newFor: aCartId authenticating: aUsername with: aPassword
	^ self new initializeFor: aCartId authenticating: aUsername with: aPassword! !

!methodRemoval: TusLibrosCatalogWindowModel class #newFor: stamp: 'JD 11/26/2021 21:29:42'!
newFor: aCartId
	
	^ self new initializeFor: aCartId!

!classDefinition: #TusLibrosCatalogWindowModel category: 'TusLibros-View' stamp: 'JD 11/26/2021 21:30:41'!
Object subclass: #TusLibrosCatalogWindowModel
	instanceVariableNames: 'cartId restInterface catalogListIndex itemQuantity username'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!

!classDefinition: #TusLibrosCatalogWindowModel category: 'TusLibros-View' stamp: 'JD 11/26/2021 21:30:42'!
Object subclass: #TusLibrosCatalogWindowModel
	instanceVariableNames: 'cartId restInterface catalogListIndex itemQuantity username password'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 21:30:38'!
initializeFor: aCartId authenticating: aUsername with: aPassword
	
	cartId := aCartId.
	username := aUsername.
	password := aPassword.
	catalogListIndex := 1.
	itemQuantity := ''.
	restInterface := TusLibrosRestInterface new
! !
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 21:31:32' prior: 50983851!
showPurchases

	TranscriptWindow openTranscript.
	Transcript clear.
	Transcript show: (restInterface sendShowPurchasesRequestFor: username authenticatingWith: password).
	Transcript show: ' '.
! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 21:32:54'!
sendShowPurchasesRequestFor: aUsername authenticatingWith: aPassword
	
	| response urlFields |
	
	urlFields := Dictionary newFromPairs: {'user'. aUsername. 'password'. aPassword.}.
	response := WebClient htmlSubmit: self showPurchasesUrl fields: urlFields.
	response isSuccess 
		ifTrue:[^ WebUtils jsonDecode: ((response content) readStream)]
		ifFalse:[^self error: response content].! !
!TusLibrosRestInterface methodsFor: 'urls' stamp: 'JD 11/26/2021 21:33:20'!
listPurchasesUrl

	^ self rootUrl, '/list-purchases'! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 21:34:48'!
sendListPurchasesRequestFor: aUsername authenticatingWith: aPassword
	
	| response urlFields |
	
	urlFields := Dictionary newFromPairs: {'user'. aUsername. 'password'. aPassword.}.
	response := WebClient htmlSubmit: self showPurchasesUrl fields: urlFields.
	response isSuccess 
		ifTrue:[^ WebUtils jsonDecode: ((response content) readStream)]
		ifFalse:[^self error: response content].! !
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 21:34:48' prior: 50983917!
showPurchases

	TranscriptWindow openTranscript.
	Transcript clear.
	Transcript show: (restInterface sendListPurchasesRequestFor: username authenticatingWith: password).
	Transcript show: ' '.
! !

!methodRemoval: TusLibrosRestInterface #sendShowPurchasesRequestFor:authenticatingWith: stamp: 'JD 11/26/2021 21:34:48'!
sendShowPurchasesRequestFor: aUsername authenticatingWith: aPassword
	
	| response urlFields |
	
	urlFields := Dictionary newFromPairs: {'user'. aUsername. 'password'. aPassword.}.
	response := WebClient htmlSubmit: self showPurchasesUrl fields: urlFields.
	response isSuccess 
		ifTrue:[^ WebUtils jsonDecode: ((response content) readStream)]
		ifFalse:[^self error: response content].!
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 21:34:54' prior: 50983967!
sendListPurchasesRequestFor: aUsername authenticatingWith: aPassword
	
	| response urlFields |
	
	urlFields := Dictionary newFromPairs: {'user'. aUsername. 'password'. aPassword.}.
	response := WebClient htmlSubmit: self listPurchasesUrl fields: urlFields.
	response isSuccess 
		ifTrue:[^ WebUtils jsonDecode: ((response content) readStream)]
		ifFalse:[^self error: response content].! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 21:39:26' prior: 50982650!
initializeWithTitle: aTitle
	
	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: aTitle.
	self model: (TusLibrosLogInWindowModel new).
	self morphExtent: 1035@485.
	self buildMorphicWindow.
	self openInWorld.
			
	self model when: #newCartCreated send: #redirectToCatalogWindowWith: to: self! !
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 21:39:40' prior: 50983859!
redirectToCatalogWindowWith: aCartId

	self model: (TusLibrosCatalogWindowModel newFor: aCartId authenticating: self model usernameText with: self model passwordText).
	self setLabel: 'Catalog'.
	self layoutMorph submorphs do: [:aSubmorph | aSubmorph dismissMorph].
	self buildMorphicCatalogWindow.

	self model when: #itemsAddedToCart send: #refreshCartList to: self.
	self model when: #cartCheckouted send: #redirectToSuccessfullyCheckout to: self! !
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 21:47:16'!
checkoutCart

	| ticket |

	ticket := restInterface sendCheckoutOutCartRequestFor: cartId withCreditCardNumber: '11111111111111' expiringOn: '2/2050' ownedBy: 'Juan'.
	
	^ ticket! !
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 21:47:49' prior: 50984077!
checkoutCart

	| ticket |

	ticket := restInterface sendCheckoutOutCartRequestFor: cartId withCreditCardNumber: '11111111111111' expiringOn: '2/2050' ownedBy: 'Juan'.
	
	self triggerEvent: #checkoutedCart with: ticket! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 21:50:38'!
sendCheckoutOutCartRequestFor: aCartId withCreditCardNumber: aCreditCardNumber expiringOn: anExpirationMonthOfYear ownedBy: aCreditCardOwner

	| response urlFields |
	
	urlFields := Dictionary newFromPairs: {'cartId'.aCartId. 'ccn'.aCreditCardNumber. 'cced'.anExpirationMonthOfYear. 'cco'.aCreditCardOwner.}.
	
	response := WebClient htmlSubmit: self checkoutCartUrl fields: urlFields.
	
	response isSuccess 
		ifTrue:[^WebUtils jsonDecode: ((response content) readStream)]
		ifFalse:[^self error: response content].! !
!TusLibrosRestInterface methodsFor: 'urls' stamp: 'JD 11/26/2021 21:50:54'!
checkoutCartUrl

	^ self rootUrl, '/checkout-cart'! !

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!

response content!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

----SNAPSHOT----(26 November 2021 21:52:39) CuisUniversity-4972.image priorSource: 20863420!
!TusLibrosSystemFacade methodsFor: 'facade protocol' stamp: 'JD 11/26/2021 21:55:22' prior: 50962293!
checkOutCartIdentifiedAs: aCartId withCreditCardNumbered: aCreditCartNumber ownedBy: anOwner expiringOn: anExpirationMonthOfYear

	self
		withCartSessionIdentifiedAs: aCartId
		do: [ :cartSession | ^ cartSession
			checkOutCartWithCreditCardNumbered: aCreditCartNumber
			ownedBy: anOwner
			expiringOn: anExpirationMonthOfYear ]
! !
!TusLibrosServer methodsFor: 'initialization' stamp: 'JD 11/26/2021 21:56:31' prior: 50965346!
addCheckoutCartService

	webServer addService: '/checkout-cart' action:[:request | | cartId cardNumber cardExpirationDate cardOwner ticket |
		
		[	
			cartId := (request fields at: 'cartId') asNumber.
			cardNumber := (request fields at: 'ccn') asNumber.
			cardExpirationDate := Month readFrom: (ReadStream on: (request fields at: 'cced')).
			cardOwner := request fields at: 'cco'.
			ticket := tusLibrosSystemFacade checkOutCartIdentifiedAs: cartId withCreditCardNumbered: cardNumber ownedBy: cardOwner expiringOn: cardExpirationDate.
			request send200Response: ticket
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. !

	TusLibrosWindow open.!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!
!TusLibrosServer methodsFor: 'initialization' stamp: 'JD 11/17/2021 18:14:06' prior: 50984159!
addCheckoutCartService

	webServer addService: '/checkout-cart' action:[:request | | cartId cardNumber cardExpirationDate cardOwner |
		
		[	
			cartId := (request fields at: 'cartId') asNumber.
			cardNumber := (request fields at: 'ccn') asNumber.
			cardExpirationDate := Month readFrom: (ReadStream on: (request fields at: 'cced')).
			cardOwner := request fields at: 'cco'.
			tusLibrosSystemFacade checkOutCartIdentifiedAs: cartId withCreditCardNumbered: cardNumber ownedBy: cardOwner expiringOn: cardExpirationDate.
			request send200Response: 'OK'
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 22:07:14' prior: 50984099!
sendCheckoutOutCartRequestFor: aCartId withCreditCardNumber: aCreditCardNumber expiringOn: anExpirationMonthOfYear ownedBy: aCreditCardOwner

	| response urlFields |
	
	urlFields := Dictionary newFromPairs: {'cartId'.aCartId. 'ccn'.aCreditCardNumber. 'cced'.anExpirationMonthOfYear. 'cco'.aCreditCardOwner.}.
	
	response := WebClient htmlSubmit: self checkoutCartUrl fields: urlFields.
	
	response isSuccess 
		ifTrue:[^WebUtils jsonDecode: response content]
		ifFalse:[^self error: response content].! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 22:07:41' prior: 50984247!
sendCheckoutOutCartRequestFor: aCartId withCreditCardNumber: aCreditCardNumber expiringOn: anExpirationMonthOfYear ownedBy: aCreditCardOwner

	| response urlFields |
	
	urlFields := Dictionary newFromPairs: {'cartId'.aCartId. 'ccn'.aCreditCardNumber. 'cced'.anExpirationMonthOfYear. 'cco'.aCreditCardOwner.}.
	
	response := WebClient htmlSubmit: self checkoutCartUrl fields: urlFields.
	
	response isSuccess 
		ifTrue:[^response content]
		ifFalse:[^self error: response content].! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 22:10:46' prior: 50983983!
showPurchases

	TranscriptWindow openTranscript.
	Transcript clear.
	Transcript show: (self presentPurchases: (restInterface sendListPurchasesRequestFor: username authenticatingWith: password)).
	Transcript show: ' '.
! !

(WriteStream from: (OrderedCollection with: 'Hola')) nextPut: 'Chau'!

(WriteStream with: (OrderedCollection with: 'Hola')) nextPut: 'Chau'!

((WriteStream with: (OrderedCollection with: 'Hola')) nextPut: 'Chau') contents!

ReadStream with: ((WriteStream with: (OrderedCollection with: 'Hola')) nextPut: 'Chau') contents!

ReadStream on: ((WriteStream with: (OrderedCollection with: 'Hola')) nextPut: 'Chau') contents!

ReadStream on: (((WriteStream with: (OrderedCollection with: 'Hola')) nextPut: 'Chau') contents)!

ReadStream on: (((WriteStream with: (OrderedCollection with: 'Hola')) nextPut: 'Chau') newLine contents)!
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 22:30:01'!
presentPurchases: purchases
	
	| presentedPurchases catalog totalSpent |
	
	catalog := restInterface sendListCatalogRequest.
	totalSpent := 0.
	presentedPurchases := WriteStream with: OrderedCollection new.
	presentedPurchases nextPut: 'Book', '-', 'Quantity'.
	presentedPurchases newLine.
	purchases keysDo: [:aBook | 
		| bookQuantity bookPrice |
		bookQuantity := purchases at: aBook.
		bookPrice := catalog at: aBook.
		totalSpent := totalSpent + bookPrice.
		presentedPurchases nextPut: aBook, '-', bookQuantity asString.
		presentedPurchases newLine.
	].
	presentedPurchases add: 'Total: ', totalSpent asString, '$'.

	^ ReadStream on: presentedPurchases contents! !
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 22:30:29' prior: 50984348!
showPurchases

	| purchases |
	TranscriptWindow openTranscript.
	Transcript clear.
	purchases _ restInterface sendListPurchasesRequestFor: username authenticatingWith: password.
	Transcript show: (self presentPurchases: (purchases)).
	Transcript show: ' '.
! !
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 22:30:47' prior: 50984403!
showPurchases

	| purchases |
	
	purchases := restInterface sendListPurchasesRequestFor: username authenticatingWith: password.

	TranscriptWindow openTranscript.
	Transcript clear.
	Transcript show: (self presentPurchases: (purchases)).
	Transcript show: ' '.
! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 22:31:24' prior: 50984378!
presentPurchases: purchases
	
	| presentedPurchases catalog totalSpent |
	
	catalog := restInterface sendListCatalogRequest.
	totalSpent := 0.
	presentedPurchases := WriteStream with: OrderedCollection new.
	presentedPurchases nextPut: 'Book', '-', 'Quantity'.
	presentedPurchases newLine.
	purchases keysDo: [:aBook | 
		| bookQuantity bookPrice |
		bookQuantity := purchases at: aBook.
		bookPrice := catalog at: aBook.
		totalSpent := totalSpent + bookPrice.
		presentedPurchases nextPut: aBook, '-', bookQuantity asString.
		presentedPurchases newLine.
	].
	presentedPurchases nextPut: 'Total: ', totalSpent asString, '$'.

	^ ReadStream on: presentedPurchases contents! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 22:35:18' prior: 50984415!
showPurchases

	| purchases catalog totalSpent|
	
	catalog := restInterface sendListCatalogRequest.
	purchases := restInterface sendListPurchasesRequestFor: username authenticatingWith: password.
	Transcript clear.
	totalSpent := 0.
	Transcript show: 'Book', '-', 'Quantity'.
	purchases keysDo: [:aBook | 
		| bookQuantity bookPrice |
		bookQuantity := purchases at: aBook.
		bookPrice := catalog at: aBook.
		totalSpent := totalSpent + bookPrice.
		Transcript show: aBook, '-', bookQuantity asString.
	].
	Transcript show: 'Total: ', totalSpent asString, '$'.
	TranscriptWindow openTranscript.
! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 22:36:31' prior: 50984473!
showPurchases

	| purchases catalog totalSpent|
	
	catalog := restInterface sendListCatalogRequest.
	purchases := restInterface sendListPurchasesRequestFor: username authenticatingWith: password.
	Transcript clear.
	totalSpent := 0.
	Transcript show: 'Book', '-', 'Quantity'.
	Transcript newLine.
	purchases keysDo: [:aBook | 
		| bookQuantity bookPrice |
		bookQuantity := purchases at: aBook.
		bookPrice := catalog at: aBook.
		totalSpent := totalSpent + bookPrice.
		Transcript show: aBook, '-', bookQuantity asString.
		Transcript newLine.
	].
	Transcript show: 'Total: ', totalSpent asString, '$'.
	TranscriptWindow openTranscript.
! !
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 22:36:53' prior: 50984514!
showPurchases

	| purchases catalog totalSpent|
	
	catalog := restInterface sendListCatalogRequest.
	purchases := restInterface sendListPurchasesRequestFor: username authenticatingWith: password.
	Transcript clear.
	Transcript newLine.
	totalSpent := 0.
	Transcript show: 'Book', '-', 'Quantity'.
	Transcript newLine.
	purchases keysDo: [:aBook | 
		| bookQuantity bookPrice |
		bookQuantity := purchases at: aBook.
		bookPrice := catalog at: aBook.
		totalSpent := totalSpent + bookPrice.
		Transcript show: aBook, '-', bookQuantity asString.
		Transcript newLine.
	].
	Transcript show: 'Total: ', totalSpent asString, '$'.
	TranscriptWindow openTranscript.
! !
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 22:37:04' prior: 50984538!
showPurchases

	| purchases catalog totalSpent|
	
	catalog := restInterface sendListCatalogRequest.
	purchases := restInterface sendListPurchasesRequestFor: username authenticatingWith: password.
	Transcript clear.
	totalSpent := 0.
	Transcript show: 'Book', '-', 'Quantity'.
	Transcript newLine.
	purchases keysDo: [:aBook | 
		| bookQuantity bookPrice |
		bookQuantity := purchases at: aBook.
		bookPrice := catalog at: aBook.
		totalSpent := totalSpent + bookPrice.
		Transcript show: aBook, '-', bookQuantity asString.
		Transcript newLine.
	].
	Transcript show: 'Total: ', totalSpent asString, '$'.
	TranscriptWindow openTranscript.
! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

!methodRemoval: TusLibrosCatalogWindowModel #presentPurchases: stamp: 'JD 11/26/2021 22:39:48'!
presentPurchases: purchases
	
	| presentedPurchases catalog totalSpent |
	
	catalog := restInterface sendListCatalogRequest.
	totalSpent := 0.
	presentedPurchases := WriteStream with: OrderedCollection new.
	presentedPurchases nextPut: 'Book', '-', 'Quantity'.
	presentedPurchases newLine.
	purchases keysDo: [:aBook | 
		| bookQuantity bookPrice |
		bookQuantity := purchases at: aBook.
		bookPrice := catalog at: aBook.
		totalSpent := totalSpent + bookPrice.
		presentedPurchases nextPut: aBook, '-', bookQuantity asString.
		presentedPurchases newLine.
	].
	presentedPurchases nextPut: 'Total: ', totalSpent asString, '$'.

	^ ReadStream on: presentedPurchases contents!
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 22:40:15' prior: 50982940!
listCart

	^ restInterface sendListCartRequest: cartId.! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.
	!

----SNAPSHOT----(26 November 2021 22:40:59) CuisUniversity-4972.image priorSource: 20879704!
!TusLibrosWindow methodsFor: 'catalog - layouts' stamp: 'JD 11/26/2021 22:43:55' prior: 50982455!
buildCartRow
	
	| row removeFromCartButtonMorph |
	
	removeFromCartButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #removeFromCart  label: 'Remove From Cart'.

	row := LayoutMorph newRow.
	row separation: 20;
	axisEdgeWeight: 0.5;
	addMorph: self buildCart;
	addMorph: removeFromCartButtonMorph.
	
	^ row
	! !
!TusLibrosWindow methodsFor: 'catalog - layouts' stamp: 'JD 11/26/2021 22:45:02' prior: 50983258!
buildCart

	| column |

	cartListMorph := PluggableListMorph model: self model listGetter: #listCart indexGetter: #cartListIndex indexSetter: #cartListIndex:.
	cartListMorph borderColor: Color skyBlue; borderWidth: 1; morphWidth:300.
	
	column := LayoutMorph newColumn.
	column separation: 5; 
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents: 'Cart');
	addMorph: cartListMorph.

	^ column! !

!classDefinition: #TusLibrosCatalogWindowModel category: 'TusLibros-View' stamp: 'JD 11/26/2021 22:45:24'!
Object subclass: #TusLibrosCatalogWindowModel
	instanceVariableNames: 'cartId restInterface catalogListIndex itemQuantity username password cartListIndex'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 22:45:23'!
cartListIndex
	
	^ cartListIndex! !
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 22:45:35'!
cartListIndex: anIndex
	
	cartListIndex := anIndex! !
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 22:50:39'!
removeFromCart
	
	| aBookToRemove |
	
	aBookToRemove := (self listCart at: cartListIndex).
	restInterface sendRemoveFromCartRequest: aBookToRemove from: cartId.
	
	self triggerEvent: #cartModified
	! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 22:51:48'!
sendRemoveFromCartRequest: aBookToRemove from: aCartId	

	| response urlFields |
	
	urlFields := Dictionary newFromPairs: {'book'. aBookToRemove . 'cartId'. aCartId}.
	
	response := WebClient htmlSubmit: self removeCartUrl fields: urlFields.
	
	response isSuccess 
		ifTrue:[^response content]
		ifFalse:[^self error: response content].! !
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 22:51:59' prior: 50984700!
sendRemoveFromCartRequest: aBookToRemove from: aCartId	

	| response urlFields |
	
	urlFields := Dictionary newFromPairs: {'book'. aBookToRemove . 'cartId'. aCartId}.
	
	response := WebClient htmlSubmit: self removeFromCartUrl fields: urlFields.
	
	response isSuccess 
		ifTrue:[^response content]
		ifFalse:[^self error: response content].! !
!TusLibrosRestInterface methodsFor: 'urls' stamp: 'JD 11/26/2021 22:52:21'!
removeFromCartUrl

	^ self rootUrl, '/remove-from-cart'! !
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 22:52:41' prior: 50982916!
addToCart

	| books |

	books := restInterface sendListCatalogRequest keys.
	restInterface sendAddToCartRequest: itemQuantity of: (books at: catalogListIndex) to: cartId.
	self triggerEvent: #cartModified
	! !
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 22:52:59' prior: 50984059!
redirectToCatalogWindowWith: aCartId

	self model: (TusLibrosCatalogWindowModel newFor: aCartId authenticating: self model usernameText with: self model passwordText).
	self setLabel: 'Catalog'.
	self layoutMorph submorphs do: [:aSubmorph | aSubmorph dismissMorph].
	self buildMorphicCatalogWindow.

	self model when: #cartModified send: #refreshCartList to: self.
	self model when: #cartCheckouted send: #redirectToSuccessfullyCheckout to: self! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 22:56:58' prior: 50984613!
listCart
	|cart|
	cart := restInterface sendListCartRequest: cartId.
	^ cart add: ''! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 22:58:29' prior: 50984801!
listCart
	|cart|
	cart := restInterface sendListCartRequest: cartId.
	cart := cart asOrderedCollection add: ''.
	^ cart! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 22:59:06' prior: 50984826!
listCart

	^ restInterface sendListCartRequest: cartId! !
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 22:59:55' prior: 50981628!
initializeFor: aCartId
	
	cartId := aCartId.
	catalogListIndex := 1.
	cartListIndex := 1.
	itemQuantity := ''.
	restInterface := TusLibrosRestInterface new.
! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 23:00:19' prior: 50984858!
initializeFor: aCartId
	
	cartId := aCartId.
	catalogListIndex := 1.
	cartListIndex := 0.
	itemQuantity := ''.
	restInterface := TusLibrosRestInterface new.
! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 23:01:14' prior: 50984886!
initializeFor: aCartId
	
	cartId := aCartId.
	catalogListIndex := 1.
	cartListIndex := 1.
	itemQuantity := ''.
	restInterface := TusLibrosRestInterface new.
! !
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 23:04:35' prior: 50984916!
initializeFor: aCartId
	
	cartId := aCartId.
	catalogListIndex := 1.
	cartListIndex := 0.
	itemQuantity := ''.
	restInterface := TusLibrosRestInterface new.
! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!

model perform: getIndexSelector!
!TusLibrosWindow methodsFor: 'catalog - layouts' stamp: 'JD 11/26/2021 23:08:51' prior: 50984654!
buildCart

	| column |

	cartListMorph := PluggableListMorph model: self model listGetter: #listCart indexGetter: #cartListIndex indexSetter: #cartListIndex:.
	cartListMorph borderColor: Color skyBlue; borderWidth: 1; morphWidth:300.
	
	column := LayoutMorph newColumn.
	column separation: 5; 
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents: 'Cart');
	addMorph: cartListMorph.

	^ column! !
!TusLibrosWindow methodsFor: 'catalog - layouts' stamp: 'JD 11/26/2021 23:08:58' prior: 50984953!
buildCart

	| column |

	cartListMorph := PluggableListMorph model: self model listGetter: #listCart indexGetter: #cartListIndex indexSetter: #cartListIndex:.
	cartListMorph borderColor: Color skyBlue; borderWidth: 1; morphWidth:300.
	
	column := LayoutMorph newColumn.
	column separation: 5; 
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents: 'Cart');
	addMorph: cartListMorph.

	^ column! !
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 23:09:26' prior: 50983906!
initializeFor: aCartId authenticating: aUsername with: aPassword
	
	cartId := aCartId.
	username := aUsername.
	password := aPassword.
	catalogListIndex := 1.
	cartListIndex := 0.
	itemQuantity := ''.
	restInterface := TusLibrosRestInterface new
! !

!methodRemoval: TusLibrosCatalogWindowModel #initializeFor: stamp: 'JD 11/26/2021 23:09:33'!
initializeFor: aCartId
	
	cartId := aCartId.
	catalogListIndex := 1.
	cartListIndex := 0.
	itemQuantity := ''.
	restInterface := TusLibrosRestInterface new.
!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 23:10:09' prior: 50984985!
initializeFor: aCartId authenticating: aUsername with: aPassword
	
	cartId := aCartId.
	username := aUsername.
	password := aPassword.
	catalogListIndex := 0.
	cartListIndex := 0.
	itemQuantity := ''.
	restInterface := TusLibrosRestInterface new
! !
!WordsClientWindow methodsFor: 'access' stamp: 'NR 6/23/2021 06:58:02' prior: 50983155!
refreshListOfWords
	
	wordsListMorph updateList.
	wordsListMorph setSelectionIndex: 0.
	! !
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/26/2021 23:10:43' prior: 50983622!
refreshCartList

	cartListMorph updateList.
	cartListMorph setSelectionIndex: 0.! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!

----SNAPSHOT----(26 November 2021 23:12:11) CuisUniversity-4972.image priorSource: 20895532!
!TusLibrosWindow methodsFor: 'catalog - layouts' stamp: 'JD 11/26/2021 23:13:39' prior: 50982826!
buildItemQuantityAndAddToCartButtonColumn
	
	| addToCartButtonMorph itemQuantityTextBoxMorph column |
	
	itemQuantityTextBoxMorph := TextModelMorph textProvider: self model textGetter: #itemQuantityText textSetter: #itemQuantityText:. 
	itemQuantityTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | itemQuantityTextBoxMorph innerTextMorph acceptContents].
	itemQuantityTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 25; morphHeight: 25.
	
	addToCartButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #addToCart  label: 'Add To Cart'.
	
	column := LayoutMorph newColumn.
	column separation: 2; 
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'Quantity');
	addMorph: itemQuantityTextBoxMorph;
	addMorph: addToCartButtonMorph.
	
	^ column
! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!
!TusLibrosWindow methodsFor: 'catalog - layouts' stamp: 'JD 11/26/2021 23:14:04' prior: 50985068!
buildItemQuantityAndAddToCartButtonColumn
	
	| addToCartButtonMorph itemQuantityTextBoxMorph column |
	
	itemQuantityTextBoxMorph := TextModelMorph textProvider: self model textGetter: #itemQuantityText textSetter: #itemQuantityText:. 
	itemQuantityTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | itemQuantityTextBoxMorph innerTextMorph acceptContents].
	itemQuantityTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 25; morphHeight: 25.
	
	addToCartButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #addToCart  label: 'Add To Cart'.
	
	column := LayoutMorph newColumn.
	column separation: 20; 
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'Quantity');
	addMorph: itemQuantityTextBoxMorph;
	addMorph: addToCartButtonMorph.
	
	^ column
! !

	TusLibrosWindow open.!
!TusLibrosWindow methodsFor: 'catalog - layouts' stamp: 'JD 11/26/2021 23:14:16' prior: 50985116!
buildItemQuantityAndAddToCartButtonColumn
	
	| addToCartButtonMorph itemQuantityTextBoxMorph column |
	
	itemQuantityTextBoxMorph := TextModelMorph textProvider: self model textGetter: #itemQuantityText textSetter: #itemQuantityText:. 
	itemQuantityTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | itemQuantityTextBoxMorph innerTextMorph acceptContents].
	itemQuantityTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 25; morphHeight: 25.
	
	addToCartButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #addToCart  label: 'Add To Cart'.
	
	column := LayoutMorph newColumn.
	column separation: -20; 
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'Quantity');
	addMorph: itemQuantityTextBoxMorph;
	addMorph: addToCartButtonMorph.
	
	^ column
! !

	TusLibrosWindow open.!
!TusLibrosWindow methodsFor: 'catalog - layouts' stamp: 'JD 11/26/2021 23:14:25' prior: 50985146!
buildItemQuantityAndAddToCartButtonColumn
	
	| addToCartButtonMorph itemQuantityTextBoxMorph column |
	
	itemQuantityTextBoxMorph := TextModelMorph textProvider: self model textGetter: #itemQuantityText textSetter: #itemQuantityText:. 
	itemQuantityTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | itemQuantityTextBoxMorph innerTextMorph acceptContents].
	itemQuantityTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 25; morphHeight: 25.
	
	addToCartButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #addToCart  label: 'Add To Cart'.
	
	column := LayoutMorph newColumn.
	column separation: 5; 
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'Quantity');
	addMorph: itemQuantityTextBoxMorph;
	addMorph: addToCartButtonMorph.
	
	^ column
! !
!TusLibrosWindow methodsFor: 'catalog - layouts' stamp: 'JD 11/26/2021 23:14:34' prior: 50982463!
buildCatalogAndAddToCartRow
	
	| row |

	row := LayoutMorph newRow.
	row separation: 5;
	axisEdgeWeight: 0.5;
	addMorph: self buildCatalogColumn;
	addMorph: self buildItemQuantityAndAddToCartButtonColumn.
	
	^ row
	! !

	TusLibrosWindow open.!
!TusLibrosWindow methodsFor: 'catalog - layouts' stamp: 'JD 11/26/2021 23:14:47' prior: 50985205!
buildCatalogAndAddToCartRow
	
	| row |

	row := LayoutMorph newRow.
	row separation: -100;
	axisEdgeWeight: 0.5;
	addMorph: self buildCatalogColumn;
	addMorph: self buildItemQuantityAndAddToCartButtonColumn.
	
	^ row
	! !

	TusLibrosWindow open.!
!TusLibrosWindow methodsFor: 'catalog - layouts' stamp: 'JD 11/26/2021 23:15:07' prior: 50985216!
buildCatalogAndAddToCartRow
	
	| row |

	row := LayoutMorph newRow.
	row separation: 20;
	axisEdgeWeight: 0.5;
	addMorph: self buildCatalogColumn;
	addMorph: self buildItemQuantityAndAddToCartButtonColumn.
	
	^ row
	! !
!TusLibrosWindow methodsFor: 'catalog - layouts' stamp: 'JD 11/26/2021 23:17:23' prior: 50985176!
buildItemQuantityAndAddToCartButtonColumn
	
	| removeFromCartButtonMorph column |

	removeFromCartButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #removeFromCart  label: 'Remove From Cart'.
	
	column := LayoutMorph newColumn.
	column separation: 5; 
	axisEdgeWeight: 0.5;
	addMorph: removeFromCartButtonMorph.
	
	^ column
! !
!TusLibrosWindow methodsFor: 'catalog - layouts' stamp: 'JD 11/26/2021 23:14:25' prior: 50985237!
buildItemQuantityAndAddToCartButtonColumn
	
	| addToCartButtonMorph itemQuantityTextBoxMorph column |
	
	itemQuantityTextBoxMorph := TextModelMorph textProvider: self model textGetter: #itemQuantityText textSetter: #itemQuantityText:. 
	itemQuantityTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | itemQuantityTextBoxMorph innerTextMorph acceptContents].
	itemQuantityTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 25; morphHeight: 25.
	
	addToCartButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #addToCart  label: 'Add To Cart'.
	
	column := LayoutMorph newColumn.
	column separation: 5; 
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'Quantity');
	addMorph: itemQuantityTextBoxMorph;
	addMorph: addToCartButtonMorph.
	
	^ column
! !
!TusLibrosWindow methodsFor: 'catalog - layouts' stamp: 'JD 11/26/2021 23:18:30'!
buildRemoveFromCartButtonColumn

	| removeFromCartButtonMorph column |

	removeFromCartButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #removeFromCart  label: 'Remove From Cart'.
	
	column := LayoutMorph newColumn.
	column separation: 5; 
	axisEdgeWeight: 0.5;
	addMorph: removeFromCartButtonMorph.
	
	^ column
! !
!TusLibrosWindow methodsFor: 'catalog - layouts' stamp: 'JD 11/26/2021 23:18:48' prior: 50984640!
buildCartRow
	
	| row |

	row := LayoutMorph newRow.
	row separation: 20;
	axisEdgeWeight: 0.5;
	addMorph: self buildCart;
	addMorph: self buildRemoveFromCartButtonColumn.
	
	^ row
	! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

----SNAPSHOT----(26 November 2021 23:19:39) CuisUniversity-4972.image priorSource: 20909219!

----SNAPSHOT----(26 November 2021 23:19:48) CuisUniversity-4972.image priorSource: 20917553!

----STARTUP---- (27 November 2021 10:46:02) as /home/juli/Documentos/Facu/Inge1/cuis-university/CuisUniversity-4972.image!

!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/27/2021 11:04:53' prior: 50984744!
redirectToCatalogWindowWith: aCartId
	
	self halt.
	self model: (TusLibrosCatalogWindowModel newFor: aCartId authenticating: self model usernameText with: self model passwordText).
	self setLabel: 'Catalog'.
	self layoutMorph submorphs do: [:aSubmorph | aSubmorph dismissMorph].
	self buildMorphicCatalogWindow.

	self model when: #cartModified send: #refreshCartList to: self.
	self model when: #cartCheckouted send: #redirectToSuccessfullyCheckout to: self! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!

	self layoutMorph.!

self layoutMorph submorphs!

self at: index!

self layoutMorph submorphs!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/27/2021 12:31:11'!
username
	
	^ username! !
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/27/2021 12:31:23'!
password
	
	^ password! !

!classDefinition: #TusLibrosTicketWindowModel category: 'TusLibros-View' stamp: 'JD 11/27/2021 12:38:08'!
Object subclass: #TusLibrosTicketWindowModel
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/27/2021 12:39:07'!
redirectToTicketWindow
	
	self model: (TusLibrosTicketWindowModel newFor: self model listCart authenticating: 	self model username with: self model password).
	self setLabel: 'Checkout Completed'.
	self layoutMorph submorphs do: [:aSubmorph | aSubmorph dismissMorph].
	self buildTicketWindow.

	self model when: #loggedOut send: #redirectToLogin to: self.
	self model when: #newCartRequested send: #createNewCartAndRedirectToCatalog to: self! !
!TusLibrosWindow methodsFor: 'catalog - layouts' stamp: 'JD 11/27/2021 12:59:29'!
buildTicketColumn
	
	| column ticketListMorph |
	
	ticketListMorph := PluggableListMorph model: self model listTicket listGetter: nil indexGetter: nil indexSetter: nil.
	ticketListMorph borderColor: Color skyBlue; borderWidth: 1; morphWidth:300.

	column := LayoutMorph newColumn.
	column separation: 5; 
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents: 'Ticket');
	addMorph: self ticketListMorph.
	
	^ column
	! !
!TusLibrosWindow methodsFor: 'catalog - layouts' stamp: 'JD 11/27/2021 12:59:38' prior: 50985412!
buildTicketColumn
	
	| column ticketListMorph |
	
	ticketListMorph := PluggableListMorph model: self model listTicket listGetter: nil indexGetter: nil indexSetter: nil.
	ticketListMorph borderColor: Color skyBlue; borderWidth: 1; morphWidth:300.

	column := LayoutMorph newColumn.
	column separation: 5; 
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents: 'Ticket');
	addMorph: ticketListMorph.
	
	^ column
	! !
!TusLibrosWindow methodsFor: 'catalog - layouts' stamp: 'JD 11/27/2021 13:32:19'!
buildLogOutAndContinueBuyingButtons

	| buttonsLayoutMorph logOutButtonMorph continueBuyingButtonMorph |

	logOutButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #logOut label: 'Log Out'.
	
	continueBuyingButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #continueBuying label: 'Continue Buying'.
	
	buttonsLayoutMorph := LayoutMorph newRow.
	buttonsLayoutMorph separation: 5;
	axisEdgeWeight: 0.5;
	addMorph: logOutButtonMorph;
	addMorph: continueBuyingButtonMorph.
	
	^ buttonsLayoutMorph! !
!TusLibrosWindow methodsFor: 'windows morphs build' stamp: 'JD 11/27/2021 13:34:00'!
buildMorphicTicketWindow
		
	self layoutMorph beColumn;
	separation: 10;
	axisEdgeWeight: 0;
	addMorph: self buildTicketColumn;
	addMorph: self buildLogOutAndContinueBuyingButtons.! !
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/27/2021 13:34:16' prior: 50985395!
redirectToTicketWindow
	
	self model: (TusLibrosTicketWindowModel newFor: self model listCart authenticating: 	self model username with: self model password).
	self setLabel: 'Checkout Completed'.
	self layoutMorph submorphs do: [:aSubmorph | aSubmorph dismissMorph].
	self buildMorphicTicketWindow.

	self model when: #loggedOut send: #redirectToLogin to: self.
	self model when: #newCartRequested send: #createNewCartAndRedirectToCatalog to: self! !
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/27/2021 13:34:44' prior: 50985335!
redirectToCatalogWindowWith: aCartId
	
	self halt.
	self model: (TusLibrosCatalogWindowModel newFor: aCartId authenticating: self model usernameText with: self model passwordText).
	self setLabel: 'Catalog'.
	self layoutMorph submorphs do: [:aSubmorph | aSubmorph dismissMorph].
	self buildMorphicCatalogWindow.

	self model when: #cartModified send: #refreshCartList to: self.
	self model when: #cartCheckouted send: #redirectToTicketWindow to: self! !
!TusLibrosTicketWindowModel class methodsFor: 'no messages' stamp: 'JD 11/27/2021 13:35:38'!
newFor: aCheckoutedCart authenticating: 	aUsername with: aPassword
	
	^ self new initializeFor: aCheckoutedCart authenticating: 	aUsername with: aPassword! !

!classDefinition: #TusLibrosTicketWindowModel category: 'TusLibros-View' stamp: 'JD 11/27/2021 13:36:55'!
Object subclass: #TusLibrosTicketWindowModel
	instanceVariableNames: 'cart'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!

!classDefinition: #TusLibrosTicketWindowModel category: 'TusLibros-View' stamp: 'JD 11/27/2021 13:36:56'!
Object subclass: #TusLibrosTicketWindowModel
	instanceVariableNames: 'cart username'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!

!classDefinition: #TusLibrosTicketWindowModel category: 'TusLibros-View' stamp: 'JD 11/27/2021 13:36:58'!
Object subclass: #TusLibrosTicketWindowModel
	instanceVariableNames: 'cart username password'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!
!TusLibrosTicketWindowModel methodsFor: 'no messages' stamp: 'JD 11/27/2021 13:36:46'!
initializeFor: aCheckoutedCart authenticating: 	aUsername with: aPassword
	
	cart := aCheckoutedCart.
	username := aUsername.
	password := aPassword! !

!classDefinition: #TusLibrosTicketWindowModel category: 'TusLibros-View' stamp: 'JD 11/27/2021 13:38:42'!
Object subclass: #TusLibrosTicketWindowModel
	instanceVariableNames: 'cart username password restInterface'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!
!TusLibrosTicketWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/27/2021 13:38:40'!
presentTicket
	
	| cartAsSet cartPrice catalog presentedCart |

	presentedCart := OrderedCollection new.
	cartPrice := 0.
	catalog := restInterface sendListCatalogRequest.
	cartAsSet := cart asSet sorted.
	cartAsSet do: [:aBook | 
		| bookOccurrences |
		
		bookOccurrences := cart occurrencesOf: aBook.
		presentedCart add: (bookOccurrences asString, ' of ', aBook).
		cartPrice := cartPrice + ((catalog at: aBook) * bookOccurrences)
	].
	presentedCart add: ''.
	presentedCart add: 'Cart Total: ', cartPrice asString, '$'.

	^ presentedCart! !
!TusLibrosTicketWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/27/2021 13:39:05' prior: 50985543!
initializeFor: aCheckoutedCart authenticating: 	aUsername with: aPassword
	
	cart := aCheckoutedCart.
	username := aUsername.
	password := aPassword.
	restInterface := TusLibrosRestInterface new.! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!
!TusLibrosTicketWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/27/2021 13:41:57'!
listTicket
	
	| cartAsSet cartPrice catalog presentedCart |

	presentedCart := OrderedCollection new.
	cartPrice := 0.
	catalog := restInterface sendListCatalogRequest.
	cartAsSet := cart asSet sorted.
	cartAsSet do: [:aBook | 
		| bookOccurrences |
		
		bookOccurrences := cart occurrencesOf: aBook.
		presentedCart add: (bookOccurrences asString, ' of ', aBook).
		cartPrice := cartPrice + ((catalog at: aBook) * bookOccurrences)
	].
	presentedCart add: ''.
	presentedCart add: 'Cart Total: ', cartPrice asString, '$'.

	^ presentedCart! !

!methodRemoval: TusLibrosTicketWindowModel #presentTicket stamp: 'JD 11/27/2021 13:41:57'!
presentTicket
	
	| cartAsSet cartPrice catalog presentedCart |

	presentedCart := OrderedCollection new.
	cartPrice := 0.
	catalog := restInterface sendListCatalogRequest.
	cartAsSet := cart asSet sorted.
	cartAsSet do: [:aBook | 
		| bookOccurrences |
		
		bookOccurrences := cart occurrencesOf: aBook.
		presentedCart add: (bookOccurrences asString, ' of ', aBook).
		cartPrice := cartPrice + ((catalog at: aBook) * bookOccurrences)
	].
	presentedCart add: ''.
	presentedCart add: 'Cart Total: ', cartPrice asString, '$'.

	^ presentedCart!
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/27/2021 13:42:21' prior: 50984087!
checkoutCart

	

	restInterface sendCheckoutOutCartRequestFor: cartId withCreditCardNumber: '11111111111111' expiringOn: '2/2050' ownedBy: 'Juan'.
	
	self triggerEvent: #checkoutedCart! !
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/27/2021 13:42:25' prior: 50985652!
checkoutCart

	restInterface sendCheckoutOutCartRequestFor: cartId withCreditCardNumber: '11111111111111' expiringOn: '2/2050' ownedBy: 'Juan'.
	
	self triggerEvent: #checkoutedCart! !

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/27/2021 13:42:43' prior: 50985492!
redirectToCatalogWindowWith: aCartId

	self model: (TusLibrosCatalogWindowModel newFor: aCartId authenticating: self model usernameText with: self model passwordText).
	self setLabel: 'Catalog'.
	self layoutMorph submorphs do: [:aSubmorph | aSubmorph dismissMorph].
	self buildMorphicCatalogWindow.

	self model when: #cartModified send: #refreshCartList to: self.
	self model when: #cartCheckouted send: #redirectToTicketWindow to: self! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/27/2021 13:43:08' prior: 50985662!
checkoutCart

	restInterface sendCheckoutOutCartRequestFor: cartId withCreditCardNumber: '11111111111111' expiringOn: '2/2050' ownedBy: 'Juan'.
	
	self triggerEvent: #cartCheckouted! !

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.
	!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!
!TusLibrosWindow methodsFor: 'ticket - layouts' stamp: 'JD 11/27/2021 13:46:10' prior: 50985429!
buildTicketColumn
	
	| column ticketListMorph |
	
	ticketListMorph := PluggableListMorph model: self model listTicket listGetter: nil indexGetter: nil indexSetter: nil.
	ticketListMorph borderColor: Color skyBlue; borderWidth: 1; morphWidth:300.

	column := LayoutMorph newColumn.
	column separation: 5; 
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents: 'Ticket');
	addMorph: ticketListMorph;
	addMorph: self buildLogOutAndContinueBuyingButtons.
	
	^ column
	! !
!TusLibrosWindow methodsFor: 'windows morphs build' stamp: 'JD 11/27/2021 13:46:25' prior: 50985465!
buildMorphicTicketWindow
		
	self layoutMorph beColumn;
	separation: 10;
	axisEdgeWeight: 0;
	addMorph: self buildTicketColumn.! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/27/2021 13:49:20' prior: 50985023!
initializeFor: aCartId authenticating: aUsername with: aPassword
	
	cartId := aCartId.
	username := aUsername.
	password := aPassword.
	catalogListIndex := 1.
	cartListIndex := 0.
	itemQuantity := ''.
	restInterface := TusLibrosRestInterface new
! !
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/27/2021 13:49:33' prior: 50985781!
initializeFor: aCartId authenticating: aUsername with: aPassword
	
	cartId := aCartId.
	username := aUsername.
	password := aPassword.
	catalogListIndex := 1.
	cartListIndex := 0.
	itemQuantity := '1'.
	restInterface := TusLibrosRestInterface new
! !
!TusLibrosCatalogWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/27/2021 13:54:06' prior: 50985793!
initializeFor: aCartId authenticating: aUsername with: aPassword
	
	cartId := aCartId.
	username := aUsername.
	password := aPassword.
	catalogListIndex := 1.
	cartListIndex := 0.
	itemQuantity := '0'.
	restInterface := TusLibrosRestInterface new
! !
!TusLibrosTicketWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/27/2021 13:54:40' prior: 50985611!
listTicket
	
	| cartAsSet cartPrice catalog presentedCart |
	
	self halt.
	presentedCart := OrderedCollection new.
	cartPrice := 0.
	catalog := restInterface sendListCatalogRequest.
	cartAsSet := cart asSet sorted.
	cartAsSet do: [:aBook | 
		| bookOccurrences |
		
		bookOccurrences := cart occurrencesOf: aBook.
		presentedCart add: (bookOccurrences asString, ' of ', aBook).
		cartPrice := cartPrice + ((catalog at: aBook) * bookOccurrences)
	].
	presentedCart add: ''.
	presentedCart add: 'Cart Total: ', cartPrice asString, '$'.

	^ presentedCart! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!

self model listTicket!

self model listTicket!
!TusLibrosWindow methodsFor: 'ticket - layouts' stamp: 'JD 11/27/2021 13:58:29' prior: 50985736!
buildTicketColumn
	
	| column ticketListMorph |
	
	ticketListMorph := PluggableListMorph model: self model listGetter: #listTicket indexGetter: nil indexSetter: nil.
	ticketListMorph borderColor: Color skyBlue; borderWidth: 1; morphWidth:300.

	column := LayoutMorph newColumn.
	column separation: 5; 
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents: 'Ticket');
	addMorph: ticketListMorph;
	addMorph: self buildLogOutAndContinueBuyingButtons.
	
	^ column
	! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

----SNAPSHOT----(27 November 2021 13:58:48) CuisUniversity-4972.image priorSource: 20917647!
!TusLibrosTicketWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/27/2021 14:01:25'!
logOut
	
	self triggerEvent: #loggedOut! !
!TusLibrosTicketWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/27/2021 14:01:49'!
newCartRequested
	
	self triggerEvent: #newCartRequested! !
!TusLibrosTicketWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/27/2021 14:02:35'!
continueBuying
	
	self triggerEvent: #newCartRequested! !
!TusLibrosTicketWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/27/2021 14:02:35' prior: 50985891!
continueBuying
	
	self triggerEvent: #continueBuying! !

!methodRemoval: TusLibrosTicketWindowModel #newCartRequested stamp: 'JD 11/27/2021 14:02:35'!
newCartRequested
	
	self triggerEvent: #newCartRequested!
!TusLibrosTicketWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/27/2021 14:02:52' prior: 50985897!
continueBuying
	
	self triggerEvent: #newCartRequested! !
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/27/2021 14:06:03'!
redirectToLogin
	
	self initializeWithTitle: 'TusLibros Login'! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!
!TusLibrosTicketWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/27/2021 14:06:57' prior: 50985817!
listTicket
	
	| cartAsSet cartPrice catalog presentedCart |

	presentedCart := OrderedCollection new.
	cartPrice := 0.
	catalog := restInterface sendListCatalogRequest.
	cartAsSet := cart asSet sorted.
	cartAsSet do: [:aBook | 
		| bookOccurrences |
		
		bookOccurrences := cart occurrencesOf: aBook.
		presentedCart add: (bookOccurrences asString, ' of ', aBook).
		cartPrice := cartPrice + ((catalog at: aBook) * bookOccurrences)
	].
	presentedCart add: ''.
	presentedCart add: 'Cart Total: ', cartPrice asString, '$'.

	^ presentedCart! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/27/2021 14:07:40' prior: 50985912!
redirectToLogin
	
	self layoutMorph submorphs do: [:aSubmorph | aSubmorph dismissMorph].
	self initializeWithTitle: 'TusLibros Login'! !

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!
!TusLibrosWindow class methodsFor: 'as yet unclassified' stamp: 'JD 11/27/2021 14:09:18' prior: 50981595!
open
	
	^ self new! !
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/27/2021 14:09:45' overrides: 50972279!
initialize
	
	super initialize.
	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: 'Tus Libros Login'.
	self model: (TusLibrosLogInWindowModel new).
	self morphExtent: 1035@485.
	self buildMorphicWindow.
	self openInWorld.
			
	self model when: #newCartCreated send: #redirectToCatalogWindowWith: to: self! !
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/27/2021 14:09:56' prior: 50985960!
redirectToLogin
	
	self layoutMorph submorphs do: [:aSubmorph | aSubmorph dismissMorph].
	self initialize.! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/27/2021 14:12:16' prior: 50984046!
initializeWithTitle: aTitle

	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: aTitle.
	self model: (TusLibrosLogInWindowModel new).
	self morphExtent: 1035@485.
	self buildMorphicWindow.
	self openInWorld.
			
	self model when: #newCartCreated send: #redirectToCatalogWindowWith: to: self! !
!TusLibrosWindow class methodsFor: 'as yet unclassified' stamp: 'JD 11/27/2021 14:12:56' prior: 50985987!
open
	
	^ self new initializeWithTitle: self logInTitle! !
!TusLibrosWindow class methodsFor: 'as yet unclassified' stamp: 'JD 11/27/2021 14:13:03'!
logInTitle
	
	^ 'Tus Libros Login'! !
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/27/2021 14:13:32' prior: 50986005!
redirectToLogin
	
	self layoutMorph submorphs do: [:aSubmorph | aSubmorph dismissMorph].
	self initializeWithTitle: self class logInTitle.! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.
	!

TusLibrosWindow allInstances !

TusLibrosWindow allInstancesDo: [:anInstance | anInstance close]!

TusLibrosWindow allInstancesDo: [:anInstance | anInstance closeBoxHit]!

TusLibrosWindow allInstancesDo: [:anInstance | anInstance delete]!

TusLibrosWindow allInstancesDo: [:anInstance | anInstance delete]!

TusLibrosWindow allInstancesDo: [:anInstance | anInstance initializeWithTitle: 'a']!

TusLibrosWindow allInstancesDo: [:anInstance | anInstance destroy]!

TusLibrosWindow allInstancesDo: [:anInstance | anInstance delete]!

----STARTUP---- (27 November 2021 14:19:53) as /home/juli/Documentos/Facu/Inge1/cuis-university/CuisUniversity-4972.image!


----End fileIn of /home/juli/Documentos/Facu/Inge1/cuis-university/TusLibros-View.st----!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!

!methodRemoval: TusLibrosWindow #initialize stamp: 'JD 11/27/2021 14:20:41'!
initialize
	
	super initialize.
	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: 'Tus Libros Login'.
	self model: (TusLibrosLogInWindowModel new).
	self morphExtent: 1035@485.
	self buildMorphicWindow.
	self openInWorld.
			
	self model when: #newCartCreated send: #redirectToCatalogWindowWith: to: self!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

!classRenamed: #TusLibrosCatalogWindowModel as: #TusLibrosShopWindowModel stamp: 'JD 11/27/2021 14:25:15'!
Smalltalk renameClassNamed: #TusLibrosCatalogWindowModel as: #TusLibrosShopWindowModel!
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/27/2021 14:25:15' prior: 50985925!
redirectToCatalogWindowWith: aCartId

	self model: (TusLibrosShopWindowModel newFor: aCartId authenticating: self model usernameText with: self model passwordText).
	self setLabel: 'Catalog'.
	self layoutMorph submorphs do: [:aSubmorph | aSubmorph dismissMorph].
	self buildMorphicCatalogWindow.

	self model when: #cartModified send: #refreshCartList to: self.
	self model when: #cartCheckouted send: #redirectToTicketWindow to: self! !
!TusLibrosTicketWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/27/2021 14:28:41' prior: 50986670!
continueBuying
	
	| cartId |

	cartId := restInterface sendCreateCartRequestWith: username and: password.
	self triggerEvent: #newCartRequested with: cartId! !
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/27/2021 14:29:00' prior: 50985950!
redirectToTicketWindow
	
	self model: (TusLibrosTicketWindowModel newFor: self model listCart authenticating: 	self model username with: self model password).
	self setLabel: 'Checkout Completed'.
	self layoutMorph submorphs do: [:aSubmorph | aSubmorph dismissMorph].
	self buildMorphicTicketWindow.

	self model when: #loggedOut send: #redirectToLogin to: self.
	self model when: #newCartRequested send: #redirectToCatalogWindowWith: to: self! !
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/27/2021 14:29:13'!
redirectToLoginWindow
	
	self layoutMorph submorphs do: [:aSubmorph | aSubmorph dismissMorph].
	self initializeWithTitle: self class logInTitle.! !

!methodRemoval: TusLibrosWindow #redirectToLogin stamp: 'JD 11/27/2021 14:29:13'!
redirectToLogin
	
	self layoutMorph submorphs do: [:aSubmorph | aSubmorph dismissMorph].
	self initializeWithTitle: self class logInTitle.!
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/27/2021 14:29:24' prior: 50986817!
redirectToTicketWindow
	
	self model: (TusLibrosTicketWindowModel newFor: self model listCart authenticating: 	self model username with: self model password).
	self setLabel: 'Checkout Completed'.
	self layoutMorph submorphs do: [:aSubmorph | aSubmorph dismissMorph].
	self buildMorphicTicketWindow.

	self model when: #loggedOut send: #redirectToLoginWindow to: self.
	self model when: #newCartRequested send: #redirectToCatalogWindowWith: to: self! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!
!TusLibrosTicketWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/27/2021 14:32:19'!
usernameText
	
	^ username! !
!TusLibrosTicketWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/27/2021 14:32:43'!
passwordText
	
	^ password! !
!TusLibrosShopWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/27/2021 14:33:03'!
usernameText
	
	^ username! !
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/27/2021 14:33:03' prior: 50986849!
redirectToTicketWindow
	
	self model: (TusLibrosTicketWindowModel newFor: self model listCart authenticating: 	self model usernameText with: self model password).
	self setLabel: 'Checkout Completed'.
	self layoutMorph submorphs do: [:aSubmorph | aSubmorph dismissMorph].
	self buildMorphicTicketWindow.

	self model when: #loggedOut send: #redirectToLoginWindow to: self.
	self model when: #newCartRequested send: #redirectToCatalogWindowWith: to: self! !

!methodRemoval: TusLibrosShopWindowModel #username stamp: 'JD 11/27/2021 14:33:03'!
username
	
	^ username!
!TusLibrosShopWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/27/2021 14:33:12'!
passwordText
	
	^ password! !
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/27/2021 14:33:12' prior: 50986900!
redirectToTicketWindow
	
	self model: (TusLibrosTicketWindowModel newFor: self model listCart authenticating: 	self model usernameText with: self model passwordText).
	self setLabel: 'Checkout Completed'.
	self layoutMorph submorphs do: [:aSubmorph | aSubmorph dismissMorph].
	self buildMorphicTicketWindow.

	self model when: #loggedOut send: #redirectToLoginWindow to: self.
	self model when: #newCartRequested send: #redirectToCatalogWindowWith: to: self! !

!methodRemoval: TusLibrosShopWindowModel #password stamp: 'JD 11/27/2021 14:33:12'!
password
	
	^ password!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

----SNAPSHOT----(27 November 2021 14:35:27) CuisUniversity-4972.image priorSource: 20935257!
!TusLibrosShopWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/27/2021 14:38:09' prior: 50986394!
showPurchases

	| purchases catalog totalSpent|
	
	self halt.
	catalog := restInterface sendListCatalogRequest.
	purchases := restInterface sendListPurchasesRequestFor: username authenticatingWith: password.
	Transcript clear.
	totalSpent := 0.
	Transcript show: 'Book', '-', 'Quantity'.
	Transcript newLine.
	purchases keysDo: [:aBook | 
		| bookQuantity bookPrice |
		bookQuantity := purchases at: aBook.
		bookPrice := catalog at: aBook.
		totalSpent := totalSpent + bookPrice.
		Transcript show: aBook, '-', bookQuantity asString.
		Transcript newLine.
	].
	Transcript show: 'Total: ', totalSpent asString, '$'.
	TranscriptWindow openTranscript.
! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.
	!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!
!TusLibrosShopWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/27/2021 14:40:22' prior: 50986971!
showPurchases

	| purchases catalog totalSpent|
	
	self halt.
	catalog := restInterface sendListCatalogRequest.
	purchases := restInterface sendListPurchasesRequestFor: username authenticatingWith: password.
	Transcript clear.
	totalSpent := 0.
	Transcript show: 'Book', '-', 'Quantity'.
	Transcript newLine.
	purchases keysDo: [:aBook | 
		| bookQuantity bookPrice |
		bookPrice := catalog at: aBook.
		bookQuantity := (purchases at: aBook) / bookPrice.
		totalSpent := totalSpent + bookPrice.
		Transcript show: aBook, '-', bookQuantity asString.
		Transcript newLine.
	].
	Transcript show: 'Total: ', totalSpent asString, '$'.
	TranscriptWindow openTranscript.
! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!

----SNAPSHOT----(27 November 2021 14:41:06) CuisUniversity-4972.image priorSource: 20970129!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!
!TusLibrosShopWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/27/2021 20:10:48' prior: 50987016!
showPurchases

	| purchases catalog totalSpent|

	catalog := restInterface sendListCatalogRequest.
	purchases := restInterface sendListPurchasesRequestFor: username authenticatingWith: password.
	Transcript clear.
	totalSpent := 0.
	Transcript show: 'Book', '-', 'Quantity'.
	Transcript newLine.
	purchases keysDo: [:aBook | 
		| bookQuantity bookPrice |
		bookPrice := catalog at: aBook.
		bookQuantity := (purchases at: aBook) / bookPrice.
		totalSpent := totalSpent + bookPrice.
		Transcript show: aBook, '-', bookQuantity asString.
		Transcript newLine.
	].
	Transcript show: 'Total: ', totalSpent asString, '$'.
	TranscriptWindow openTranscript.
! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!
!TusLibrosServer methodsFor: 'services' stamp: 'JD 11/27/2021 20:19:58'!
addServiceAt: aServiceUrl doing: anAction

	webServer addService: aServiceUrl action: anAction.
	
	! !
!TusLibrosServer methodsFor: 'services' stamp: 'JD 11/27/2021 20:33:16'!
responseOnErrorTo: aRequest
	
	^ [:anError | aRequest send400Response: (anError messageText) ]
	
	! !
!TusLibrosServer methodsFor: 'services' stamp: 'JD 11/27/2021 20:33:29' prior: 50987109!
responseOnErrorTo: aRequest
	
	^ [:anError | aRequest send400Response: (anError messageText)]
	
	! !
!TusLibrosServer methodsFor: 'services' stamp: 'JD 11/27/2021 20:33:45' prior: 50963594!
addListCatalogService

	webServer addService: '/list-catalog' action:[:request | | catalogAsJson |
		
		[
			catalogAsJson := WebUtils jsonEncode: (tusLibrosSystemFacade 
			listCatalog).
			request send200Response: (catalogAsJson)
		 ] 
		on: Error 
		do: (self responseOnErrorTo: request)].
	
	! !
!TusLibrosServer methodsFor: 'services' stamp: 'JD 11/27/2021 20:33:56' prior: 50965088!
addListPurchasesService

	webServer addService: '/list-purchases' action:[:request | | user password purchasesList purchasesListAsJson |
		
		[	
			user := (request fields at: 'user').
			password := (request fields at: 'password').
			purchasesList := tusLibrosSystemFacade listPurchasesOf: user  authenticatingWith: password.
			purchasesListAsJson := WebUtils jsonEncode: purchasesList.
			request send200Response: purchasesListAsJson
		 ] 
		on: Error 
		do: (self responseOnErrorTo: request)].
	
	! !
!TusLibrosServer methodsFor: 'services' stamp: 'JD 11/27/2021 20:34:02' prior: 50967520!
addRemoveFromCartService

	webServer addService: '/remove-from-cart' action:[:request | | book cartId |
		
		[
			book := (request fields at: 'book').
			cartId := (request fields at: 'cartId') asNumber.
			tusLibrosSystemFacade remove: book fromCart: cartId.
			request send200Response: 'OK'
		 ] 
		on: Error 
		do: (self responseOnErrorTo: request)].
	
	! !
!TusLibrosServer methodsFor: 'services' stamp: 'JD 11/27/2021 20:34:11' prior: 50964195!
addAddToCartService

	webServer addService: '/add-to-cart' action:[:request | | bookAmount book cartId |
		
		[
			bookAmount := (request fields at: 'bookAmount') asNumber.
			book := (request fields at: 'book').
			cartId := (request fields at: 'cartId') asNumber.
			tusLibrosSystemFacade add: bookAmount of: book toCartIdentifiedAs: cartId.
			request send200Response: (WebUtils jsonEncode: 'Book added correctly')
		 ] 
		on: Error 
		do: (self responseOnErrorTo: request)].
	
	! !
!TusLibrosServer methodsFor: 'services' stamp: 'JD 11/27/2021 20:34:16' prior: 50984204!
addCheckoutCartService

	webServer addService: '/checkout-cart' action:[:request | | cartId cardNumber cardExpirationDate cardOwner |
		
		[	
			cartId := (request fields at: 'cartId') asNumber.
			cardNumber := (request fields at: 'ccn') asNumber.
			cardExpirationDate := Month readFrom: (ReadStream on: (request fields at: 'cced')).
			cardOwner := request fields at: 'cco'.
			tusLibrosSystemFacade checkOutCartIdentifiedAs: cartId withCreditCardNumbered: cardNumber ownedBy: cardOwner expiringOn: cardExpirationDate.
			request send200Response: 'OK'
		 ] 
		on: Error 
		do: (self responseOnErrorTo: request)].
	
	! !
!TusLibrosServer methodsFor: 'services' stamp: 'JD 11/27/2021 20:34:20' prior: 50964060!
addCreateCartService

	webServer addService: '/create-cart' action:[:request | | user password cartId cartIdAsJson |
		
		[
			user := (request fields at: 'user').
			password := (request fields at: 'password').
			cartId := tusLibrosSystemFacade createCartFor: user authenticatedWith: password.
			cartIdAsJson := WebUtils jsonEncode: (cartId).
			request send200Response: (cartIdAsJson)
		 ] 
		on: Error 
		do: (self responseOnErrorTo: request)].
	
	! !
!TusLibrosServer methodsFor: 'services' stamp: 'JD 11/27/2021 20:34:25' prior: 50964977!
addListCartService

	 webServer addService: '/list-cart' action:[:request | | cartId cartContent cartContentAsJson |

		  [
			   cartId := (request fields at: 'cartId') asNumber.	
			   cartContent := tusLibrosSystemFacade listCartIdentifiedAs: cartId.
			   cartContentAsJson := WebUtils jsonEncode: cartContent asArray.
			   request send200Response: (cartContentAsJson)
		   ]
		  on: Error
		  do: (self responseOnErrorTo: request)].
	
	! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!
!TusLibrosServer methodsFor: 'services' stamp: 'JD 11/27/2021 20:59:33'!
serviceActionDoingOnRequest: aSpecificServiceAction
	[:request | 
		[aSpecificServiceAction value: request] 
			on: Error
			do: (self responseOnErrorTo: request)
	]
	! !
!TusLibrosServer methodsFor: 'services' stamp: 'JD 11/27/2021 21:02:15' prior: 50987209!
addCreateCartService

	webServer 
		addService: '/create-cart' 
		action: 
			(self serviceActionDoingOnRequest: 
		
				[:aRequest |
					| user password cartId cartIdAsJson |
				
					user := (aRequest fields at: 'user').
					password := (aRequest fields at: 'password').
					cartId := tusLibrosSystemFacade createCartFor: user authenticatedWith: password.
					cartIdAsJson := WebUtils jsonEncode: (cartId).
					aRequest send200Response: (cartIdAsJson)
				 ])
	
	! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!
!TusLibrosServer methodsFor: 'services' stamp: 'JD 11/27/2021 21:06:13' prior: 50987264!
serviceActionDoingOnRequest: aSpecificServiceAction
	[:request | 
		[^ aSpecificServiceAction value: request] 
			on: Error
			do: (self responseOnErrorTo: request)
	]
	! !
!TusLibrosServer methodsFor: 'services' stamp: 'JD 11/27/2021 21:06:14' prior: 50987273!
addCreateCartService

	webServer 
		addService: '/create-cart' 
		action: 
			(self serviceActionDoingOnRequest: 
		
				[:aRequest |
					| user password cartId cartIdAsJson |
				
					user := (aRequest fields at: 'user').
					password := (aRequest fields at: 'password').
					cartId := tusLibrosSystemFacade createCartFor: user authenticatedWith: password.
					cartIdAsJson := WebUtils jsonEncode: (cartId).
					^ aRequest send200Response: (cartIdAsJson)
				 ])
	
	! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!
!TusLibrosServer methodsFor: 'services' stamp: 'JD 11/27/2021 21:07:48' prior: 50987310!
serviceActionDoingOnRequest: aSpecificServiceAction
	[:request | 
		[aSpecificServiceAction value: request] 
			on: Error
			do: (self responseOnErrorTo: request)
	]
	! !
!TusLibrosServer methodsFor: 'services' stamp: 'JD 11/27/2021 21:07:51' prior: 50987319!
addCreateCartService

	webServer 
		addService: '/create-cart' 
		action: 
			(self serviceActionDoingOnRequest: 
		
				[:aRequest |
					| user password cartId cartIdAsJson |
				
					user := (aRequest fields at: 'user').
					password := (aRequest fields at: 'password').
					cartId := tusLibrosSystemFacade createCartFor: user authenticatedWith: password.
					cartIdAsJson := WebUtils jsonEncode: (cartId).
					aRequest send200Response: (cartIdAsJson)
				 ])
	
	! !
!TusLibrosServer methodsFor: 'services' stamp: 'JD 11/27/2021 21:09:51' prior: 50987367!
addCreateCartService
	
	self halt.
	webServer 
		addService: '/create-cart' 
		action: 
			(self serviceActionDoingOnRequest: 
		
				[:aRequest |
					| user password cartId cartIdAsJson |
				
					user := (aRequest fields at: 'user').
					password := (aRequest fields at: 'password').
					cartId := tusLibrosSystemFacade createCartFor: user authenticatedWith: password.
					cartIdAsJson := WebUtils jsonEncode: (cartId).
					aRequest send200Response: (cartIdAsJson)
				 ])
	
	! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!

(self serviceActionDoingOnRequest: 
		
				[:aRequest |
					| user password cartId cartIdAsJson |
				
					user := (aRequest fields at: 'user').
					password := (aRequest fields at: 'password').
					cartId := tusLibrosSystemFacade createCartFor: user authenticatedWith: password.
					cartIdAsJson := WebUtils jsonEncode: (cartId).
					aRequest send200Response: (cartIdAsJson)
				 ])!

self serviceActionDoingOnRequest: 
		
				[:aRequest |
					| user password cartId cartIdAsJson |
				
					user := (aRequest fields at: 'user').
					password := (aRequest fields at: 'password').
					cartId := tusLibrosSystemFacade createCartFor: user authenticatedWith: password.
					cartIdAsJson := WebUtils jsonEncode: (cartId).
					aRequest send200Response: (cartIdAsJson)
				 ]!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!
!TusLibrosServer methodsFor: 'services' stamp: 'JD 11/27/2021 21:11:35' prior: 50987358!
serviceActionDoingOnRequest: aSpecificServiceAction
	
	^ [:request | 
		[aSpecificServiceAction value: request] 
			on: Error
			do: (self responseOnErrorTo: request)
	   ]
	! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!
!TusLibrosServer methodsFor: 'services' stamp: 'JD 11/27/2021 21:12:03' prior: 50987472!
serviceActionDoingOnRequest: aSpecificServiceAction
	
	^ [:request | 
		[aSpecificServiceAction value: request] 
			on: Error
			do: (self responseOnErrorTo: request)
	   ]! !
!TusLibrosServer methodsFor: 'services' stamp: 'JD 11/27/2021 21:38:14' prior: 50987502!
serviceActionDoingOnRequest: aSpecificServiceAction
	
	^ [:request | 
		[
			| responseContent |
			
			responseContent := aSpecificServiceAction value: request.
			request send200Response: responseContent
		] 
			on: Error
			do: (self responseOnErrorTo: request)
	   ]! !
!TusLibrosServer methodsFor: 'services' stamp: 'JD 11/27/2021 21:38:35' prior: 50987385!
addCreateCartService
	
	self halt.
	webServer 
		addService: '/create-cart' 
		action: 
			(self serviceActionDoingOnRequest: 
		
				[:aRequest |
					| user password cartId |
				
					user := (aRequest fields at: 'user').
					password := (aRequest fields at: 'password').
					cartId := tusLibrosSystemFacade createCartFor: user authenticatedWith: password.
					^ WebUtils jsonEncode: cartId
				 ])
	
	! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!
!TusLibrosServer methodsFor: 'services' stamp: 'JD 11/27/2021 21:38:44' prior: 50987523!
addCreateCartService

	webServer 
		addService: '/create-cart' 
		action: 
			(self serviceActionDoingOnRequest: 
		
				[:aRequest |
					| user password cartId |
				
					user := (aRequest fields at: 'user').
					password := (aRequest fields at: 'password').
					cartId := tusLibrosSystemFacade createCartFor: user authenticatedWith: password.
					^ WebUtils jsonEncode: cartId
				 ])
	
	! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!
!TusLibrosServer methodsFor: 'services' stamp: 'JD 11/27/2021 21:46:18' prior: 50987558!
addCreateCartService

	webServer 
		addService: '/create-cart' 
		action: 
			(self serviceActionDoingOnRequest: 
		
				[:aRequest |
					| user password cartId |
					self halt.
					user := (aRequest fields at: 'user').
					password := (aRequest fields at: 'password').
					cartId := tusLibrosSystemFacade createCartFor: user authenticatedWith: password.
					^ WebUtils jsonEncode: cartId
				 ])
	
	! !
!TusLibrosServer methodsFor: 'services' stamp: 'JD 11/27/2021 21:46:25' prior: 50987511!
serviceActionDoingOnRequest: aSpecificServiceAction
	
	^ [:request | 
		[
			| responseContent |
			self halt.
			responseContent := aSpecificServiceAction value: request.
			request send200Response: responseContent
		] 
			on: Error
			do: (self responseOnErrorTo: request)
	   ]! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!

WebUtils jsonEncode: cartId!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!
!TusLibrosServer methodsFor: 'services' stamp: 'JD 11/27/2021 21:53:00' prior: 50987576!
addCreateCartService

	webServer 
		addService: '/create-cart' 
		action: 
			(self serviceActionDoingOnRequest: 
		
				[:aRequest |
					| user password cartId |

					user := (aRequest fields at: 'user').
					password := (aRequest fields at: 'password').
					cartId := tusLibrosSystemFacade createCartFor: user authenticatedWith: password.
					^ WebUtils jsonEncode: cartId
				 ])
	
	! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.
	!

aSpecificServiceAction value: request!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!
!TusLibrosServer methodsFor: 'services' stamp: 'JD 11/27/2021 21:55:42' prior: 50987626!
addCreateCartService

	webServer 
		addService: '/create-cart' 
		action: 
			(self serviceActionDoingOnRequest: 
		
				[:aRequest |
					| user password cartId |

					user := (aRequest fields at: 'user').
					password := (aRequest fields at: 'password').
					cartId := tusLibrosSystemFacade createCartFor: user authenticatedWith: password.
					WebUtils jsonEncode: cartId
				 ])
	
	! !
!TusLibrosServer methodsFor: 'services' stamp: 'JD 11/27/2021 21:55:54' prior: 50987664!
addCreateCartService

	webServer 
		addService: '/create-cart' 
		action: 
			(self serviceActionDoingOnRequest: 
		
				[:aRequest |
					| user password cartId |
					user := (aRequest fields at: 'user').
					password := (aRequest fields at: 'password').
					cartId := tusLibrosSystemFacade createCartFor: user authenticatedWith: password.
					WebUtils jsonEncode: cartId
				 ])
	
	! !
!TusLibrosServer methodsFor: 'services' stamp: 'JD 11/27/2021 21:55:55' prior: 50987592!
serviceActionDoingOnRequest: aSpecificServiceAction
	
	^ [:request | 
		[
			| responseContent |
			responseContent := aSpecificServiceAction value: request.
			request send200Response: responseContent
		] 
			on: Error
			do: (self responseOnErrorTo: request)
	   ]! !

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.
	!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!
!TusLibrosServer methodsFor: 'services' stamp: 'JD 11/27/2021 21:58:19' prior: 50987680!
addCreateCartService

	webServer 
		addService: '/create-cart' 
		action: 
			(self serviceActionDoingOnRequest: 
		
				[:request |
					| user password cartId |
					user := (request fields at: 'user').
					password := (request fields at: 'password').
					cartId := tusLibrosSystemFacade createCartFor: user authenticatedWith: password.
					WebUtils jsonEncode: cartId
				 ])
	
	! !
!TusLibrosServer methodsFor: 'services' stamp: 'JD 11/27/2021 22:00:25' prior: 50987726!
addCreateCartService

	webServer 
		addService: '/create-cart' 
		action: 
			(
				self serviceActionDoingOnRequest: 
			
					[:request |
						| user password cartId |
						user := (request fields at: 'user').
						password := (request fields at: 'password').
						cartId := tusLibrosSystemFacade createCartFor: user authenticatedWith: password.
						WebUtils jsonEncode: cartId
				 ]
			)
	
	! !
!TusLibrosServer methodsFor: 'services' stamp: 'JD 11/27/2021 22:00:35' prior: 50987168!
addAddToCartService

	webServer 
		addService: '/add-to-cart' 
		action: 
			(
				self serviceActionDoingOnRequest: 
					[:request | 
						| bookAmount book cartId |
						bookAmount := (request fields at: 'bookAmount') asNumber.
						book := (request fields at: 'book').
						cartId := (request fields at: 'cartId') asNumber.
						tusLibrosSystemFacade add: bookAmount of: book toCartIdentifiedAs: cartId.
						WebUtils jsonEncode: 'Book added correctly'
			 	]
			)
	
	! !
!TusLibrosServer methodsFor: 'services' stamp: 'JD 11/27/2021 22:01:08' prior: 50987741!
addCreateCartService

	webServer 
		addService: '/create-cart' 
		action: 
			(self serviceActionDoingOnRequest: 
		
				[:request |
					| user password cartId |
					user := (request fields at: 'user').
					password := (request fields at: 'password').
					cartId := tusLibrosSystemFacade createCartFor: user authenticatedWith: password.
					WebUtils jsonEncode: cartId
				 ]
			)
	
	! !
!TusLibrosServer methodsFor: 'services' stamp: 'JD 11/27/2021 22:01:12' prior: 50987757!
addAddToCartService

	webServer 
		addService: '/add-to-cart' 
		action: 
			(self serviceActionDoingOnRequest: 
				[:request | 
					| bookAmount book cartId |
					bookAmount := (request fields at: 'bookAmount') asNumber.
					book := (request fields at: 'book').
					cartId := (request fields at: 'cartId') asNumber.
					tusLibrosSystemFacade add: bookAmount of: book toCartIdentifiedAs: cartId.
					WebUtils jsonEncode: 'Book added correctly'
			 	]
			)
	
	! !
!TusLibrosServer methodsFor: 'services' stamp: 'JD 11/27/2021 22:01:20' prior: 50987775!
addCreateCartService

	webServer 
		addService: '/create-cart' 
		action: 
			(self serviceActionDoingOnRequest:
				[:request |
					| user password cartId |
					user := (request fields at: 'user').
					password := (request fields at: 'password').
					cartId := tusLibrosSystemFacade createCartFor: user authenticatedWith: password.
					WebUtils jsonEncode: cartId
				 ]
			)
	
	! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!
!TusLibrosServer methodsFor: 'services' stamp: 'JD 11/27/2021 22:03:53' prior: 50987186!
addCheckoutCartService

	webServer 
		addService: '/checkout-cart' 
		action:
			(self serviceActionDoingOnRequest: 
				[:request | 
					| cartId cardNumber cardExpirationDate cardOwner |
					cartId := (request fields at: 'cartId') asNumber.
					cardNumber := (request fields at: 'ccn') asNumber.
					cardExpirationDate := Month readFrom: (ReadStream on: (request fields at: 'cced')).
					cardOwner := request fields at: 'cco'.
					tusLibrosSystemFacade checkOutCartIdentifiedAs: cartId withCreditCardNumbered: cardNumber ownedBy: cardOwner expiringOn: cardExpirationDate.
					'Checkout was successfull'
				]
			) 
	! !
!TusLibrosServer methodsFor: 'services' stamp: 'JD 11/27/2021 22:06:19' prior: 50987227!
addListCartService

	 webServer 
		addService: '/list-cart' 
		action:
			(self serviceActionDoingOnRequest:
				[:request | 
					| cartId cartContent |
					cartId := (request fields at: 'cartId') asNumber.	
				   	cartContent := tusLibrosSystemFacade listCartIdentifiedAs: cartId.
				   	WebUtils jsonEncode: cartContent asArray.
				]
			)
	
	! !
!TusLibrosServer methodsFor: 'services' stamp: 'JD 11/27/2021 22:07:48' prior: 50987809!
addCreateCartService

	webServer 
		addService: '/create-cart' 
		action: 
			(self serviceActionDoingOnRequest:
				[:request |
					| user password cartId |
					user := (request fields at: 'user').
					password := (request fields at: 'password').
					cartId := tusLibrosSystemFacade createCartFor: user authenticatedWith: password.
					WebUtils jsonEncode: cartId
				]
			)
	
	! !
!TusLibrosServer methodsFor: 'services' stamp: 'JD 11/27/2021 22:07:54' prior: 50987121!
addListCatalogService

	webServer 
		addService: '/list-catalog' 
		action:
			(self serviceActionDoingOnRequest:
					[:request |
						WebUtils jsonEncode: (tusLibrosSystemFacade 
						listCatalog)
					]
			)
	
	! !
!TusLibrosServer methodsFor: 'services' stamp: 'JD 11/27/2021 22:08:58' prior: 50987134!
addListPurchasesService

	webServer 
		addService: '/list-purchases' 
		action:
			(self serviceActionDoingOnRequest: 
					[:request | 
						| user password purchasesList |
						user := (request fields at: 'user').
						password := (request fields at: 'password').
						purchasesList := tusLibrosSystemFacade listPurchasesOf: user  authenticatingWith: password.
						WebUtils jsonEncode: purchasesList
					]
			)
	
	! !
!TusLibrosServer methodsFor: 'services' stamp: 'JD 11/27/2021 22:10:15' prior: 50987153!
addRemoveFromCartService

	webServer 
		addService: '/remove-from-cart' 
		action:
			(self serviceActionDoingOnRequest:
					[:request | 
						| book cartId |
						book := (request fields at: 'book').
						cartId := (request fields at: 'cartId') asNumber.
						tusLibrosSystemFacade remove: book fromCart: cartId.
						'Item removed successfully'
					] 
			)
	
	! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!
!TusLibrosShopWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/27/2021 22:11:51' prior: 50986310!
initializeFor: aCartId authenticating: aUsername with: aPassword
	
	cartId := aCartId.
	username := aUsername.
	password := aPassword.
	catalogListIndex := 1.
	cartListIndex := 0.
	itemQuantity := '1'.
	restInterface := TusLibrosRestInterface new
! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!
!TusLibrosShopWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/27/2021 22:12:45' prior: 50987979!
initializeFor: aCartId authenticating: aUsername with: aPassword
	
	cartId := aCartId.
	username := aUsername.
	password := aPassword.
	catalogListIndex := 1.
	cartListIndex := 1.
	itemQuantity := '1'.
	restInterface := TusLibrosRestInterface new
! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| userAndPassword catalog |

	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: '2'.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!

!methodRemoval: TusLibrosServer #addServiceAt:doing: stamp: 'JD 11/27/2021 22:14:03'!
addServiceAt: aServiceUrl doing: anAction

	webServer addService: aServiceUrl action: anAction.
	
	!
!TusLibrosServer methodsFor: 'services' stamp: 'JD 11/27/2021 22:14:22' prior: 50987897!
addListCatalogService

	webServer 
		addService: '/list-catalog' 
		action:
			(self serviceActionDoingOnRequest:
				[:request |
					WebUtils jsonEncode: (tusLibrosSystemFacade 
					listCatalog)
				]
			)
	
	! !
!TusLibrosServer methodsFor: 'services' stamp: 'JD 11/27/2021 22:14:28' prior: 50987907!
addListPurchasesService

	webServer 
		addService: '/list-purchases' 
		action:
			(self serviceActionDoingOnRequest: 
				[:request | 
					| user password purchasesList |
					user := (request fields at: 'user').
					password := (request fields at: 'password').
					purchasesList := tusLibrosSystemFacade listPurchasesOf: user  authenticatingWith: password.
					WebUtils jsonEncode: purchasesList
				]
			)
	
	! !
!TusLibrosServer methodsFor: 'services' stamp: 'JD 11/27/2021 22:14:33' prior: 50987924!
addRemoveFromCartService

	webServer 
		addService: '/remove-from-cart' 
		action:
			(self serviceActionDoingOnRequest:
				[:request | 
					| book cartId |
					book := (request fields at: 'book').
					cartId := (request fields at: 'cartId') asNumber.
					tusLibrosSystemFacade remove: book fromCart: cartId.
					'Item removed successfully'
				] 
			)
	
	! !

----SNAPSHOT----(27 November 2021 22:17:34) CuisUniversity-4972.image priorSource: 20973035!
!TusLibrosLogInWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/27/2021 22:26:19' prior: 50986467!
passwordText: aUserPassword
	
	| aHash256Algorithm |

	aHash256Algorithm := SecureHashAlgorithm256 initialize.
	password := aHash256Algorithm hashMessage: aUserPassword.
	^ true! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| aHash256Algorithm userAndPassword catalog |
	
	aHash256Algorithm := SecureHashAlgorithm256 initialize.
	
	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: (aHash256Algorithm hashMessage: '2').
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!
!TusLibrosLogInWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/27/2021 22:26:44' prior: 50988088!
passwordText: aUserPassword
	
	| aHash256Algorithm |

	aHash256Algorithm := SecureHashAlgorithm256 new.
	password := aHash256Algorithm hashMessage: aUserPassword.
	^ true! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| aHash256Algorithm userAndPassword catalog |
	
	aHash256Algorithm := SecureHashAlgorithm256 new.
	
	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: (aHash256Algorithm hashMessage: '2').
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!

!classDefinition: #TusLibrosLogInWindowModel category: 'TusLibros-View' stamp: 'JD 11/27/2021 22:28:11'!
Object subclass: #TusLibrosLogInWindowModel
	instanceVariableNames: 'username password restInterface passwordHash'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!
!TusLibrosLogInWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/27/2021 22:28:09' prior: 50988120!
passwordText: aUserPassword
	
	| aHash256Algorithm |

	aHash256Algorithm := SecureHashAlgorithm256 new.
	passwordHash := aHash256Algorithm hashMessage: aUserPassword.
	password := aUserPassword.
	^ true! !
!TusLibrosLogInWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/27/2021 22:28:25' prior: 50986473!
sendCreateCartRequest
	
	| cartId |
	
	cartId := restInterface sendCreateCartRequestWith: username and: passwordHash.
	
	self triggerEvent: #newCartCreated with: cartId
	! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| aHash256Algorithm userAndPassword catalog |
	
	aHash256Algorithm := SecureHashAlgorithm256 new.
	
	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: (aHash256Algorithm hashMessage: '2').
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!
!TusLibrosLogInWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/27/2021 22:29:47' prior: 50988160!
passwordText: aUserPassword
	
	| aHash256Algorithm |

	aHash256Algorithm := SecureHashAlgorithm256 new.
	passwordHash := aHash256Algorithm hashMessage: aUserPassword asString.
	password := aUserPassword.
	^ true! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| aHash256Algorithm userAndPassword catalog |
	
	aHash256Algorithm := SecureHashAlgorithm256 new.
	
	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: (aHash256Algorithm hashMessage: '2').
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!

'2' = 2 asString!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| aHash256Algorithm userAndPassword catalog |
	
	aHash256Algorithm := SecureHashAlgorithm256 new.
	
	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: (aHash256Algorithm hashMessage: 2 asString).
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!

(aHash256Algorithm hashMessage: 2 asString)!

SecureHashAlgorithm256 new hashMessage: '2'.!

SecureHashAlgorithm256 new hashMessage: 2 asString.!
!TusLibrosLogInWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/27/2021 22:33:37' prior: 50988201!
passwordText: aUserPassword
	
	| aHash256Algorithm |

	aHash256Algorithm := SecureHashAlgorithm256 new.
	passwordHash := (aHash256Algorithm hashMessage: aUserPassword asString) asString.
	password := aUserPassword.
	^ true! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| aHash256Algorithm userAndPassword catalog |
	
	aHash256Algorithm := SecureHashAlgorithm256 new.
	
	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: (aHash256Algorithm hashMessage: 2 asString).
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| aHash256Algorithm userAndPassword catalog |
	
	aHash256Algorithm := SecureHashAlgorithm256 new.
	
	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: (aHash256Algorithm hashMessage: 2 asString) asString.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!
!TusLibrosLogInWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/27/2021 22:34:49' prior: 50988261!
passwordText: aUserPassword
	
	| aHash256Algorithm |

	aHash256Algorithm := SecureHashAlgorithm256 new.
	passwordHash := aHash256Algorithm hashMessage: aUserPassword asString.
	password := aUserPassword.
	^ true! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| aHash256Algorithm userAndPassword catalog |
	
	aHash256Algorithm := SecureHashAlgorithm256 new.
	
	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: (aHash256Algorithm hashMessage: 2 asString) asString.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!
!TusLibrosLogInWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/27/2021 23:26:06' prior: 50988318!
passwordText: aUserPassword

	password := aUserPassword.
	^ true! !

Object subclass: #TusLibrosLogInWindowModel
	instanceVariableNames: 'username password restInterface'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!

!classDefinition: #TusLibrosLogInWindowModel category: 'TusLibros-View' stamp: 'JD 11/27/2021 23:26:26'!
Object subclass: #TusLibrosLogInWindowModel
	instanceVariableNames: 'username password restInterface'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!
!TusLibrosLogInWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/27/2021 23:27:18' prior: 50988170!
sendCreateCartRequest
	
	| aHash256Algorithm passwordHash cartId |
	
	aHash256Algorithm := SecureHashAlgorithm256 new.
	passwordHash := aHash256Algorithm hashMessage: password.
	cartId := restInterface sendCreateCartRequestWith: username and: passwordHash.
	
	self triggerEvent: #newCartCreated with: cartId
	! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| aHash256Algorithm userAndPassword catalog |
	
	aHash256Algorithm := SecureHashAlgorithm256 new.
	
	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: (aHash256Algorithm hashMessage: 2) asString.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!
!TusLibrosLogInWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/27/2021 23:27:50' prior: 50988373!
sendCreateCartRequest
	
	| aHash256Algorithm passwordHash cartId |
	
	aHash256Algorithm := SecureHashAlgorithm256 new.
	passwordHash := aHash256Algorithm hashMessage: password asString.
	cartId := restInterface sendCreateCartRequestWith: username and: passwordHash.
	
	self triggerEvent: #newCartCreated with: cartId
	! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| aHash256Algorithm userAndPassword catalog |
	
	aHash256Algorithm := SecureHashAlgorithm256 new.
	
	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: (aHash256Algorithm hashMessage: 2) asString.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| aHash256Algorithm userAndPassword catalog |
	
	aHash256Algorithm := SecureHashAlgorithm256 new.
	
	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: (aHash256Algorithm hashMessage: '2') asString.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!
!TusLibrosLogInWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/27/2021 23:28:09' prior: 50988409!
sendCreateCartRequest
	
	| aHash256Algorithm passwordHash cartId |
	
	aHash256Algorithm := SecureHashAlgorithm256 new.
	passwordHash := aHash256Algorithm hashMessage: password.
	cartId := restInterface sendCreateCartRequestWith: username and: passwordHash.
	
	self triggerEvent: #newCartCreated with: cartId
	! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| aHash256Algorithm userAndPassword catalog |
	
	aHash256Algorithm := SecureHashAlgorithm256 new.
	
	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: (aHash256Algorithm hashMessage: '2') asString.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!
!TusLibrosLogInWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/27/2021 23:28:21' prior: 50988469!
sendCreateCartRequest
	
	| aHash256Algorithm passwordHash cartId |
	
	aHash256Algorithm := SecureHashAlgorithm256 new.
	passwordHash := aHash256Algorithm hashMessage: password asString.
	cartId := restInterface sendCreateCartRequestWith: username and: passwordHash.
	
	self triggerEvent: #newCartCreated with: cartId
	! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| aHash256Algorithm userAndPassword catalog |
	
	aHash256Algorithm := SecureHashAlgorithm256 new.
	
	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: (aHash256Algorithm hashMessage: '2') asString.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

----SNAPSHOT----(27 November 2021 23:35:36) CuisUniversity-4972.image priorSource: 21005869!
!TusLibrosServer methodsFor: 'services' stamp: 'JD 11/28/2021 00:30:47' prior: 50987845!
addCheckoutCartService

	webServer 
		addService: '/checkout-cart' 
		action:
			(self serviceActionDoingOnRequest: 
				[:request | 
					| cartId cardNumber cardExpirationDate cardOwner |
					cartId := (request fields at: 'cartId') asNumber.
					cardNumber := (request fields at: 'ccn') asNumber.
					cardExpirationDate := Month readFrom: (ReadStream on: (request fields at: 'cced')).
					cardOwner := request fields at: 'cco'.
					tusLibrosSystemFacade checkOutCartIdentifiedAs: cartId withCreditCardNumbered: cardNumber ownedBy: cardOwner expiringOn: cardExpirationDate.
					WebUtils jsonEncode: 'Checkout was successfull'
				]
			) 
	! !
!TusLibrosRestInterface methodsFor: 'sending requests' stamp: 'JD 11/28/2021 00:31:02' prior: 50986526!
sendCheckoutOutCartRequestFor: aCartId withCreditCardNumber: aCreditCardNumber expiringOn: anExpirationMonthOfYear ownedBy: aCreditCardOwner

	| response urlFields |
	
	urlFields := Dictionary newFromPairs: {'cartId'.aCartId. 'ccn'.aCreditCardNumber. 'cced'.anExpirationMonthOfYear. 'cco'.aCreditCardOwner.}.
	
	response := WebClient htmlSubmit: self checkoutCartUrl fields: urlFields.
	
	response isSuccess 
		ifTrue:[^WebUtils jsonDecode: ((response content) readStream)]
		ifFalse:[^self error: response content].! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| aHash256Algorithm userAndPassword catalog |
	
	aHash256Algorithm := SecureHashAlgorithm256 new.
	
	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: (aHash256Algorithm hashMessage: '2') asString.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!
!TusLibrosServer methodsFor: 'services' stamp: 'JD 11/28/2021 00:31:57' prior: 50988070!
addRemoveFromCartService

	webServer 
		addService: '/remove-from-cart' 
		action:
			(self serviceActionDoingOnRequest:
				[:request | 
					| book cartId |
					book := (request fields at: 'book').
					cartId := (request fields at: 'cartId') asNumber.
					tusLibrosSystemFacade remove: book fromCart: cartId.
					WebUtils jsonEncode: 'Item removed successfully'
				] 
			)
	
	! !
!TusLibrosRestInterface methodsFor: 'sending requests' stamp: 'JD 11/28/2021 00:32:16' prior: 50986601!
sendRemoveFromCartRequest: aBookToRemove from: aCartId	

	| response urlFields |
	
	urlFields := Dictionary newFromPairs: {'book'. aBookToRemove . 'cartId'. aCartId}.
	
	response := WebClient htmlSubmit: self removeFromCartUrl fields: urlFields.
	
	response isSuccess 
		ifTrue:[^ WebUtils jsonDecode: ((response content) readStream)]
		ifFalse:[^self error: response content].! !

"--------------------- Tus Libros ---------------------"

	| aHash256Algorithm userAndPassword catalog |
	
	aHash256Algorithm := SecureHashAlgorithm256 new.
	
	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: (aHash256Algorithm hashMessage: '2') asString.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!
!TusLibrosRestInterface methodsFor: 'sending requests' stamp: 'JD 11/28/2021 00:33:04' prior: 50988630!
sendRemoveFromCartRequest: aBookToRemove from: aCartId	

	| response urlFields |
	
	urlFields := Dictionary newFromPairs: {'book'. aBookToRemove . 'cartId'. aCartId}.
	
	response := WebClient htmlSubmit: self removeFromCartUrl fields: urlFields.
	
	response isSuccess 
		ifTrue:[^ WebUtils jsonDecode: ((response content) readStream)]
		ifFalse:[^ self error: response content].! !
!TusLibrosRestInterface methodsFor: 'sending requests' stamp: 'JD 11/28/2021 00:33:07' prior: 50986585!
sendListPurchasesRequestFor: aUsername authenticatingWith: aPassword
	
	| response urlFields |
	
	urlFields := Dictionary newFromPairs: {'user'. aUsername. 'password'. aPassword.}.
	response := WebClient htmlSubmit: self listPurchasesUrl fields: urlFields.
	response isSuccess 
		ifTrue:[^ WebUtils jsonDecode: ((response content) readStream)]
		ifFalse:[^ self error: response content].! !
!TusLibrosRestInterface methodsFor: 'sending requests' stamp: 'JD 11/28/2021 00:33:10' prior: 50986574!
sendListCatalogRequest
	
	| response |
	
	response := WebClient httpGet: self listCatalogUrl.
	response isSuccess 
		ifTrue:[^ WebUtils jsonDecode: ((response content) readStream)]
		ifFalse:[^ self error: response content].! !
!TusLibrosRestInterface methodsFor: 'sending requests' stamp: 'JD 11/28/2021 00:33:13' prior: 50986560!
sendListCartRequest: aCartId
	
	| response urlFields |
	
	urlFields := Dictionary newFromPairs: {'cartId'. aCartId.}.
	response := WebClient htmlSubmit: self listCartUrl fields: urlFields.
	response isSuccess 
		ifTrue:[^ WebUtils jsonDecode: ((response content) readStream)]
		ifFalse:[^ self error: response content].! !
!TusLibrosRestInterface methodsFor: 'sending requests' stamp: 'JD 11/28/2021 00:33:17' prior: 50986545!
sendCreateCartRequestWith: aUsername and: aPassword
	
	| response urlFields |
	
	urlFields := Dictionary newFromPairs: {'user'. aUsername. 'password'. aPassword}.
	
	response := WebClient htmlSubmit: self createCartUrl fields: urlFields.
	
	response isSuccess 
		ifTrue:[^ WebUtils jsonDecode: ((response content) readStream)]
		ifFalse:[^ self error: response content].! !
!TusLibrosRestInterface methodsFor: 'sending requests' stamp: 'JD 11/28/2021 00:33:20' prior: 50988570!
sendCheckoutOutCartRequestFor: aCartId withCreditCardNumber: aCreditCardNumber expiringOn: anExpirationMonthOfYear ownedBy: aCreditCardOwner

	| response urlFields |
	
	urlFields := Dictionary newFromPairs: {'cartId'.aCartId. 'ccn'.aCreditCardNumber. 'cced'.anExpirationMonthOfYear. 'cco'.aCreditCardOwner.}.
	
	response := WebClient htmlSubmit: self checkoutCartUrl fields: urlFields.
	
	response isSuccess 
		ifTrue:[^ WebUtils jsonDecode: ((response content) readStream)]
		ifFalse:[^ self error: response content].! !
!TusLibrosRestInterface methodsFor: 'sending requests' stamp: 'JD 11/28/2021 00:33:24' prior: 50986510!
sendAddToCartRequest: aQuantity of: aBook to: aCartId

	| response urlFields |
	
	urlFields := Dictionary newFromPairs: {'bookAmount'. aQuantity. 'book'. aBook. 'cartId'. aCartId}.
	
	response := WebClient htmlSubmit: self addToCartUrl fields: urlFields.
	
	response isSuccess 
		ifTrue:[^ WebUtils jsonDecode: ((response content) readStream)]
		ifFalse:[^ self error: response content].! !
!TusLibrosRestInterface methodsFor: 'sending requests' stamp: 'JD 11/28/2021 00:35:00' prior: 50988762!
sendAddToCartRequest: aQuantity of: aBook to: aCartId

	| response urlFields |
	
	urlFields := Dictionary newFromPairs: {'bookAmount'. aQuantity. 'book'. aBook. 'cartId'. aCartId}.
	
	response := WebClient htmlSubmit: self addToCartUrl fields: urlFields.
	
	^ response isSuccess 
		ifTrue:[^ WebUtils jsonDecode: ((response content) readStream)]
		ifFalse:[^ self error: response content].! !
!TusLibrosRestInterface methodsFor: 'sending requests' stamp: 'JD 11/28/2021 00:35:04' prior: 50988778!
sendAddToCartRequest: aQuantity of: aBook to: aCartId

	| response urlFields |
	
	urlFields := Dictionary newFromPairs: {'bookAmount'. aQuantity. 'book'. aBook. 'cartId'. aCartId}.
	
	response := WebClient htmlSubmit: self addToCartUrl fields: urlFields.
	
	response isSuccess 
		ifTrue:[^ WebUtils jsonDecode: ((response content) readStream)]
		ifFalse:[^ self error: response content].! !
!TusLibrosRestInterface methodsFor: 'sending requests' stamp: 'JD 11/28/2021 00:35:52'!
responseContentOrError: aResponse

	aResponse isSuccess 
		ifTrue:[^ WebUtils jsonDecode: ((aResponse content) readStream)]
		ifFalse:[^ self error: aResponse content].! !
!TusLibrosRestInterface methodsFor: 'sending requests' stamp: 'JD 11/28/2021 00:36:16' prior: 50988794!
sendAddToCartRequest: aQuantity of: aBook to: aCartId

	| response urlFields |
	
	urlFields := Dictionary newFromPairs: {'bookAmount'. aQuantity. 'book'. aBook. 'cartId'. aCartId}.
	
	response := WebClient htmlSubmit: self addToCartUrl fields: urlFields.
	
	^ self responseContentOrError: response! !
!TusLibrosRestInterface methodsFor: 'sending requests' stamp: 'JD 11/28/2021 00:36:20' prior: 50988742!
sendCheckoutOutCartRequestFor: aCartId withCreditCardNumber: aCreditCardNumber expiringOn: anExpirationMonthOfYear ownedBy: aCreditCardOwner

	| response urlFields |
	
	urlFields := Dictionary newFromPairs: {'cartId'.aCartId. 'ccn'.aCreditCardNumber. 'cced'.anExpirationMonthOfYear. 'cco'.aCreditCardOwner.}.
	
	response := WebClient htmlSubmit: self checkoutCartUrl fields: urlFields.
	
	^ self responseContentOrError: response! !
!TusLibrosRestInterface methodsFor: 'sending requests' stamp: 'JD 11/28/2021 00:36:23' prior: 50988727!
sendCreateCartRequestWith: aUsername and: aPassword
	
	| response urlFields |
	
	urlFields := Dictionary newFromPairs: {'user'. aUsername. 'password'. aPassword}.
	
	response := WebClient htmlSubmit: self createCartUrl fields: urlFields.
	
	^ self responseContentOrError: response! !
!TusLibrosRestInterface methodsFor: 'sending requests' stamp: 'JD 11/28/2021 00:36:28' prior: 50988713!
sendListCartRequest: aCartId
	
	| response urlFields |
	
	urlFields := Dictionary newFromPairs: {'cartId'. aCartId.}.
	response := WebClient htmlSubmit: self listCartUrl fields: urlFields.
	^ self responseContentOrError: response! !
!TusLibrosRestInterface methodsFor: 'sending requests' stamp: 'JD 11/28/2021 00:36:33' prior: 50988702!
sendListCatalogRequest
	
	| response |
	
	response := WebClient httpGet: self listCatalogUrl.
	^ self responseContentOrError: response! !
!TusLibrosRestInterface methodsFor: 'sending requests' stamp: 'JD 11/28/2021 00:36:37' prior: 50988686!
sendListPurchasesRequestFor: aUsername authenticatingWith: aPassword
	
	| response urlFields |
	
	urlFields := Dictionary newFromPairs: {'user'. aUsername. 'password'. aPassword.}.
	response := WebClient htmlSubmit: self listPurchasesUrl fields: urlFields.
	^ self responseContentOrError: response! !
!TusLibrosRestInterface methodsFor: 'sending requests' stamp: 'JD 11/28/2021 00:36:44' prior: 50988670!
sendRemoveFromCartRequest: aBookToRemove from: aCartId	

	| response urlFields |
	
	urlFields := Dictionary newFromPairs: {'book'. aBookToRemove . 'cartId'. aCartId}.
	response := WebClient htmlSubmit: self removeFromCartUrl fields: urlFields.
	^ self responseContentOrError: response! !
!TusLibrosRestInterface methodsFor: 'sending requests' stamp: 'JD 11/28/2021 00:36:51' prior: 50988848!
sendCreateCartRequestWith: aUsername and: aPassword
	
	| response urlFields |
	
	urlFields := Dictionary newFromPairs: {'user'. aUsername. 'password'. aPassword}.
	response := WebClient htmlSubmit: self createCartUrl fields: urlFields.
	^ self responseContentOrError: response! !
!TusLibrosRestInterface methodsFor: 'sending requests' stamp: 'JD 11/28/2021 00:37:04' prior: 50988831!
sendCheckoutOutCartRequestFor: aCartId withCreditCardNumber: aCreditCardNumber expiringOn: anExpirationMonthOfYear ownedBy: aCreditCardOwner

	| response urlFields |
	
	urlFields := Dictionary newFromPairs: {'cartId'.aCartId. 'ccn'.aCreditCardNumber. 'cced'.anExpirationMonthOfYear. 'cco'.aCreditCardOwner.}.
	response := WebClient htmlSubmit: self checkoutCartUrl fields: urlFields.

	^ self responseContentOrError: response! !
!TusLibrosRestInterface methodsFor: 'sending requests' stamp: 'JD 11/28/2021 00:37:07' prior: 50988818!
sendAddToCartRequest: aQuantity of: aBook to: aCartId

	| response urlFields |
	
	urlFields := Dictionary newFromPairs: {'bookAmount'. aQuantity. 'book'. aBook. 'cartId'. aCartId}.
	response := WebClient htmlSubmit: self addToCartUrl fields: urlFields.
	
	^ self responseContentOrError: response! !
!TusLibrosRestInterface methodsFor: 'sending requests' stamp: 'JD 11/28/2021 00:37:12' prior: 50988906!
sendCreateCartRequestWith: aUsername and: aPassword
	
	| response urlFields |
	
	urlFields := Dictionary newFromPairs: {'user'. aUsername. 'password'. aPassword}.
	response := WebClient htmlSubmit: self createCartUrl fields: urlFields.

	^ self responseContentOrError: response! !
!TusLibrosRestInterface methodsFor: 'sending requests' stamp: 'JD 11/28/2021 00:37:15' prior: 50988861!
sendListCartRequest: aCartId
	
	| response urlFields |
	
	urlFields := Dictionary newFromPairs: {'cartId'. aCartId.}.
	response := WebClient htmlSubmit: self listCartUrl fields: urlFields.

	^ self responseContentOrError: response! !
!TusLibrosRestInterface methodsFor: 'sending requests' stamp: 'JD 11/28/2021 00:37:18' prior: 50988872!
sendListCatalogRequest
	
	| response |
	
	response := WebClient httpGet: self listCatalogUrl.

	^ self responseContentOrError: response! !
!TusLibrosRestInterface methodsFor: 'sending requests' stamp: 'JD 11/28/2021 00:37:22' prior: 50988880!
sendListPurchasesRequestFor: aUsername authenticatingWith: aPassword
	
	| response urlFields |
	
	urlFields := Dictionary newFromPairs: {'user'. aUsername. 'password'. aPassword.}.
	response := WebClient htmlSubmit: self listPurchasesUrl fields: urlFields.

	^ self responseContentOrError: response! !
!TusLibrosRestInterface methodsFor: 'sending requests' stamp: 'JD 11/28/2021 00:37:25' prior: 50988893!
sendRemoveFromCartRequest: aBookToRemove from: aCartId	

	| response urlFields |
	
	urlFields := Dictionary newFromPairs: {'book'. aBookToRemove . 'cartId'. aCartId}.
	response := WebClient htmlSubmit: self removeFromCartUrl fields: urlFields.

	^ self responseContentOrError: response! !

----SNAPSHOT----(28 November 2021 00:37:36) CuisUniversity-4972.image priorSource: 21020522!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| aHash256Algorithm userAndPassword catalog |
	
	aHash256Algorithm := SecureHashAlgorithm256 new.
	
	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: (aHash256Algorithm hashMessage: '2') asString.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.
	!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!
!TusLibrosRestInterface methodsFor: 'sending requests' stamp: 'JD 11/28/2021 00:39:56'!
bookAmountRequestParameterName

	^ 'bookAmount'! !
!TusLibrosRestInterface methodsFor: 'sending requests' stamp: 'JD 11/28/2021 00:39:56' prior: 50988935!
sendAddToCartRequest: aQuantity of: aBook to: aCartId

	| response urlFields |
	
	urlFields := Dictionary newFromPairs: {self bookAmountRequestParameterName. aQuantity. 'book'. aBook. 'cartId'. aCartId}.
	response := WebClient htmlSubmit: self addToCartUrl fields: urlFields.
	
	^ self responseContentOrError: response! !
!TusLibrosRestInterface methodsFor: 'sending requests' stamp: 'JD 11/28/2021 00:40:22'!
bookRequestParameterName

	^ 'book'! !
!TusLibrosRestInterface methodsFor: 'sending requests' stamp: 'JD 11/28/2021 00:40:22' prior: 50989038!
sendAddToCartRequest: aQuantity of: aBook to: aCartId

	| response urlFields |
	
	urlFields := Dictionary newFromPairs: {self bookAmountRequestParameterName. aQuantity. self bookRequestParameterName. aBook. 'cartId'. aCartId}.
	response := WebClient htmlSubmit: self addToCartUrl fields: urlFields.
	
	^ self responseContentOrError: response! !
!TusLibrosRestInterface methodsFor: 'sending requests' stamp: 'JD 11/28/2021 00:40:22' prior: 50988993!
sendRemoveFromCartRequest: aBookToRemove from: aCartId	

	| response urlFields |
	
	urlFields := Dictionary newFromPairs: {self bookRequestParameterName. aBookToRemove . 'cartId'. aCartId}.
	response := WebClient htmlSubmit: self removeFromCartUrl fields: urlFields.

	^ self responseContentOrError: response! !
!TusLibrosRestInterface methodsFor: 'sending requests' stamp: 'JD 11/28/2021 00:40:47'!
cartIdRequestParameterName

	^ 'cartId'! !
!TusLibrosRestInterface methodsFor: 'sending requests' stamp: 'JD 11/28/2021 00:40:47' prior: 50989056!
sendAddToCartRequest: aQuantity of: aBook to: aCartId

	| response urlFields |
	
	urlFields := Dictionary newFromPairs: {self bookAmountRequestParameterName. aQuantity. self bookRequestParameterName. aBook. self cartIdRequestParameterName. aCartId}.
	response := WebClient htmlSubmit: self addToCartUrl fields: urlFields.
	
	^ self responseContentOrError: response! !
!TusLibrosRestInterface methodsFor: 'sending requests' stamp: 'JD 11/28/2021 00:40:47' prior: 50988961!
sendListCartRequest: aCartId
	
	| response urlFields |
	
	urlFields := Dictionary newFromPairs: {self cartIdRequestParameterName. aCartId.}.
	response := WebClient htmlSubmit: self listCartUrl fields: urlFields.

	^ self responseContentOrError: response! !
!TusLibrosRestInterface methodsFor: 'sending requests' stamp: 'JD 11/28/2021 00:40:47' prior: 50989071!
sendRemoveFromCartRequest: aBookToRemove from: aCartId	

	| response urlFields |
	
	urlFields := Dictionary newFromPairs: {self bookRequestParameterName. aBookToRemove . self cartIdRequestParameterName. aCartId}.
	response := WebClient htmlSubmit: self removeFromCartUrl fields: urlFields.

	^ self responseContentOrError: response! !
!TusLibrosRestInterface methodsFor: 'sending requests' stamp: 'JD 11/28/2021 00:40:47' prior: 50988918!
sendCheckoutOutCartRequestFor: aCartId withCreditCardNumber: aCreditCardNumber expiringOn: anExpirationMonthOfYear ownedBy: aCreditCardOwner

	| response urlFields |
	
	urlFields := Dictionary newFromPairs: {self cartIdRequestParameterName.aCartId. 'ccn'.aCreditCardNumber. 'cced'.anExpirationMonthOfYear. 'cco'.aCreditCardOwner.}.
	response := WebClient htmlSubmit: self checkoutCartUrl fields: urlFields.

	^ self responseContentOrError: response! !
!TusLibrosRestInterface methodsFor: 'sending requests' stamp: 'JD 11/28/2021 00:41:15'!
creditCardNumberRequestParameterName

	^ 'ccn'! !
!TusLibrosRestInterface methodsFor: 'sending requests' stamp: 'JD 11/28/2021 00:41:15' prior: 50989130!
sendCheckoutOutCartRequestFor: aCartId withCreditCardNumber: aCreditCardNumber expiringOn: anExpirationMonthOfYear ownedBy: aCreditCardOwner

	| response urlFields |
	
	urlFields := Dictionary newFromPairs: {self cartIdRequestParameterName.aCartId. self creditCardNumberRequestParameterName.aCreditCardNumber. 'cced'.anExpirationMonthOfYear. 'cco'.aCreditCardOwner.}.
	response := WebClient htmlSubmit: self checkoutCartUrl fields: urlFields.

	^ self responseContentOrError: response! !
!TusLibrosRestInterface methodsFor: 'sending requests' stamp: 'JD 11/28/2021 00:41:30'!
creditCardExpirationRequestParameterName

	^ 'cced'! !
!TusLibrosRestInterface methodsFor: 'sending requests' stamp: 'JD 11/28/2021 00:41:30' prior: 50989152!
sendCheckoutOutCartRequestFor: aCartId withCreditCardNumber: aCreditCardNumber expiringOn: anExpirationMonthOfYear ownedBy: aCreditCardOwner

	| response urlFields |
	
	urlFields := Dictionary newFromPairs: {self cartIdRequestParameterName.aCartId. self creditCardNumberRequestParameterName.aCreditCardNumber. self creditCardExpirationRequestParameterName.anExpirationMonthOfYear. 'cco'.aCreditCardOwner.}.
	response := WebClient htmlSubmit: self checkoutCartUrl fields: urlFields.

	^ self responseContentOrError: response! !
!TusLibrosRestInterface methodsFor: 'sending requests' stamp: 'JD 11/28/2021 00:41:46'!
creditCardOwnerRequestParameterName

	^ 'cco'! !
!TusLibrosRestInterface methodsFor: 'sending requests' stamp: 'JD 11/28/2021 00:41:46' prior: 50989175!
sendCheckoutOutCartRequestFor: aCartId withCreditCardNumber: aCreditCardNumber expiringOn: anExpirationMonthOfYear ownedBy: aCreditCardOwner

	| response urlFields |
	
	urlFields := Dictionary newFromPairs: {self cartIdRequestParameterName.aCartId. self creditCardNumberRequestParameterName.aCreditCardNumber. self creditCardExpirationRequestParameterName.anExpirationMonthOfYear. self creditCardOwnerRequestParameterName.aCreditCardOwner.}.
	response := WebClient htmlSubmit: self checkoutCartUrl fields: urlFields.

	^ self responseContentOrError: response! !
!TusLibrosRestInterface methodsFor: 'sending requests' stamp: 'JD 11/28/2021 00:42:16' prior: 50989200!
sendCheckoutOutCartRequestFor: aCartId withCreditCardNumber: aCreditCardNumber expiringOn: anExpirationMonthOfYear ownedBy: aCreditCardOwner

	| response urlFields |
	
	urlFields := Dictionary newFromPairs: {
		self cartIdRequestParameterName. aCartId. 
		self creditCardNumberRequestParameterName. aCreditCardNumber. 
		self creditCardExpirationRequestParameterName. anExpirationMonthOfYear. 
		self creditCardOwnerRequestParameterName. aCreditCardOwner.
	}.
	response := WebClient htmlSubmit: self checkoutCartUrl fields: urlFields.

	^ self responseContentOrError: response! !
!TusLibrosRestInterface methodsFor: 'sending requests' stamp: 'JD 11/28/2021 00:42:37' prior: 50989089!
sendAddToCartRequest: aQuantity of: aBook to: aCartId

	| response urlFields |
	
	urlFields := Dictionary newFromPairs: {
		self bookAmountRequestParameterName. aQuantity. 
		self bookRequestParameterName. aBook. 
		self cartIdRequestParameterName. aCartId
	}.
	response := WebClient htmlSubmit: self addToCartUrl fields: urlFields.
	
	^ self responseContentOrError: response! !
!TusLibrosRestInterface methodsFor: 'sending requests' stamp: 'JD 11/28/2021 00:42:58'!
userRequestParameterName

	^ 'user'! !
!TusLibrosRestInterface methodsFor: 'sending requests' stamp: 'JD 11/28/2021 00:42:58' prior: 50988948!
sendCreateCartRequestWith: aUsername and: aPassword
	
	| response urlFields |
	
	urlFields := Dictionary newFromPairs: {self userRequestParameterName. aUsername. 'password'. aPassword}.
	response := WebClient htmlSubmit: self createCartUrl fields: urlFields.

	^ self responseContentOrError: response! !
!TusLibrosRestInterface methodsFor: 'sending requests' stamp: 'JD 11/28/2021 00:42:58' prior: 50988980!
sendListPurchasesRequestFor: aUsername authenticatingWith: aPassword
	
	| response urlFields |
	
	urlFields := Dictionary newFromPairs: {self userRequestParameterName. aUsername. 'password'. aPassword.}.
	response := WebClient htmlSubmit: self listPurchasesUrl fields: urlFields.

	^ self responseContentOrError: response! !
!TusLibrosRestInterface methodsFor: 'sending requests' stamp: 'JD 11/28/2021 00:43:24'!
passwordRequestParameterName

	^ 'password'! !
!TusLibrosRestInterface methodsFor: 'sending requests' stamp: 'JD 11/28/2021 00:43:24' prior: 50989263!
sendCreateCartRequestWith: aUsername and: aPassword
	
	| response urlFields |
	
	urlFields := Dictionary newFromPairs: {self userRequestParameterName. aUsername. self passwordRequestParameterName. aPassword}.
	response := WebClient htmlSubmit: self createCartUrl fields: urlFields.

	^ self responseContentOrError: response! !
!TusLibrosRestInterface methodsFor: 'sending requests' stamp: 'JD 11/28/2021 00:43:24' prior: 50989276!
sendListPurchasesRequestFor: aUsername authenticatingWith: aPassword
	
	| response urlFields |
	
	urlFields := Dictionary newFromPairs: {self userRequestParameterName. aUsername. self passwordRequestParameterName. aPassword.}.
	response := WebClient htmlSubmit: self listPurchasesUrl fields: urlFields.

	^ self responseContentOrError: response! !
!TusLibrosRestInterface methodsFor: 'sending requests' stamp: 'JD 11/28/2021 00:43:34' prior: 50989294!
sendCreateCartRequestWith: aUsername and: aPassword
	
	| response urlFields |
	
	urlFields := Dictionary newFromPairs: {
		self userRequestParameterName. aUsername. 
		self passwordRequestParameterName. aPassword
	}.
	response := WebClient htmlSubmit: self createCartUrl fields: urlFields.

	^ self responseContentOrError: response! !
!TusLibrosRestInterface methodsFor: 'sending requests' stamp: 'JD 11/28/2021 00:43:49' prior: 50989308!
sendListPurchasesRequestFor: aUsername authenticatingWith: aPassword
	
	| response urlFields |
	
	urlFields := Dictionary newFromPairs: {
		self userRequestParameterName. aUsername. 
		self passwordRequestParameterName. aPassword.
	}.
	response := WebClient htmlSubmit: self listPurchasesUrl fields: urlFields.

	^ self responseContentOrError: response! !
!TusLibrosRestInterface methodsFor: 'sending requests' stamp: 'JD 11/28/2021 00:43:58' prior: 50989116!
sendRemoveFromCartRequest: aBookToRemove from: aCartId	

	| response urlFields |
	
	urlFields := Dictionary newFromPairs: {
		self bookRequestParameterName. aBookToRemove. 
		self cartIdRequestParameterName. aCartId
	}.
	response := WebClient htmlSubmit: self removeFromCartUrl fields: urlFields.

	^ self responseContentOrError: response! !
!TusLibrosRestInterface methodsFor: 'sending requests' stamp: 'JD 11/28/2021 00:44:00' prior: 50989352!
sendRemoveFromCartRequest: aBookToRemove from: aCartId	

	| response urlFields |
	
	urlFields := Dictionary newFromPairs: {
		self bookRequestParameterName. aBookToRemove. 
		self cartIdRequestParameterName. aCartId.
	}.
	response := WebClient htmlSubmit: self removeFromCartUrl fields: urlFields.

	^ self responseContentOrError: response! !
!TusLibrosRestInterface methodsFor: 'sending requests' stamp: 'JD 11/28/2021 00:44:25' prior: 50989104!
sendListCartRequest: aCartId
	
	| response urlFields |
	
	urlFields := Dictionary newFromPairs: {
		self cartIdRequestParameterName. aCartId.
	}.
	response := WebClient htmlSubmit: self listCartUrl fields: urlFields.

	^ self responseContentOrError: response! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| aHash256Algorithm userAndPassword catalog |
	
	aHash256Algorithm := SecureHashAlgorithm256 new.
	
	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: (aHash256Algorithm hashMessage: '2') asString.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!
!TusLibrosRestInterface methodsFor: 'sending requests' stamp: 'JD 11/28/2021 00:48:57'!
sendRequestWithParameters: parameters to: url

	| response urlFields |
	
	urlFields := Dictionary newFromPairs: parameters.
	response := WebClient htmlSubmit: url fields: urlFields.
	
	^ self responseContentOrError: response! !
!TusLibrosRestInterface methodsFor: 'sending requests' stamp: 'JD 11/28/2021 00:50:22' prior: 50989323!
sendCreateCartRequestWith: aUsername and: aPassword
	
	
	
	^ self 
		sendRequestWithParameters: {
			self userRequestParameterName. aUsername. 
			self passwordRequestParameterName. aPassword
		} 
		to: self createCartUrl! !
!TusLibrosRestInterface methodsFor: 'sending requests' stamp: 'JD 11/28/2021 00:50:27' prior: 50989427!
sendCreateCartRequestWith: aUsername and: aPassword
	
	^ self 
		sendRequestWithParameters: {
			self userRequestParameterName. aUsername. 
			self passwordRequestParameterName. aPassword
		} 
		to: self createCartUrl! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| aHash256Algorithm userAndPassword catalog |
	
	aHash256Algorithm := SecureHashAlgorithm256 new.
	
	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: (aHash256Algorithm hashMessage: '2') asString.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!
!TusLibrosRestInterface methodsFor: 'sending requests' stamp: 'JD 11/28/2021 00:52:27' prior: 50989243!
sendAddToCartRequest: aQuantity of: aBook to: aCartId


	^ self 
		sendRequestWithParameters: {
			self bookAmountRequestParameterName. aQuantity. 
			self bookRequestParameterName. aBook. 
			self cartIdRequestParameterName. aCartId
		}
		to: self addToCartUrl! !
!TusLibrosRestInterface methodsFor: 'sending requests' stamp: 'JD 11/28/2021 00:53:10' prior: 50989221!
sendCheckoutOutCartRequestFor: aCartId withCreditCardNumber: aCreditCardNumber expiringOn: anExpirationMonthOfYear ownedBy: aCreditCardOwner
	
	^ self 
		sendRequestWithParameters: {
			self cartIdRequestParameterName. aCartId. 
			self creditCardNumberRequestParameterName. aCreditCardNumber. 
			self creditCardExpirationRequestParameterName. anExpirationMonthOfYear. 
			self creditCardOwnerRequestParameterName. aCreditCardOwner.
		}
		to: self checkoutCartUrl! !
!TusLibrosRestInterface methodsFor: 'sending requests' stamp: 'JD 11/28/2021 00:53:20' prior: 50989473!
sendAddToCartRequest: aQuantity of: aBook to: aCartId

	^ self 
		sendRequestWithParameters: {
			self bookAmountRequestParameterName. aQuantity. 
			self bookRequestParameterName. aBook. 
			self cartIdRequestParameterName. aCartId
		}
		to: self addToCartUrl! !
!TusLibrosRestInterface methodsFor: 'sending requests' stamp: 'JD 11/28/2021 00:53:53' prior: 50989380!
sendListCartRequest: aCartId

	^ self 
		sendRequestWithParameters: {
			self cartIdRequestParameterName. aCartId.
		} 
		to: self listCartUrl! !
!TusLibrosRestInterface methodsFor: 'sending requests' stamp: 'JD 11/28/2021 00:54:24' prior: 50988972!
sendListCatalogRequest
	
	^ self 
		sendRequestWithParameters: {} 
		to: self listCatalogUrl! !
!TusLibrosRestInterface methodsFor: 'sending requests' stamp: 'JD 11/28/2021 00:55:27' prior: 50989337!
sendListPurchasesRequestFor: aUsername authenticatingWith: aPassword

	^ self 
		sendRequestWithParameters: {
			self userRequestParameterName. aUsername. 
			self passwordRequestParameterName. aPassword.
		} 
		to: self listPurchasesUrl! !
!TusLibrosRestInterface methodsFor: 'sending requests' stamp: 'JD 11/28/2021 00:56:42' prior: 50989366!
sendRemoveFromCartRequest: aBookToRemove from: aCartId	

	^ self 
		sendRequestWithParameters: {
			self bookRequestParameterName. aBookToRemove. 
			self cartIdRequestParameterName. aCartId.
		} 
		to: self removeFromCartUrl! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| aHash256Algorithm userAndPassword catalog |
	
	aHash256Algorithm := SecureHashAlgorithm256 new.
	
	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: (aHash256Algorithm hashMessage: '2') asString.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

!methodRemoval: TusLibrosShopWindowModel #presentCart: stamp: 'JD 11/28/2021 00:59:36'!
presentCart: aCart
	
	| cartAsSet cartPrice catalog presentedCart |

	presentedCart := OrderedCollection new.
	cartPrice := 0.
	catalog := restInterface sendListCatalogRequest.
	cartAsSet := aCart asSet sorted.
	cartAsSet do: [:aBook | 
		| bookOccurrences |
		
		bookOccurrences := aCart occurrencesOf: aBook.
		presentedCart add: (bookOccurrences asString, ' of ', aBook).
		cartPrice := cartPrice + ((catalog at: aBook) * bookOccurrences)
	].
	presentedCart add: ''.
	presentedCart add: 'Cart Total: ', cartPrice asString, '$'.

	^ presentedCart!
!TusLibrosLogInWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/28/2021 01:04:25'!
createCart
	
	| aHash256Algorithm passwordHash cartId |
	
	aHash256Algorithm := SecureHashAlgorithm256 new.
	passwordHash := aHash256Algorithm hashMessage: password asString.
	cartId := restInterface sendCreateCartRequestWith: username and: passwordHash.
	
	self triggerEvent: #newCartCreated with: cartId
	! !

!methodRemoval: TusLibrosLogInWindowModel #sendCreateCartRequest stamp: 'JD 11/28/2021 01:04:25'!
sendCreateCartRequest
	
	| aHash256Algorithm passwordHash cartId |
	
	aHash256Algorithm := SecureHashAlgorithm256 new.
	passwordHash := aHash256Algorithm hashMessage: password asString.
	cartId := restInterface sendCreateCartRequestWith: username and: passwordHash.
	
	self triggerEvent: #newCartCreated with: cartId
	!
!TusLibrosWindow methodsFor: 'log in - layouts' stamp: 'JD 11/28/2021 01:04:45' prior: 50985974!
buildCreateCartButtonRow
	| thirdRowLayoutMorph sendRequestButtonMorph |
	
	sendRequestButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #createCart label: 'Create Cart'.

	thirdRowLayoutMorph := LayoutMorph newRow.
	thirdRowLayoutMorph separation: 5;
	axisEdgeWeight: 0.5;
	addMorph: sendRequestButtonMorph.
	
	^ thirdRowLayoutMorph.! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| aHash256Algorithm userAndPassword catalog |
	
	aHash256Algorithm := SecureHashAlgorithm256 new.
	
	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: (aHash256Algorithm hashMessage: '2') asString.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!
!TusLibrosWindow methodsFor: 'events actions' stamp: 'JD 11/28/2021 01:06:39' prior: 50986790!
redirectToCatalogWindowWith: aCartId

	self model: (TusLibrosShopWindowModel newFor: aCartId authenticating: self model usernameText with: self model passwordHash).
	self setLabel: 'Catalog'.
	self layoutMorph submorphs do: [:aSubmorph | aSubmorph dismissMorph].
	self buildMorphicCatalogWindow.

	self model when: #cartModified send: #refreshCartList to: self.
	self model when: #cartCheckouted send: #redirectToTicketWindow to: self! !
!TusLibrosWindow methodsFor: 'events actions' stamp: 'JD 11/28/2021 01:07:09' prior: 50986926!
redirectToTicketWindow
	
	self model: (TusLibrosTicketWindowModel newFor: self model listCart authenticating: 	self model usernameText with: self model passwordHash).
	self setLabel: 'Checkout Completed'.
	self layoutMorph submorphs do: [:aSubmorph | aSubmorph dismissMorph].
	self buildMorphicTicketWindow.

	self model when: #loggedOut send: #redirectToLoginWindow to: self.
	self model when: #newCartRequested send: #redirectToCatalogWindowWith: to: self! !
!TusLibrosLogInWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/28/2021 01:08:16' prior: 50989596!
createCart
	
	| aHash256Algorithm passwordHashh cartId |
	
	aHash256Algorithm := SecureHashAlgorithm256 new.
	passwordHashh := aHash256Algorithm hashMessage: password asString.
	cartId := restInterface sendCreateCartRequestWith: username and: passwordHashh.
	
	self triggerEvent: #newCartCreated with: cartId
	! !

!classDefinition: #TusLibrosLogInWindowModel category: 'TusLibros-View' stamp: 'JD 11/28/2021 01:08:27'!
Object subclass: #TusLibrosLogInWindowModel
	instanceVariableNames: 'username password restInterface passwordHash'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!
!TusLibrosLogInWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/28/2021 01:08:26' prior: 50989696!
createCart
	
	| aHash256Algorithm cartId |
	
	aHash256Algorithm := SecureHashAlgorithm256 new.
	passwordHash := aHash256Algorithm hashMessage: password asString.
	cartId := restInterface sendCreateCartRequestWith: username and: passwordHash.
	
	self triggerEvent: #newCartCreated with: cartId
	! !
!TusLibrosLogInWindowModel methodsFor: 'password' stamp: 'JD 11/28/2021 01:08:36'!
passwordHash
	
	^ passwordHash ! !

!classDefinition: #TusLibrosTicketWindowModel category: 'TusLibros-View' stamp: 'JD 11/28/2021 01:09:36'!
Object subclass: #TusLibrosTicketWindowModel
	instanceVariableNames: 'cart username password restInterface passwordHash'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!
!TusLibrosTicketWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/28/2021 01:09:33'!
passwordHash
	
	^ passwordHash! !

!methodRemoval: TusLibrosTicketWindowModel #passwordText stamp: 'JD 11/28/2021 01:09:50'!
passwordText
	
	^ password!
!TusLibrosTicketWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/28/2021 01:10:07' prior: 50986676!
initializeFor: aCheckoutedCart authenticating: 	aUsername with: aPasswordHash
	
	cart := aCheckoutedCart.
	username := aUsername.
	passwordHash := aPasswordHash.
	restInterface := TusLibrosRestInterface new.! !

Object subclass: #TusLibrosTicketWindowModel
	instanceVariableNames: 'cart username passwordHash restInterface'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!

!classDefinition: #TusLibrosTicketWindowModel category: 'TusLibros-View' stamp: 'JD 11/28/2021 01:10:17'!
Object subclass: #TusLibrosTicketWindowModel
	instanceVariableNames: 'cart username passwordHash restInterface'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!
!TusLibrosTicketWindowModel class methodsFor: 'as yet unclassified' stamp: 'JD 11/28/2021 01:10:25' prior: 50986721!
newFor: aCheckoutedCart authenticating: 	aUsername with: aPasswordHash
	
	^ self new initializeFor: aCheckoutedCart authenticating: 	aUsername with: aPasswordHash! !
!TusLibrosShopWindowModel class methodsFor: 'as yet unclassified' stamp: 'JD 11/28/2021 01:10:41' prior: 50986432!
newFor: aCartId authenticating: aUsername with: aPasswordHash
	^ self new initializeFor: aCartId authenticating: aUsername with: aPasswordHash! !

!classDefinition: #TusLibrosShopWindowModel category: 'TusLibros-View' stamp: 'JD 11/28/2021 01:11:13'!
Object subclass: #TusLibrosShopWindowModel
	instanceVariableNames: 'cartId restInterface catalogListIndex itemQuantity username passwordHash cartListIndex'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!
!TusLibrosShopWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/28/2021 01:11:13' prior: 50987078!
showPurchases

	| purchases catalog totalSpent|

	catalog := restInterface sendListCatalogRequest.
	purchases := restInterface sendListPurchasesRequestFor: username authenticatingWith: passwordHash.
	Transcript clear.
	totalSpent := 0.
	Transcript show: 'Book', '-', 'Quantity'.
	Transcript newLine.
	purchases keysDo: [:aBook | 
		| bookQuantity bookPrice |
		bookPrice := catalog at: aBook.
		bookQuantity := (purchases at: aBook) / bookPrice.
		totalSpent := totalSpent + bookPrice.
		Transcript show: aBook, '-', bookQuantity asString.
		Transcript newLine.
	].
	Transcript show: 'Total: ', totalSpent asString, '$'.
	TranscriptWindow openTranscript.
! !
!TusLibrosShopWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/28/2021 01:11:13' prior: 50986921!
passwordText
	
	^ passwordHash! !
!TusLibrosShopWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/28/2021 01:11:13' prior: 50988009!
initializeFor: aCartId authenticating: aUsername with: aPassword
	
	cartId := aCartId.
	username := aUsername.
	passwordHash := aPassword.
	catalogListIndex := 1.
	cartListIndex := 1.
	itemQuantity := '1'.
	restInterface := TusLibrosRestInterface new
! !
!TusLibrosShopWindowModel methodsFor: 'initialization' stamp: 'JD 11/28/2021 01:11:19' prior: 50989837!
initializeFor: aCartId authenticating: aUsername with: aPasswordHash
	
	cartId := aCartId.
	username := aUsername.
	passwordHash := aPasswordHash.
	catalogListIndex := 1.
	cartListIndex := 1.
	itemQuantity := '1'.
	restInterface := TusLibrosRestInterface new
! !
!TusLibrosShopWindowModel methodsFor: 'credentials' stamp: 'JD 11/28/2021 01:11:35'!
passwordHash
	
	^ passwordHash! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

----SNAPSHOT----(28 November 2021 01:11:56) CuisUniversity-4972.image priorSource: 21035328!

"--------------------- Tus Libros ---------------------"

	| aHash256Algorithm userAndPassword catalog |
	
	aHash256Algorithm := SecureHashAlgorithm256 new.
	
	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: (aHash256Algorithm hashMessage: '2') asString.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!
!TusLibrosWindow methodsFor: 'events actions' stamp: 'JD 11/28/2021 01:15:31' prior: 50989661!
redirectToCatalogWindowWith: aCartId
	
	self halt.
	self model: (TusLibrosShopWindowModel newFor: aCartId authenticating: self model usernameText with: self model passwordHash).
	self setLabel: 'Catalog'.
	self layoutMorph submorphs do: [:aSubmorph | aSubmorph dismissMorph].
	self buildMorphicCatalogWindow.

	self model when: #cartModified send: #refreshCartList to: self.
	self model when: #cartCheckouted send: #redirectToTicketWindow to: self! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| aHash256Algorithm userAndPassword catalog |
	
	aHash256Algorithm := SecureHashAlgorithm256 new.
	
	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: (aHash256Algorithm hashMessage: '2') asString.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!
!TusLibrosTicketWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/28/2021 01:16:51' prior: 50986808!
continueBuying
	
	| cartId |

	cartId := restInterface sendCreateCartRequestWith: username and: passwordHash.
	self triggerEvent: #newCartRequested with: cartId! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| aHash256Algorithm userAndPassword catalog |
	
	aHash256Algorithm := SecureHashAlgorithm256 new.
	
	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: (aHash256Algorithm hashMessage: '2') asString.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!
!TusLibrosWindow methodsFor: 'events actions' stamp: 'JD 11/28/2021 01:17:32' prior: 50989892!
redirectToCatalogWindowWith: aCartId

	self model: (TusLibrosShopWindowModel newFor: aCartId authenticating: self model usernameText with: self model passwordHash).
	self setLabel: 'Catalog'.
	self layoutMorph submorphs do: [:aSubmorph | aSubmorph dismissMorph].
	self buildMorphicCatalogWindow.

	self model when: #cartModified send: #refreshCartList to: self.
	self model when: #cartCheckouted send: #redirectToTicketWindow to: self! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

----SNAPSHOT----(28 November 2021 01:18:23) CuisUniversity-4972.image priorSource: 21062889!

Object subclass: #TusLibrosWindowModel
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!

!classDefinition: #TusLibrosWindowModel category: 'TusLibros-View' stamp: 'JD 11/28/2021 01:21:06'!
Object subclass: #TusLibrosWindowModel
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!

TusLibrosWindowModel subclass: #TusLibrosLogInWindowModel
	instanceVariableNames: 'username password restInterface passwordHash'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!

!classDefinition: #TusLibrosLogInWindowModel category: 'TusLibros-View' stamp: 'JD 11/28/2021 01:21:13'!
TusLibrosWindowModel subclass: #TusLibrosLogInWindowModel
	instanceVariableNames: 'username password restInterface passwordHash'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!

TusLibrosWindowModel subclass: #TusLibrosShopWindowModel
	instanceVariableNames: 'cartId restInterface catalogListIndex itemQuantity username passwordHash cartListIndex'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!

!classDefinition: #TusLibrosShopWindowModel category: 'TusLibros-View' stamp: 'JD 11/28/2021 01:21:16'!
TusLibrosWindowModel subclass: #TusLibrosShopWindowModel
	instanceVariableNames: 'cartId restInterface catalogListIndex itemQuantity username passwordHash cartListIndex'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!

TusLibrosWindowModel subclass: #TusLibrosTicketWindowModel
	instanceVariableNames: 'cart username passwordHash restInterface'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!

!classDefinition: #TusLibrosTicketWindowModel category: 'TusLibros-View' stamp: 'JD 11/28/2021 01:21:20'!
TusLibrosWindowModel subclass: #TusLibrosTicketWindowModel
	instanceVariableNames: 'cart username passwordHash restInterface'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!

TusLibrosWindowModel subclass: #TusLibrosLogInWindowModel
	instanceVariableNames: 'password restInterface passwordHash'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!

!classDefinition: #TusLibrosLogInWindowModel category: 'TusLibros-View' stamp: 'JD 11/28/2021 01:21:42'!
TusLibrosWindowModel subclass: #TusLibrosLogInWindowModel
	instanceVariableNames: 'password restInterface passwordHash'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!

TusLibrosWindowModel subclass: #TusLibrosShopWindowModel
	instanceVariableNames: 'cartId restInterface catalogListIndex itemQuantity passwordHash cartListIndex'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!

!classDefinition: #TusLibrosShopWindowModel category: 'TusLibros-View' stamp: 'JD 11/28/2021 01:21:46'!
TusLibrosWindowModel subclass: #TusLibrosShopWindowModel
	instanceVariableNames: 'cartId restInterface catalogListIndex itemQuantity passwordHash cartListIndex'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!

TusLibrosWindowModel subclass: #TusLibrosTicketWindowModel
	instanceVariableNames: 'cart passwordHash restInterface'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!

!classDefinition: #TusLibrosTicketWindowModel category: 'TusLibros-View' stamp: 'JD 11/28/2021 01:21:50'!
TusLibrosWindowModel subclass: #TusLibrosTicketWindowModel
	instanceVariableNames: 'cart passwordHash restInterface'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!

Object subclass: #TusLibrosWindowModel
	instanceVariableNames: 'username'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!

!classDefinition: #TusLibrosWindowModel category: 'TusLibros-View' stamp: 'JD 11/28/2021 01:21:53'!
Object subclass: #TusLibrosWindowModel
	instanceVariableNames: 'username'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!

TusLibrosWindowModel subclass: #TusLibrosLogInWindowModel
	instanceVariableNames: 'password restInterface'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!

!classDefinition: #TusLibrosLogInWindowModel category: 'TusLibros-View' stamp: 'JD 11/28/2021 01:21:58'!
TusLibrosWindowModel subclass: #TusLibrosLogInWindowModel
	instanceVariableNames: 'password restInterface'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!

TusLibrosWindowModel subclass: #TusLibrosShopWindowModel
	instanceVariableNames: 'cartId restInterface catalogListIndex itemQuantity cartListIndex'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!

!classDefinition: #TusLibrosShopWindowModel category: 'TusLibros-View' stamp: 'JD 11/28/2021 01:22:04'!
TusLibrosWindowModel subclass: #TusLibrosShopWindowModel
	instanceVariableNames: 'cartId restInterface catalogListIndex itemQuantity cartListIndex'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!

TusLibrosWindowModel subclass: #TusLibrosTicketWindowModel
	instanceVariableNames: 'cart restInterface'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!

!classDefinition: #TusLibrosTicketWindowModel category: 'TusLibros-View' stamp: 'JD 11/28/2021 01:22:09'!
TusLibrosWindowModel subclass: #TusLibrosTicketWindowModel
	instanceVariableNames: 'cart restInterface'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!

Object subclass: #TusLibrosWindowModel
	instanceVariableNames: 'username passwordHash'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!

!classDefinition: #TusLibrosWindowModel category: 'TusLibros-View' stamp: 'JD 11/28/2021 01:22:15'!
Object subclass: #TusLibrosWindowModel
	instanceVariableNames: 'username passwordHash'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!

TusLibrosWindowModel subclass: #TusLibrosLogInWindowModel
	instanceVariableNames: 'password'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!

!classDefinition: #TusLibrosLogInWindowModel category: 'TusLibros-View' stamp: 'JD 11/28/2021 01:22:29'!
TusLibrosWindowModel subclass: #TusLibrosLogInWindowModel
	instanceVariableNames: 'password'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!

TusLibrosWindowModel subclass: #TusLibrosShopWindowModel
	instanceVariableNames: 'cartId catalogListIndex itemQuantity cartListIndex'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!

!classDefinition: #TusLibrosShopWindowModel category: 'TusLibros-View' stamp: 'JD 11/28/2021 01:22:32'!
TusLibrosWindowModel subclass: #TusLibrosShopWindowModel
	instanceVariableNames: 'cartId catalogListIndex itemQuantity cartListIndex'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!

TusLibrosWindowModel subclass: #TusLibrosTicketWindowModel
	instanceVariableNames: 'cart'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!

!classDefinition: #TusLibrosTicketWindowModel category: 'TusLibros-View' stamp: 'JD 11/28/2021 01:22:35'!
TusLibrosWindowModel subclass: #TusLibrosTicketWindowModel
	instanceVariableNames: 'cart'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!

Object subclass: #TusLibrosWindowModel
	instanceVariableNames: 'username passwordHash restInterface'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!

!classDefinition: #TusLibrosWindowModel category: 'TusLibros-View' stamp: 'JD 11/28/2021 01:22:39'!
Object subclass: #TusLibrosWindowModel
	instanceVariableNames: 'username passwordHash restInterface'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!
!TusLibrosWindowModel methodsFor: 'no messages' stamp: 'JD 11/28/2021 01:23:21'!
passwordHash
	
	self subclassResponsibility! !
!TusLibrosWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/28/2021 01:24:03'!
usernameText
	
	self subclassResponsibility! !
!TusLibrosWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/28/2021 01:31:29' prior: 50990232!
usernameText
	
	^ username! !
!TusLibrosWindowModel methodsFor: 'as yet unclassified' stamp: 'JD 11/28/2021 01:31:37' prior: 50990227!
passwordHash
	
	^ passwordHash! !

!methodRemoval: TusLibrosLogInWindowModel #passwordHash stamp: 'JD 11/28/2021 01:31:44'!
passwordHash
	
	^ passwordHash !

!methodRemoval: TusLibrosLogInWindowModel #usernameText stamp: 'JD 11/28/2021 01:31:48'!
usernameText
	
	^ username !

!methodRemoval: TusLibrosShopWindowModel #passwordHash stamp: 'JD 11/28/2021 01:31:55'!
passwordHash
	
	^ passwordHash!

!methodRemoval: TusLibrosShopWindowModel #usernameText stamp: 'JD 11/28/2021 01:31:58'!
usernameText
	
	^ username!

!methodRemoval: TusLibrosShopWindowModel #passwordText stamp: 'JD 11/28/2021 01:32:13'!
passwordText
	
	^ passwordHash!

!methodRemoval: TusLibrosTicketWindowModel #usernameText stamp: 'JD 11/28/2021 01:32:18'!
usernameText
	
	^ username!

!methodRemoval: TusLibrosTicketWindowModel #passwordHash stamp: 'JD 11/28/2021 01:32:20'!
passwordHash
	
	^ passwordHash!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| aHash256Algorithm userAndPassword catalog |
	
	aHash256Algorithm := SecureHashAlgorithm256 new.
	
	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: (aHash256Algorithm hashMessage: '2') asString.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!

----SNAPSHOT----(28 November 2021 01:33:13) CuisUniversity-4972.image priorSource: 21066589!
!TusLibrosShopWindowModel methodsFor: 'catalog' stamp: 'JD 11/28/2021 01:39:10' prior: 50986339!
listCatalog

	| catalogg |

	catalogg := restInterface sendListCatalogRequest.
	^ self presentCatalog: catalogg! !
!TusLibrosShopWindowModel methodsFor: 'purchases' stamp: 'JD 11/28/2021 01:39:30' prior: 50989808!
showPurchases

	| purchases catalogg totalSpent|

	catalogg := restInterface sendListCatalogRequest.
	purchases := restInterface sendListPurchasesRequestFor: username authenticatingWith: passwordHash.
	Transcript clear.
	totalSpent := 0.
	Transcript show: 'Book', '-', 'Quantity'.
	Transcript newLine.
	purchases keysDo: [:aBook | 
		| bookQuantity bookPrice |
		bookPrice := catalogg at: aBook.
		bookQuantity := (purchases at: aBook) / bookPrice.
		totalSpent := totalSpent + bookPrice.
		Transcript show: aBook, '-', bookQuantity asString.
		Transcript newLine.
	].
	Transcript show: 'Total: ', totalSpent asString, '$'.
	TranscriptWindow openTranscript.
! !

!classDefinition: #TusLibrosShopWindowModel category: 'TusLibros-View' stamp: 'JD 11/28/2021 01:39:53'!
TusLibrosWindowModel subclass: #TusLibrosShopWindowModel
	instanceVariableNames: 'cartId catalogListIndex itemQuantity cartListIndex catalog'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!
!TusLibrosShopWindowModel methodsFor: 'catalog' stamp: 'JD 11/28/2021 01:39:52' prior: 50990298!
listCatalog

	catalog := restInterface sendListCatalogRequest.
	^ self presentCatalog! !
!TusLibrosShopWindowModel methodsFor: 'catalog' stamp: 'JD 11/28/2021 01:40:05'!
presentCatalog
	
	| presentedCatalog |

	presentedCatalog := OrderedCollection new.
	catalog keysDo: [:aBook |
		| bookPrice |
		bookPrice := catalog at: aBook.
		presentedCatalog add: (aBook, '-', bookPrice asString, '$')
	].
	^ presentedCatalog! !

!methodRemoval: TusLibrosShopWindowModel #presentCatalog: stamp: 'JD 11/28/2021 01:40:07'!
presentCatalog: aCatalog
	
	| presentedCatalog |

	presentedCatalog := OrderedCollection new.
	aCatalog keysDo: [:aBook |
		| bookPrice |
		bookPrice := aCatalog at: aBook.
		presentedCatalog add: (aBook, '-', bookPrice asString, '$')
	].
	^ presentedCatalog!
!TusLibrosShopWindowModel methodsFor: 'purchases' stamp: 'JD 11/28/2021 01:40:39' prior: 50990305!
showPurchases

	| purchases totalSpent|

	purchases := restInterface sendListPurchasesRequestFor: username authenticatingWith: passwordHash.
	Transcript clear.
	totalSpent := 0.
	Transcript show: 'Book', '-', 'Quantity'.
	Transcript newLine.
	purchases keysDo: [:aBook | 
		| bookQuantity bookPrice |
		bookPrice := catalog at: aBook.
		bookQuantity := (purchases at: aBook) / bookPrice.
		totalSpent := totalSpent + bookPrice.
		Transcript show: aBook, '-', bookQuantity asString.
		Transcript newLine.
	].
	Transcript show: 'Total: ', totalSpent asString, '$'.
	TranscriptWindow openTranscript.
! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| aHash256Algorithm userAndPassword catalog |
	
	aHash256Algorithm := SecureHashAlgorithm256 new.
	
	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: (aHash256Algorithm hashMessage: '2') asString.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| aHash256Algorithm userAndPassword catalog |
	
	aHash256Algorithm := SecureHashAlgorithm256 new.
	
	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: (aHash256Algorithm hashMessage: '2') asString.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!
!TusLibrosShopWindowModel methodsFor: 'cart' stamp: 'JD 11/28/2021 01:45:02' prior: 50986267!
addToCart

	| books |

	books := catalog keys.
	restInterface sendAddToCartRequest: itemQuantity of: (books at: catalogListIndex) to: cartId.
	self triggerEvent: #cartModified
	! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| aHash256Algorithm userAndPassword catalog |
	
	aHash256Algorithm := SecureHashAlgorithm256 new.
	
	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: (aHash256Algorithm hashMessage: '2') asString.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

!classDefinition: #TusLibrosShopWindowModel category: 'TusLibros-View' stamp: 'JD 11/28/2021 01:57:40'!
TusLibrosWindowModel subclass: #TusLibrosShopWindowModel
	instanceVariableNames: 'cartId catalogListIndex itemQuantity cartListIndex catalog cart'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-View'!
!TusLibrosShopWindowModel methodsFor: 'cart' stamp: 'JD 11/28/2021 01:57:38' prior: 50986333!
listCart

	cart := restInterface sendListCartRequest: cartId.
	^ cart! !
!TusLibrosShopWindowModel methodsFor: 'cart' stamp: 'JD 11/28/2021 01:57:59' prior: 50986384!
removeFromCart
	
	| aBookToRemove |
	
	aBookToRemove := cart at: cartListIndex.
	restInterface sendRemoveFromCartRequest: aBookToRemove from: cartId.
	
	self triggerEvent: #cartModified
	! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| aHash256Algorithm userAndPassword catalog |
	
	aHash256Algorithm := SecureHashAlgorithm256 new.
	
	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: (aHash256Algorithm hashMessage: '2') asString.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!
!TusLibrosWindowModel methodsFor: 'credentials' stamp: 'JD 11/28/2021 02:00:34' overrides: 16896425!
initialize
	
	restInterface := TusLibrosRestInterface new! !
!TusLibrosLogInWindowModel methodsFor: 'initialization' stamp: 'JD 11/28/2021 02:00:48' prior: 50986455 overrides: 50990517!
initialize
	
	super initialize.	
	username := ''.
	password := ''.! !
!TusLibrosShopWindowModel methodsFor: 'initialization' stamp: 'JD 11/28/2021 02:01:02' prior: 50989849!
initializeFor: aCartId authenticating: aUsername with: aPasswordHash
	
	super initialize.		
	cartId := aCartId.
	username := aUsername.
	passwordHash := aPasswordHash.
	catalogListIndex := 1.
	cartListIndex := 1.
	itemQuantity := '1'.! !
!TusLibrosTicketWindowModel methodsFor: 'initialization' stamp: 'JD 11/28/2021 02:01:20' prior: 50989754!
initializeFor: aCheckoutedCart authenticating: 	aUsername with: aPasswordHash
	
	super initialize.	
	cart := aCheckoutedCart.
	username := aUsername.
	passwordHash := aPasswordHash.! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| aHash256Algorithm userAndPassword catalog |
	
	aHash256Algorithm := SecureHashAlgorithm256 new.
	
	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: (aHash256Algorithm hashMessage: '2') asString.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

----SNAPSHOT----(28 November 2021 02:02:22) CuisUniversity-4972.image priorSource: 21076589!
!TusLibrosWindow methodsFor: 'events actions' stamp: 'JD 11/28/2021 02:03:28'!
dismissSubmorphs

	^ self layoutMorph submorphs do: [:aSubmorph | aSubmorph dismissMorph]! !
!TusLibrosWindow methodsFor: 'events actions' stamp: 'JD 11/28/2021 02:03:28' prior: 50989963!
redirectToCatalogWindowWith: aCartId

	self model: (TusLibrosShopWindowModel newFor: aCartId authenticating: self model usernameText with: self model passwordHash).
	self setLabel: 'Catalog'.
	self dismissSubmorphs.
	self buildMorphicCatalogWindow.

	self model when: #cartModified send: #refreshCartList to: self.
	self model when: #cartCheckouted send: #redirectToTicketWindow to: self! !
!TusLibrosWindow methodsFor: 'events actions' stamp: 'JD 11/28/2021 02:03:28' prior: 50989678!
redirectToTicketWindow
	
	self model: (TusLibrosTicketWindowModel newFor: self model listCart authenticating: 	self model usernameText with: self model passwordHash).
	self setLabel: 'Checkout Completed'.
	self dismissSubmorphs.
	self buildMorphicTicketWindow.

	self model when: #loggedOut send: #redirectToLoginWindow to: self.
	self model when: #newCartRequested send: #redirectToCatalogWindowWith: to: self! !
!TusLibrosWindow methodsFor: 'events actions' stamp: 'JD 11/28/2021 02:03:28' prior: 50986834!
redirectToLoginWindow
	
	self dismissSubmorphs.
	self initializeWithTitle: self class logInTitle.! !
!TusLibrosWindow methodsFor: 'events actions' stamp: 'JD 11/28/2021 02:04:10' prior: 50990582!
redirectToCatalogWindowWith: aCartId

	self model: (TusLibrosShopWindowModel newFor: aCartId authenticating: self model usernameText with: self model passwordHash).
	self setLabel: 'Shop'.
	self dismissSubmorphs.
	self buildMorphicCatalogWindow.

	self model when: #cartModified send: #refreshCartList to: self.
	self model when: #cartCheckouted send: #redirectToTicketWindow to: self! !
!TusLibrosWindow methodsFor: 'events actions' stamp: 'JD 11/28/2021 02:04:24'!
redirectToShopWindowWith: aCartId

	self model: (TusLibrosShopWindowModel newFor: aCartId authenticating: self model usernameText with: self model passwordHash).
	self setLabel: 'Shop'.
	self dismissSubmorphs.
	self buildMorphicCatalogWindow.

	self model when: #cartModified send: #refreshCartList to: self.
	self model when: #cartCheckouted send: #redirectToTicketWindow to: self! !

!methodRemoval: TusLibrosWindow #redirectToCatalogWindowWith: stamp: 'JD 11/28/2021 02:04:24'!
redirectToCatalogWindowWith: aCartId

	self model: (TusLibrosShopWindowModel newFor: aCartId authenticating: self model usernameText with: self model passwordHash).
	self setLabel: 'Shop'.
	self dismissSubmorphs.
	self buildMorphicCatalogWindow.

	self model when: #cartModified send: #refreshCartList to: self.
	self model when: #cartCheckouted send: #redirectToTicketWindow to: self!
!TusLibrosWindow methodsFor: 'events actions' stamp: 'JD 11/28/2021 02:04:46' prior: 50990576!
dismissSubmorphs

	self layoutMorph submorphs do: [:aSubmorph | aSubmorph dismissMorph]! !
!TusLibrosWindow methodsFor: 'events actions' stamp: 'JD 11/28/2021 02:05:45' prior: 50990598!
redirectToTicketWindow
	
	self model: (TusLibrosTicketWindowModel newFor: self model listCart authenticating: self model usernameText with: self model passwordHash).
	self setLabel: 'Checkout Completed'.
	self dismissSubmorphs.
	self buildMorphicTicketWindow.

	self model when: #loggedOut send: #redirectToLoginWindow to: self.
	self model when: #newCartRequested send: #redirectToCatalogWindowWith: to: self! !
!TusLibrosWindow methodsFor: 'windows morphs build' stamp: 'JD 11/28/2021 02:06:42'!
buildMorphicShopWindow
		
	self layoutMorph beColumn;
	separation: 10;
	axisEdgeWeight: 0;
	addMorph: self buildCatalogAndAddToCartRow;
	addMorph: self buildCartRow;
	addMorph: self buildCheckoutAndPurchasesButtons! !
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/28/2021 02:06:42' prior: 50990636!
redirectToShopWindowWith: aCartId

	self model: (TusLibrosShopWindowModel newFor: aCartId authenticating: self model usernameText with: self model passwordHash).
	self setLabel: 'Shop'.
	self dismissSubmorphs.
	self buildMorphicShopWindow.

	self model when: #cartModified send: #refreshCartList to: self.
	self model when: #cartCheckouted send: #redirectToTicketWindow to: self! !

!methodRemoval: TusLibrosWindow #buildMorphicCatalogWindow stamp: 'JD 11/28/2021 02:06:42'!
buildMorphicCatalogWindow
		
	self layoutMorph beColumn;
	separation: 10;
	axisEdgeWeight: 0;
	addMorph: self buildCatalogAndAddToCartRow;
	addMorph: self buildCartRow;
	addMorph: self buildCheckoutAndPurchasesButtons!
!TusLibrosWindow methodsFor: 'initialization' stamp: 'JD 11/28/2021 02:07:07' prior: 50985912!
initializeWithTitle: aTitle

	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: aTitle.
	self model: (TusLibrosLogInWindowModel new).
	self morphExtent: 1035@485.
	self buildMorphicWindow.
	self openInWorld.
			
	self model when: #newCartCreated send: #redirectToShopWindowWith: to: self! !
!TusLibrosWindow methodsFor: 'ticket - layouts' stamp: 'JD 11/28/2021 02:08:38' prior: 50986212!
buildTicketColumn
	
	| ticketColumnLayoutMorph ticketListMorph |
	
	ticketListMorph := PluggableListMorph model: self model listGetter: #listTicket indexGetter: nil indexSetter: nil.
	ticketListMorph borderColor: Color skyBlue; borderWidth: 1; morphWidth:300.

	ticketColumnLayoutMorph := LayoutMorph newColumn.
	ticketColumnLayoutMorph separation: 5; 
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents: 'Ticket');
	addMorph: ticketListMorph;
	addMorph: self buildLogOutAndContinueBuyingButtons.
	
	^ ticketColumnLayoutMorph
	! !

----SNAPSHOT----(28 November 2021 02:10:45) CuisUniversity-4972.image priorSource: 21085505!
!TusLibrosWindow methodsFor: 'log in - layouts' stamp: 'JD 11/28/2021 02:12:58'!
setPropertyKeyStrokeToInnerTextMorphOf: usernameTextBoxMorph

	^ usernameTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | usernameTextBoxMorph innerTextMorph acceptContents ]! !
!TusLibrosWindow methodsFor: 'log in - layouts' stamp: 'JD 11/28/2021 02:12:58' prior: 50986025!
buildUsernameRow
	| firstRowLayoutMorph usernameTextBoxMorph |
	
	usernameTextBoxMorph := TextModelMorph textProvider: self model textGetter: #usernameText textSetter: #usernameText:. 
	self setPropertyKeyStrokeToInnerTextMorphOf: usernameTextBoxMorph .
	usernameTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300; morphHeight: 30. 
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 5;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents: 'Username');
	addMorph: usernameTextBoxMorph.
	
	^ firstRowLayoutMorph.! !
!TusLibrosWindow methodsFor: 'log in - layouts' stamp: 'JD 11/28/2021 02:13:21' prior: 50986002!
buildPasswordRow
	| secondRowLayoutMorph passwordTextBoxMorph |
	
	passwordTextBoxMorph := TextModelMorph textProvider: self model textGetter: #passwordText textSetter: #passwordText:. 
	self setPropertyKeyStrokeToInnerTextMorphOf: passwordTextBoxMorph.
	passwordTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300; morphHeight: 30.
		
	secondRowLayoutMorph := LayoutMorph newRow.
	secondRowLayoutMorph separation: 5;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents: 'Password');
	addMorph: passwordTextBoxMorph.
	
	^ secondRowLayoutMorph.! !
!TusLibrosWindow methodsFor: 'log in - layouts' stamp: 'JD 11/28/2021 02:14:21' prior: 50989622!
buildCreateCartButtonRow
	| createCartButtonRowLayoutMorph sendRequestButtonMorph |
	
	sendRequestButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #createCart label: 'Create Cart'.

	createCartButtonRowLayoutMorph := LayoutMorph newRow.
	createCartButtonRowLayoutMorph separation: 5;
	axisEdgeWeight: 0.5;
	addMorph: sendRequestButtonMorph.
	
	^ createCartButtonRowLayoutMorph.! !
!TusLibrosWindow methodsFor: 'log in - layouts' stamp: 'JD 11/28/2021 02:14:34' prior: 50990812!
buildCreateCartButtonRow
	| createCartButtonRowLayoutMorph createCartButtonMorph |
	
	createCartButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #createCart label: 'Create Cart'.

	createCartButtonRowLayoutMorph := LayoutMorph newRow.
	createCartButtonRowLayoutMorph separation: 5;
	axisEdgeWeight: 0.5;
	addMorph: createCartButtonMorph.
	
	^ createCartButtonRowLayoutMorph.! !
!TusLibrosWindow methodsFor: 'log in - layouts' stamp: 'JD 11/28/2021 02:15:31'!
applyStyleTo: aLayoutMorph

	aLayoutMorph separation: 5.
	aLayoutMorph axisEdgeWeight: 0.5.! !
!TusLibrosWindow methodsFor: 'log in - layouts' stamp: 'JD 11/28/2021 02:16:09' prior: 50990828!
buildCreateCartButtonRow
	| createCartButtonRowLayoutMorph createCartButtonMorph |
	
	createCartButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #createCart label: 'Create Cart'.

	createCartButtonRowLayoutMorph := LayoutMorph newRow.
	self applyStyleTo: createCartButtonRowLayoutMorph.
	createCartButtonRowLayoutMorph addMorph: createCartButtonMorph.
	
	^ createCartButtonRowLayoutMorph.! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| aHash256Algorithm userAndPassword catalog |
	
	aHash256Algorithm := SecureHashAlgorithm256 new.
	
	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: (aHash256Algorithm hashMessage: '2') asString.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!
!TusLibrosWindow methodsFor: 'events actions' stamp: 'JD 11/28/2021 02:17:30' prior: 50990673!
redirectToTicketWindow
	
	self model: (TusLibrosTicketWindowModel newFor: self model listCart authenticating: self model usernameText with: self model passwordHash).
	self setLabel: 'Checkout Completed'.
	self dismissSubmorphs.
	self buildMorphicTicketWindow.

	self model when: #loggedOut send: #redirectToLoginWindow to: self.
	self model when: #newCartRequested send: #redirectToShopWindowWith: to: self! !
!TusLibrosWindow methodsFor: 'log in - layouts' stamp: 'JD 11/28/2021 02:18:48' prior: 50985989!
buildLogInColumn
	| firstColumnLayoutMorph |
		
	firstColumnLayoutMorph := LayoutMorph newColumn.
	self applyStyleTo: firstColumnLayoutMorph.
	firstColumnLayoutMorph 
		addMorph: self buildUsernameRow;
		addMorph: self buildPasswordRow;
		addMorph: self buildCreateCartButtonRow.
	
	^ firstColumnLayoutMorph.! !
!TusLibrosWindow methodsFor: 'log in - layouts' stamp: 'JD 11/28/2021 02:19:08' prior: 50990905!
buildLogInColumn
	| loginColumnLayoutMorph |
		
	loginColumnLayoutMorph := LayoutMorph newColumn.
	self applyStyleTo: loginColumnLayoutMorph.
	loginColumnLayoutMorph 
		addMorph: self buildUsernameRow;
		addMorph: self buildPasswordRow;
		addMorph: self buildCreateCartButtonRow.
	
	^ loginColumnLayoutMorph.! !
!TusLibrosWindow methodsFor: 'log in - layouts' stamp: 'JD 11/28/2021 02:20:07'!
buildLoginColumn
	| loginColumnLayoutMorph |
		
	loginColumnLayoutMorph := LayoutMorph newColumn.
	self applyStyleTo: loginColumnLayoutMorph.
	loginColumnLayoutMorph 
		addMorph: self buildUsernameRow;
		addMorph: self buildPasswordRow;
		addMorph: self buildCreateCartButtonRow.
	
	^ loginColumnLayoutMorph.! !
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/28/2021 02:20:07' prior: 50986067 overrides: 50972174!
buildMorphicWindow
		
	self layoutMorph beRow;
	separation: 150;
	axisEdgeWeight: 0;
	addMorph: self buildLoginColumn.! !

!methodRemoval: TusLibrosWindow #buildLogInColumn stamp: 'JD 11/28/2021 02:20:07'!
buildLogInColumn
	| loginColumnLayoutMorph |
		
	loginColumnLayoutMorph := LayoutMorph newColumn.
	self applyStyleTo: loginColumnLayoutMorph.
	loginColumnLayoutMorph 
		addMorph: self buildUsernameRow;
		addMorph: self buildPasswordRow;
		addMorph: self buildCreateCartButtonRow.
	
	^ loginColumnLayoutMorph.!
!TusLibrosWindow methodsFor: 'log in - layouts' stamp: 'JD 11/28/2021 02:20:31' prior: 50990791!
buildPasswordRow
	| passwordRowLayoutMorph passwordTextBoxMorph |
	
	passwordTextBoxMorph := TextModelMorph textProvider: self model textGetter: #passwordText textSetter: #passwordText:. 
	self setPropertyKeyStrokeToInnerTextMorphOf: passwordTextBoxMorph.
	passwordTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300; morphHeight: 30.
		
	passwordRowLayoutMorph := LayoutMorph newRow.
	passwordRowLayoutMorph separation: 5;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents: 'Password');
	addMorph: passwordTextBoxMorph.
	
	^ passwordRowLayoutMorph.! !
!TusLibrosWindow methodsFor: 'log in - layouts' stamp: 'JD 11/28/2021 02:21:04' prior: 50990965!
buildPasswordRow
	| passwordRowLayoutMorph passwordTextBoxMorph |
	
	passwordTextBoxMorph := TextModelMorph textProvider: self model textGetter: #passwordText textSetter: #passwordText:. 
	self setPropertyKeyStrokeToInnerTextMorphOf: passwordTextBoxMorph.
	passwordTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300; morphHeight: 30.
		
	passwordRowLayoutMorph := LayoutMorph newRow.
	self applyStyleTo: passwordRowLayoutMorph.
	passwordRowLayoutMorph
		addMorph: (LabelMorph contents: 'Password');
		addMorph: passwordTextBoxMorph.
	
	^ passwordRowLayoutMorph.! !
!TusLibrosWindow methodsFor: 'log in - layouts' stamp: 'JD 11/28/2021 02:21:28' prior: 50990770!
buildUsernameRow
	| firstRowLayoutMorph usernameTextBoxMorph |
	
	usernameTextBoxMorph := TextModelMorph textProvider: self model textGetter: #usernameText textSetter: #usernameText:. 
	self setPropertyKeyStrokeToInnerTextMorphOf: usernameTextBoxMorph .
	usernameTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300; morphHeight: 30. 
		
	firstRowLayoutMorph := LayoutMorph newRow.
	self applyStyleTo: firstRowLayoutMorph.
	firstRowLayoutMorph
		addMorph: (LabelMorph contents: 'Username');
		addMorph: usernameTextBoxMorph.
	
	^ firstRowLayoutMorph.! !
!TusLibrosWindow methodsFor: 'log in - layouts' stamp: 'JD 11/28/2021 02:21:40' prior: 50991009!
buildUsernameRow
	| usernameRowLayoutMorph usernameTextBoxMorph |
	
	usernameTextBoxMorph := TextModelMorph textProvider: self model textGetter: #usernameText textSetter: #usernameText:. 
	self setPropertyKeyStrokeToInnerTextMorphOf: usernameTextBoxMorph .
	usernameTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300; morphHeight: 30. 
		
	usernameRowLayoutMorph := LayoutMorph newRow.
	self applyStyleTo: usernameRowLayoutMorph.
	usernameRowLayoutMorph
		addMorph: (LabelMorph contents: 'Username');
		addMorph: usernameTextBoxMorph.
	
	^ usernameRowLayoutMorph.! !
!TusLibrosWindow methodsFor: 'log in - layouts' stamp: 'JD 11/28/2021 02:21:42' prior: 50991030!
buildUsernameRow

	| usernameRowLayoutMorph usernameTextBoxMorph |
	
	usernameTextBoxMorph := TextModelMorph textProvider: self model textGetter: #usernameText textSetter: #usernameText:. 
	self setPropertyKeyStrokeToInnerTextMorphOf: usernameTextBoxMorph .
	usernameTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300; morphHeight: 30. 
		
	usernameRowLayoutMorph := LayoutMorph newRow.
	self applyStyleTo: usernameRowLayoutMorph.
	usernameRowLayoutMorph
		addMorph: (LabelMorph contents: 'Username');
		addMorph: usernameTextBoxMorph.
	
	^ usernameRowLayoutMorph.! !
!TusLibrosWindow methodsFor: 'shop - layouts' stamp: 'JD 11/28/2021 02:22:33' prior: 50986074!
buildCart

	| column |

	cartListMorph := PluggableListMorph model: self model listGetter: #listCart indexGetter: #cartListIndex indexSetter: #cartListIndex:.
	cartListMorph borderColor: Color skyBlue; borderWidth: 1; morphWidth:300.
	
	column := LayoutMorph newColumn.
	self applyStyleTo: column.
	column
		addMorph: (LabelMorph contents: 'Cart');
		addMorph: cartListMorph.

	^ column! !
!TusLibrosWindow methodsFor: 'shop - layouts' stamp: 'JD 11/28/2021 02:22:48' prior: 50991074!
buildCart

	| cartColumnLayoutMorph |

	cartListMorph := PluggableListMorph model: self model listGetter: #listCart indexGetter: #cartListIndex indexSetter: #cartListIndex:.
	cartListMorph borderColor: Color skyBlue; borderWidth: 1; morphWidth:300.
	
	cartColumnLayoutMorph := LayoutMorph newColumn.
	self applyStyleTo: cartColumnLayoutMorph.
	cartColumnLayoutMorph
		addMorph: (LabelMorph contents: 'Cart');
		addMorph: cartListMorph.

	^ cartColumnLayoutMorph! !
!TusLibrosWindow methodsFor: 'shop - layouts' stamp: 'JD 11/28/2021 02:23:30' prior: 50986109!
buildCatalogColumn

	| catalogListMorph column |

	catalogListMorph := PluggableListMorph model: self model listGetter: #listCatalog indexGetter: #catalogListIndex indexSetter: #catalogListIndex:.
	catalogListMorph borderColor: Color skyBlue; borderWidth: 1; morphWidth:300.
	
	column := LayoutMorph newColumn.
	self applyStyleTo: column.
	column
		addMorph: (LabelMorph contents: 'Catalog');
		addMorph: catalogListMorph.
	
	^ column! !
!TusLibrosWindow methodsFor: 'shop - layouts' stamp: 'JD 11/28/2021 02:23:43' prior: 50991108!
buildCatalogColumn

	| catalogListMorph catalogColumnLayoutMorph |

	catalogListMorph := PluggableListMorph model: self model listGetter: #listCatalog indexGetter: #catalogListIndex indexSetter: #catalogListIndex:.
	catalogListMorph borderColor: Color skyBlue; borderWidth: 1; morphWidth:300.
	
	catalogColumnLayoutMorph := LayoutMorph newColumn.
	self applyStyleTo: catalogColumnLayoutMorph.
	catalogColumnLayoutMorph
		addMorph: (LabelMorph contents: 'Catalog');
		addMorph: catalogListMorph.
	
	^ catalogColumnLayoutMorph! !
!TusLibrosWindow methodsFor: 'shop - layouts' stamp: 'JD 11/28/2021 02:24:05' prior: 50986126!
buildCheckoutAndPurchasesButtons

	| buttonsLayoutMorph checkoutCartButtonMorph showPurchasesButtonMorph |

	checkoutCartButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #checkoutCart label: 'Checkout Cart'.
	
	showPurchasesButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #showPurchases label: 'Show Purchases'.
	
	buttonsLayoutMorph := LayoutMorph newRow.
	self applyStyleTo: buttonsLayoutMorph.
	buttonsLayoutMorph
		addMorph: checkoutCartButtonMorph;
		addMorph: showPurchasesButtonMorph.
	
	^ buttonsLayoutMorph! !
!TusLibrosWindow methodsFor: 'shop - layouts' stamp: 'JD 11/28/2021 02:24:30' prior: 50986148!
buildItemQuantityAndAddToCartButtonColumn
	
	| addToCartButtonMorph itemQuantityTextBoxMorph column |
	
	itemQuantityTextBoxMorph := TextModelMorph textProvider: self model textGetter: #itemQuantityText textSetter: #itemQuantityText:. 
	itemQuantityTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | itemQuantityTextBoxMorph innerTextMorph acceptContents].
	itemQuantityTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 25; morphHeight: 25.
	
	addToCartButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #addToCart  label: 'Add To Cart'.
	
	column := LayoutMorph newColumn.
	self applyStyleTo: column.
	column
		addMorph: (LabelMorph contents:'Quantity');
		addMorph: itemQuantityTextBoxMorph;
		addMorph: addToCartButtonMorph.
	
	^ column
! !
!TusLibrosWindow methodsFor: 'shop - layouts' stamp: 'JD 11/28/2021 02:25:02' prior: 50991167!
buildItemQuantityAndAddToCartButtonColumn
	
	| addToCartButtonMorph itemQuantityTextBoxMorph itemQuantityAndAddToCartColumnLayoutMorph |
	
	itemQuantityTextBoxMorph := TextModelMorph textProvider: self model textGetter: #itemQuantityText textSetter: #itemQuantityText:. 
	itemQuantityTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | itemQuantityTextBoxMorph innerTextMorph acceptContents].
	itemQuantityTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 25; morphHeight: 25.
	
	addToCartButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #addToCart  label: 'Add To Cart'.
	
	itemQuantityAndAddToCartColumnLayoutMorph := LayoutMorph newColumn.
	self applyStyleTo: itemQuantityAndAddToCartColumnLayoutMorph.
	itemQuantityAndAddToCartColumnLayoutMorph
		addMorph: (LabelMorph contents:'Quantity');
		addMorph: itemQuantityTextBoxMorph;
		addMorph: addToCartButtonMorph.
	
	^ itemQuantityAndAddToCartColumnLayoutMorph
! !
!TusLibrosWindow methodsFor: 'shop - layouts' stamp: 'JD 11/28/2021 02:25:36' prior: 50991196!
buildItemQuantityAndAddToCartButtonColumn
	
	| addToCartButtonMorph itemQuantityTextBoxMorph itemQuantityAndAddToCartColumnLayoutMorph |
	
	itemQuantityTextBoxMorph := TextModelMorph textProvider: self model textGetter: #itemQuantityText textSetter: #itemQuantityText:. 
	self setPropertyKeyStrokeToInnerTextMorphOf: itemQuantityTextBoxMorph.
	itemQuantityTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 25; morphHeight: 25.
	
	addToCartButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #addToCart  label: 'Add To Cart'.
	
	itemQuantityAndAddToCartColumnLayoutMorph := LayoutMorph newColumn.
	self applyStyleTo: itemQuantityAndAddToCartColumnLayoutMorph.
	itemQuantityAndAddToCartColumnLayoutMorph
		addMorph: (LabelMorph contents:'Quantity');
		addMorph: itemQuantityTextBoxMorph;
		addMorph: addToCartButtonMorph.
	
	^ itemQuantityAndAddToCartColumnLayoutMorph
! !
!TusLibrosWindow methodsFor: 'shop - layouts' stamp: 'JD 11/28/2021 02:25:51' prior: 50986177!
buildRemoveFromCartButtonColumn

	| removeFromCartButtonMorph column |

	removeFromCartButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #removeFromCart  label: 'Remove From Cart'.
	
	column := LayoutMorph newColumn.
	self applyStyleTo: column.
	column addMorph: removeFromCartButtonMorph.
	
	^ column
! !
!TusLibrosWindow methodsFor: 'shop - layouts' stamp: 'JD 11/28/2021 02:26:08' prior: 50991262!
buildRemoveFromCartButtonColumn

	| removeFromCartButtonMorph removeFromCartColumnLayoutMorph |

	removeFromCartButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #removeFromCart  label: 'Remove From Cart'.
	
	removeFromCartColumnLayoutMorph := LayoutMorph newColumn.
	self applyStyleTo: removeFromCartColumnLayoutMorph.
	removeFromCartColumnLayoutMorph addMorph: removeFromCartButtonMorph.
	
	^ removeFromCartColumnLayoutMorph
! !
!TusLibrosWindow methodsFor: 'ticket - layouts' stamp: 'JD 11/28/2021 02:26:39' prior: 50986191!
buildLogOutAndContinueBuyingButtons

	| buttonsLayoutMorph logOutButtonMorph continueBuyingButtonMorph |

	logOutButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #logOut label: 'Log Out'.
	
	continueBuyingButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #continueBuying label: 'Continue Buying'.
	
	buttonsLayoutMorph := LayoutMorph newRow.
	self applyStyleTo: buttonsLayoutMorph.
	buttonsLayoutMorph
		addMorph: logOutButtonMorph;
		addMorph: continueBuyingButtonMorph.
	
	^ buttonsLayoutMorph! !
!TusLibrosWindow methodsFor: 'ticket - layouts' stamp: 'JD 11/28/2021 02:27:04' prior: 50990737!
buildTicketColumn
	
	| ticketColumnLayoutMorph ticketListMorph |
	
	ticketListMorph := PluggableListMorph model: self model listGetter: #listTicket indexGetter: nil indexSetter: nil.
	ticketListMorph borderColor: Color skyBlue; borderWidth: 1; morphWidth:300.

	ticketColumnLayoutMorph := LayoutMorph newColumn.
	self applyStyleTo: ticketColumnLayoutMorph.
	ticketColumnLayoutMorph
		addMorph: (LabelMorph contents: 'Ticket');
		addMorph: ticketListMorph;
		addMorph: self buildLogOutAndContinueBuyingButtons.
	
	^ ticketColumnLayoutMorph
	! !
!TusLibrosWindow methodsFor: 'log in - layouts' stamp: 'JD 11/28/2021 02:30:02' prior: 50990850!
buildCreateCartButtonRow

	| createCartButtonRowLayoutMorph createCartButtonMorph |
	
	createCartButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #createCart label: 'Create Cart'.

	createCartButtonRowLayoutMorph := LayoutMorph newRow.
	self applyStyleTo: createCartButtonRowLayoutMorph.
	createCartButtonRowLayoutMorph addMorph: createCartButtonMorph.
	
	^ createCartButtonRowLayoutMorph.! !
!TusLibrosWindow methodsFor: 'log in - layouts' stamp: 'JD 11/28/2021 02:30:05' prior: 50990931!
buildLoginColumn

	| loginColumnLayoutMorph |
		
	loginColumnLayoutMorph := LayoutMorph newColumn.
	self applyStyleTo: loginColumnLayoutMorph.
	loginColumnLayoutMorph 
		addMorph: self buildUsernameRow;
		addMorph: self buildPasswordRow;
		addMorph: self buildCreateCartButtonRow.
	
	^ loginColumnLayoutMorph.! !
!TusLibrosWindow methodsFor: 'log in - layouts' stamp: 'JD 11/28/2021 02:30:08' prior: 50990987!
buildPasswordRow

	| passwordRowLayoutMorph passwordTextBoxMorph |
	
	passwordTextBoxMorph := TextModelMorph textProvider: self model textGetter: #passwordText textSetter: #passwordText:. 
	self setPropertyKeyStrokeToInnerTextMorphOf: passwordTextBoxMorph.
	passwordTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300; morphHeight: 30.
		
	passwordRowLayoutMorph := LayoutMorph newRow.
	self applyStyleTo: passwordRowLayoutMorph.
	passwordRowLayoutMorph
		addMorph: (LabelMorph contents: 'Password');
		addMorph: passwordTextBoxMorph.
	
	^ passwordRowLayoutMorph.! !
!TusLibrosWindow methodsFor: 'shop - layouts' stamp: 'JD 11/28/2021 02:30:50' prior: 50986090!
buildCartRow
	
	| cartRowLayoutMorph |

	cartRowLayoutMorph := LayoutMorph newRow.
	cartRowLayoutMorph separation: 20;
	axisEdgeWeight: 0.5;
	addMorph: self buildCart;
	addMorph: self buildRemoveFromCartButtonColumn.
	
	^ cartRowLayoutMorph
	! !
!TusLibrosWindow methodsFor: 'shop - layouts' stamp: 'JD 11/28/2021 02:31:21' prior: 50986099!
buildCatalogAndAddToCartRow
	
	| catalogAndAddToCartRowLayoutMorph |

	catalogAndAddToCartRowLayoutMorph := LayoutMorph newRow.
	catalogAndAddToCartRowLayoutMorph separation: 20;
	axisEdgeWeight: 0.5;
	addMorph: self buildCatalogColumn;
	addMorph: self buildItemQuantityAndAddToCartButtonColumn.
	
	^ catalogAndAddToCartRowLayoutMorph
	! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| aHash256Algorithm userAndPassword catalog |
	
	aHash256Algorithm := SecureHashAlgorithm256 new.
	
	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: (aHash256Algorithm hashMessage: '2') asString.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

----SNAPSHOT----(28 November 2021 02:32:40) CuisUniversity-4972.image priorSource: 21091381!
!TusLibrosShopWindowModel methodsFor: 'purchases' stamp: 'JD 11/28/2021 02:37:40' prior: 50990367!
showPurchases

	| purchases totalSpent|

	purchases := restInterface sendListPurchasesRequestFor: username authenticatingWith: passwordHash.
	
	Transcript clear.
	
	purchases isEmpty 
		ifTrue: [Transcript show: 'Your purchases list is empty.']
		ifFalse: 
		[
			totalSpent := 0.
			Transcript show: 'Book', '-', 'Quantity'.
			Transcript newLine.
			purchases keysDo: [:aBook | 
				| bookQuantity bookPrice |
				bookPrice := catalog at: aBook.
				bookQuantity := (purchases at: aBook) / bookPrice.
				totalSpent := totalSpent + bookPrice.
				Transcript show: aBook, '-', bookQuantity asString.
				Transcript newLine.
			].
			Transcript show: 'Total: ', totalSpent asString, '$'.
		 ].

	TranscriptWindow openTranscript.
! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| aHash256Algorithm userAndPassword catalog |
	
	aHash256Algorithm := SecureHashAlgorithm256 new.
	
	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: (aHash256Algorithm hashMessage: '2') asString.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!
!TusLibrosWindowModel methodsFor: 'nil' stamp: 'JD 11/28/2021 02:51:25'!
try: aBlock failingWithError: anErrorDescription
	
	aBlock
		on: Error
		do: [
			Transcript clear.
			Transcript show: anErrorDescription.
			TranscriptWindow openTranscript.
		]! !
!TusLibrosLogInWindowModel methodsFor: 'create cart' stamp: 'JD 11/28/2021 02:53:16' prior: 50989719!
createCart
	
	| aHash256Algorithm cartId |
	
	aHash256Algorithm := SecureHashAlgorithm256 new.
	passwordHash := aHash256Algorithm hashMessage: password asString.
	
	self try: [
		cartId := restInterface sendCreateCartRequestWith: username and: passwordHash.
		self triggerEvent: #newCartCreated with: cartId.
		cartId
	]
	! !
!TusLibrosWindowModel methodsFor: 'error handling' stamp: 'JD 11/28/2021 02:53:55'!
try: aBlock
	
	aBlock
		on: Error
		do: [:anError |
			Transcript clear.
			Transcript show: anError messageText.
			TranscriptWindow openTranscript.
		]! !

----SNAPSHOT----(28 November 2021 02:54:08) CuisUniversity-4972.image priorSource: 21113148!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| aHash256Algorithm userAndPassword catalog |
	
	aHash256Algorithm := SecureHashAlgorithm256 new.
	
	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: (aHash256Algorithm hashMessage: '2') asString.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!
!TusLibrosLogInWindowModel methodsFor: 'create cart' stamp: 'JD 11/28/2021 02:55:11' prior: 50991501!
createCart
	
	| aHash256Algorithm cartId |
	
	aHash256Algorithm := SecureHashAlgorithm256 new.
	passwordHash := aHash256Algorithm hashMessage: password asString.
	
	cartId := restInterface sendCreateCartRequestWith: username and: passwordHash.
	self triggerEvent: #newCartCreated with: cartId.
! !

aResponse content!

aResponse content!

'<html><head><title>400 Bad Request</title></head><body><h1>400 Bad Request</h1><p>Invalid user and/or password</p></body></html>' asUnHtml!

'<html><head><title>400 Bad Request</title></head><body><h1>400 Bad Request</h1><p>Invalid user and/or password</p></body></html>' asUnHtml !

'<html><head><title>400 Bad Request</title></head><body><h1>400 Bad Request</h1><p>Invalid user and/or password</p></body></html>' asUnHtml asOrderedCollection!

'<html><head><title>400 Bad Request</title></head><body><h1>400 Bad Request</h1><p>Invalid user and/or password</p></body></html>' asUnHtml!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!
!TusLibrosLogInWindowModel methodsFor: 'create cart' stamp: 'JD 11/28/2021 03:23:01' prior: 50991548!
createCart
	
	| aHash256Algorithm cartId |
	
	aHash256Algorithm := SecureHashAlgorithm256 new.
	passwordHash := aHash256Algorithm hashMessage: password asString.
	
	self 
		try: [
			cartId := restInterface sendCreateCartRequestWith: username and: passwordHash.
			self triggerEvent: #newCartCreated with: cartId.
		]
		failingWithErrorDescription: 'User or password is invalid. Verify your credentials and try again.'
	
	! !
!TusLibrosWindowModel methodsFor: 'error handling' stamp: 'JD 11/28/2021 03:23:20'!
try: aBlock failingWithErrorDescription: anErrorDescription
	
	aBlock
		on: Error
		do: [
			Transcript clear.
			Transcript show: anErrorDescription.
			TranscriptWindow openTranscript.
		]! !

!methodRemoval: TusLibrosWindowModel #try:failingWithError: stamp: 'JD 11/28/2021 03:23:20'!
try: aBlock failingWithError: anErrorDescription
	
	aBlock
		on: Error
		do: [
			Transcript clear.
			Transcript show: anErrorDescription.
			TranscriptWindow openTranscript.
		]!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| aHash256Algorithm userAndPassword catalog |
	
	aHash256Algorithm := SecureHashAlgorithm256 new.
	
	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: (aHash256Algorithm hashMessage: '2') asString.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.
	!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

!methodRemoval: TusLibrosWindowModel #try: stamp: 'JD 11/28/2021 03:24:52'!
try: aBlock
	
	aBlock
		on: Error
		do: [:anError |
			Transcript clear.
			Transcript show: anError messageText.
			TranscriptWindow openTranscript.
		]!
!TusLibrosLogInWindowModel methodsFor: 'create cart' stamp: 'JD 11/28/2021 03:25:17' prior: 50991583!
createCart
	
	| aHash256Algorithm cartId |
	
	aHash256Algorithm := SecureHashAlgorithm256 new.
	passwordHash := aHash256Algorithm hashMessage: password asString.
	
	self 
		try: [
			cartId := restInterface sendCreateCartRequestWith: username and: passwordHash.
			self triggerEvent: #newCartCreated with: cartId.
		]
		failingWithErrorDescription: 'User or password are invalid. Verify your credentials and try again.'
	
	! !
!TusLibrosShopWindowModel methodsFor: 'cart' stamp: 'JD 11/28/2021 03:27:13' prior: 50990435!
addToCart

	| books |

	books := catalog keys.
	self
		try: [
			restInterface sendAddToCartRequest: itemQuantity of: (books at: catalogListIndex) to: cartId.
			self triggerEvent: #cartModified
		]
		failingWithErrorDescription: 'Item quantity must be positive.'
	! !
!TusLibrosShopWindowModel methodsFor: 'cart' stamp: 'JD 11/28/2021 03:28:45' prior: 50990485!
removeFromCart
	
	| aBookToRemove |
	
	aBookToRemove := cart at: cartListIndex.

	self
		try: [
			restInterface sendRemoveFromCartRequest: aBookToRemove from: cartId.
			self triggerEvent: #cartModified
		]
		failingWithErrorDescription: 'Select an item to remove.'
	! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| aHash256Algorithm userAndPassword catalog |
	
	aHash256Algorithm := SecureHashAlgorithm256 new.
	
	userAndPassword := Dictionary new.
	userAndPassword at: '1' put: (aHash256Algorithm hashMessage: '2') asString.
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.

	TusLibrosServer listeningOn: 8080 authenticatingWith: userAndPassword acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: DateAndTime. 
	
	TusLibrosWindow open.!
!TusLibrosShopWindowModel methodsFor: 'cart' stamp: 'JD 11/28/2021 03:31:21' prior: 50991680!
removeFromCart

	self
		try: [
			| aBookToRemove |
			aBookToRemove := cart at: cartListIndex.
			restInterface sendRemoveFromCartRequest: aBookToRemove from: cartId.
			self triggerEvent: #cartModified
		]
		failingWithErrorDescription: 'Select an item to remove.'
	! !
!TusLibrosShopWindowModel methodsFor: 'cart' stamp: 'JD 11/28/2021 03:32:47' prior: 50991668!
addToCart

	| books |

	books := catalog keys.
	self
		try: [
			restInterface sendAddToCartRequest: itemQuantity of: (books at: catalogListIndex) to: cartId.
			self triggerEvent: #cartModified
		]
		failingWithErrorDescription: 'Item quantity must at least one.'
	! !

----SNAPSHOT----(28 November 2021 03:33:12) CuisUniversity-4972.image priorSource: 21115868!
!TusLibrosWindow methodsFor: 'ticket - layouts' stamp: 'JD 11/28/2021 03:34:12'!
buildLogOutAndContinueBuyingButtonsRow

	| buttonsLayoutMorph logOutButtonMorph continueBuyingButtonMorph |

	logOutButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #logOut label: 'Log Out'.
	
	continueBuyingButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #continueBuying label: 'Continue Buying'.
	
	buttonsLayoutMorph := LayoutMorph newRow.
	self applyStyleTo: buttonsLayoutMorph.
	buttonsLayoutMorph
		addMorph: logOutButtonMorph;
		addMorph: continueBuyingButtonMorph.
	
	^ buttonsLayoutMorph! !
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/28/2021 03:34:12' prior: 50991315!
buildTicketColumn
	
	| ticketColumnLayoutMorph ticketListMorph |
	
	ticketListMorph := PluggableListMorph model: self model listGetter: #listTicket indexGetter: nil indexSetter: nil.
	ticketListMorph borderColor: Color skyBlue; borderWidth: 1; morphWidth:300.

	ticketColumnLayoutMorph := LayoutMorph newColumn.
	self applyStyleTo: ticketColumnLayoutMorph.
	ticketColumnLayoutMorph
		addMorph: (LabelMorph contents: 'Ticket');
		addMorph: ticketListMorph;
		addMorph: self buildLogOutAndContinueBuyingButtonsRow.
	
	^ ticketColumnLayoutMorph
	! !

!methodRemoval: TusLibrosWindow #buildLogOutAndContinueBuyingButtons stamp: 'JD 11/28/2021 03:34:12'!
buildLogOutAndContinueBuyingButtons

	| buttonsLayoutMorph logOutButtonMorph continueBuyingButtonMorph |

	logOutButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #logOut label: 'Log Out'.
	
	continueBuyingButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #continueBuying label: 'Continue Buying'.
	
	buttonsLayoutMorph := LayoutMorph newRow.
	self applyStyleTo: buttonsLayoutMorph.
	buttonsLayoutMorph
		addMorph: logOutButtonMorph;
		addMorph: continueBuyingButtonMorph.
	
	^ buttonsLayoutMorph!
!TusLibrosWindow methodsFor: 'shop - layouts' stamp: 'JD 11/28/2021 03:34:43'!
buildCheckoutAndPurchasesButtonsRow

	| buttonsLayoutMorph checkoutCartButtonMorph showPurchasesButtonMorph |

	checkoutCartButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #checkoutCart label: 'Checkout Cart'.
	
	showPurchasesButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #showPurchases label: 'Show Purchases'.
	
	buttonsLayoutMorph := LayoutMorph newRow.
	self applyStyleTo: buttonsLayoutMorph.
	buttonsLayoutMorph
		addMorph: checkoutCartButtonMorph;
		addMorph: showPurchasesButtonMorph.
	
	^ buttonsLayoutMorph! !
!TusLibrosWindow methodsFor: 'as yet unclassified' stamp: 'JD 11/28/2021 03:34:43' prior: 50990689!
buildMorphicShopWindow
		
	self layoutMorph beColumn;
	separation: 10;
	axisEdgeWeight: 0;
	addMorph: self buildCatalogAndAddToCartRow;
	addMorph: self buildCartRow;
	addMorph: self buildCheckoutAndPurchasesButtonsRow! !

!methodRemoval: TusLibrosWindow #buildCheckoutAndPurchasesButtons stamp: 'JD 11/28/2021 03:34:43'!
buildCheckoutAndPurchasesButtons

	| buttonsLayoutMorph checkoutCartButtonMorph showPurchasesButtonMorph |

	checkoutCartButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #checkoutCart label: 'Checkout Cart'.
	
	showPurchasesButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #showPurchases label: 'Show Purchases'.
	
	buttonsLayoutMorph := LayoutMorph newRow.
	self applyStyleTo: buttonsLayoutMorph.
	buttonsLayoutMorph
		addMorph: checkoutCartButtonMorph;
		addMorph: showPurchasesButtonMorph.
	
	^ buttonsLayoutMorph!
!TusLibrosWindow methodsFor: 'morphs properties - private' stamp: 'JD 11/28/2021 03:36:45' prior: 50990760!
setPropertyKeyStrokeToInnerTextMorphOf: usernameTextBoxMorph

	usernameTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | usernameTextBoxMorph innerTextMorph acceptContents ]! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| aHash256Algorithm credentials catalog clock |
	
	aHash256Algorithm := SecureHashAlgorithm256 new.
	
	credentials := Dictionary new.
	credentials at: 'Juan' put: (aHash256Algorithm hashMessage: '1234') asString.
	credentials at: 'Pedro' put: (aHash256Algorithm hashMessage: '12345') asString.
	credentials at: 'Ana' put: (aHash256Algorithm hashMessage: '123456') asString.
	
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.
	catalog at: 'Book4' put: 5.
	catalog at: 'Book5' put: 30.
	
	clock := ManualClock now: DateAndTime now.

	TusLibrosServer listeningOn: 8080 authenticatingWith: credentials acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: clock. 
	
	TusLibrosWindow open.!

	clock advanceTime: 31 minutes. "Para probar la expiracin de la sesin"!

	ManualClock allInstances first advanceTime: 31 minutes. "Para probar la expiracin de la sesin"!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| aHash256Algorithm credentials catalog clock |
	
	aHash256Algorithm := SecureHashAlgorithm256 new.
	
	credentials := Dictionary new.
	credentials at: 'Juan' put: (aHash256Algorithm hashMessage: '1234') asString.
	credentials at: 'Pedro' put: (aHash256Algorithm hashMessage: '12345') asString.
	credentials at: 'Ana' put: (aHash256Algorithm hashMessage: '123456') asString.
	
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.
	catalog at: 'Book4' put: 5.
	catalog at: 'Book5' put: 30.
	
	clock := ManualClock now: DateAndTime now.

	TusLibrosServer listeningOn: 8080 authenticatingWith: credentials acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: clock. 
	
	TusLibrosWindow open.!
!TusLibrosLogInWindowModel methodsFor: 'create cart' stamp: 'JD 11/28/2021 04:09:37' prior: 50991651!
createCart
	
	| aHash256Algorithm cartId |
	
	aHash256Algorithm := SecureHashAlgorithm256 new.
	passwordHash := aHash256Algorithm hashMessage: password asString.
	
	cartId := restInterface sendCreateCartRequestWith: username and: passwordHash.
	self triggerEvent: #newCartCreated with: cartId.

	! !

'<html><head><title>400 Bad Request</title></head><body><h1>400 Bad Request</h1><p>Invalid user and/or password</p></body></html>' asUnHtml withoutPrefix: '400 Bad Request'!

'<html><head><title>400 Bad Request</title></head><body><h1>400 Bad Request</h1><p>Invalid user and/or password</p></body></html>' asUnHtml!

'<html><head><title>400 Bad Request</title></head><body><h1>400 Bad Request</h1><p>Invalid user and/or password</p></body></html>' asUnHtml withoutPrefix: '400 Bad Request400 Bad Request'!
!TusLibrosLogInWindowModel methodsFor: 'create cart' stamp: 'JD 11/28/2021 04:14:43' prior: 50991934!
createCart
	
	| aHash256Algorithm cartId |
	
	aHash256Algorithm := SecureHashAlgorithm256 new.
	passwordHash := aHash256Algorithm hashMessage: password asString.
	
	self 
		try: [
			cartId := restInterface sendCreateCartRequestWith: username and: passwordHash.
			self triggerEvent: #newCartCreated with: cartId.
		]
	! !
!TusLibrosWindowModel methodsFor: 'error handling' stamp: 'JD 11/28/2021 04:15:49'!
try: aBlock
	
	aBlock
		on: Error
		do: [:anError |
			Transcript clear.
			Transcript show: (self parseErrorDescription: anError messageText).
			TranscriptWindow openTranscript.
		]! !
!TusLibrosWindowModel methodsFor: 'error handling' stamp: 'JD 11/28/2021 04:17:38'!
parseErrorDescription: anErrorDescription
	
	"Esto es muy feo, pero no encontramos una manera de obtener la descripcin del error
	que enva el servidor sin el html"

	^ anErrorDescription asUnHtml withoutPrefix: '400 Bad Request400 Bad Request'! !
!TusLibrosShopWindowModel methodsFor: 'cart' stamp: 'JD 11/28/2021 04:19:10' prior: 50991726!
addToCart

	| books |

	books := catalog keys.
	self
		try: [
			restInterface sendAddToCartRequest: itemQuantity of: (books at: catalogListIndex) to: cartId.
			self triggerEvent: #cartModified
		]
		failingWithErrorDescription: 'Item quantity must be at least one.'
	! !
!TusLibrosShopWindowModel methodsFor: 'cart' stamp: 'JD 11/28/2021 04:20:20' prior: 50991996!
addToCart

	| books |

	books := catalog keys.
	self
		try: [
			restInterface sendAddToCartRequest: itemQuantity of: (books at: catalogListIndex) to: cartId.
			self triggerEvent: #cartModified
		]
	! !
!TusLibrosShopWindowModel methodsFor: 'cart' stamp: 'JD 11/28/2021 04:21:40' prior: 50986300!
checkoutCart
	
	self try: [
		restInterface sendCheckoutOutCartRequestFor: cartId withCreditCardNumber: '11111111111111' expiringOn: '2/2050' ownedBy: 'Juan'.
		self triggerEvent: #cartCheckouted
	]! !
!TusLibrosShopWindowModel methodsFor: 'cart' stamp: 'JD 11/28/2021 04:22:36' prior: 50991714!
removeFromCart

	self
		try: [
			| aBookToRemove |
			aBookToRemove := cart at: cartListIndex.
			restInterface sendRemoveFromCartRequest: aBookToRemove from: cartId.
			self triggerEvent: #cartModified
		]	! !
!TusLibrosShopWindowModel methodsFor: 'cart' stamp: 'JD 11/28/2021 04:22:56' prior: 50992028!
removeFromCart

	self
		try: [
			| aBookToRemove |
			aBookToRemove := cart at: cartListIndex.
			restInterface sendRemoveFromCartRequest: aBookToRemove from: cartId.
			self triggerEvent: #cartModified
		]! !
!TusLibrosShopWindowModel methodsFor: 'cart' stamp: 'JD 11/28/2021 04:24:30' prior: 50992038!
removeFromCart

	self
		try: [
			| aBookToRemove |
			cartListIndex = 0 ifTrue: [self error: 'Select an item to remove'].
			aBookToRemove := cart at: cartListIndex.
			restInterface sendRemoveFromCartRequest: aBookToRemove from: cartId.
			self triggerEvent: #cartModified
		]! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| aHash256Algorithm credentials catalog clock |
	
	aHash256Algorithm := SecureHashAlgorithm256 new.
	
	credentials := Dictionary new.
	credentials at: 'Juan' put: (aHash256Algorithm hashMessage: '1234') asString.
	credentials at: 'Pedro' put: (aHash256Algorithm hashMessage: '12345') asString.
	credentials at: 'Ana' put: (aHash256Algorithm hashMessage: '123456') asString.
	
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.
	catalog at: 'Book4' put: 5.
	catalog at: 'Book5' put: 30.
	
	clock := ManualClock now: DateAndTime now.

	TusLibrosServer listeningOn: 8080 authenticatingWith: credentials acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: clock. 
	
	TusLibrosWindow open.!
!TusLibrosShopWindowModel methodsFor: 'cart' stamp: 'JD 11/28/2021 04:25:42' prior: 50992048!
removeFromCart

	self
		try: [
			| aBookToRemove |
			self halt.
			cartListIndex = 0 ifTrue: [self error: 'Select an item to remove'].
			aBookToRemove := cart at: cartListIndex.
			restInterface sendRemoveFromCartRequest: aBookToRemove from: cartId.
			self triggerEvent: #cartModified
		]! !
!TusLibrosShopWindowModel methodsFor: 'initialization' stamp: 'JD 11/28/2021 04:26:23' prior: 50990529!
initializeFor: aCartId authenticating: aUsername with: aPasswordHash
	
	super initialize.		
	cartId := aCartId.
	username := aUsername.
	passwordHash := aPasswordHash.
	catalogListIndex := 1.
	cartListIndex := 0.
	itemQuantity := '1'.! !
!TusLibrosShopWindowModel methodsFor: 'cart' stamp: 'JD 11/28/2021 04:26:40' prior: 50992090!
removeFromCart

	self
		try: [
			| aBookToRemove |
			cartListIndex = 0 ifTrue: [self error: 'Select an item to remove'].
			aBookToRemove := cart at: cartListIndex.
			restInterface sendRemoveFromCartRequest: aBookToRemove from: cartId.
			self triggerEvent: #cartModified
		]! !

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| aHash256Algorithm credentials catalog clock |
	
	aHash256Algorithm := SecureHashAlgorithm256 new.
	
	credentials := Dictionary new.
	credentials at: 'Juan' put: (aHash256Algorithm hashMessage: '1234') asString.
	credentials at: 'Pedro' put: (aHash256Algorithm hashMessage: '12345') asString.
	credentials at: 'Ana' put: (aHash256Algorithm hashMessage: '123456') asString.
	
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.
	catalog at: 'Book4' put: 5.
	catalog at: 'Book5' put: 30.
	
	clock := ManualClock now: DateAndTime now.

	TusLibrosServer listeningOn: 8080 authenticatingWith: credentials acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: clock. 
	
	TusLibrosWindow open.!
!TusLibrosShopWindowModel methodsFor: 'cart' stamp: 'JD 11/28/2021 04:27:27' prior: 50992114!
removeFromCart

	self
		try: [
			| aBookToRemove |
			self halt.
			cartListIndex = 0 ifTrue: [self error: 'Select an item to remove'].
			aBookToRemove := cart at: cartListIndex.
			restInterface sendRemoveFromCartRequest: aBookToRemove from: cartId.
			self triggerEvent: #cartModified
		]! !
!TusLibrosShopWindowModel methodsFor: 'cart' stamp: 'JD 11/28/2021 04:29:33' prior: 50992156!
removeFromCart

	self
		try: [
			| aBookToRemove |
			self halt.
			cartListIndex = 0 ifTrue: [^self error: 'Select an item to remove'].
			aBookToRemove := cart at: cartListIndex.
			restInterface sendRemoveFromCartRequest: aBookToRemove from: cartId.
			self triggerEvent: #cartModified
		]! !
!TusLibrosShopWindowModel methodsFor: 'cart' stamp: 'JD 11/28/2021 04:30:56' prior: 50992169!
removeFromCart

	self
		try: [
			| aBookToRemove |
			self halt.
			cartListIndex = 0 ifTrue: [self error: 'Select an item to remove'].
			aBookToRemove := cart at: cartListIndex.
			restInterface sendRemoveFromCartRequest: aBookToRemove from: cartId.
			self triggerEvent: #cartModified
		]! !
!TusLibrosWindowModel methodsFor: 'error handling' stamp: 'JD 11/28/2021 04:32:07' prior: 50991985!
parseErrorDescription: anErrorDescription
	
	"Esto es muy feo, pero no encontramos una manera de obtener la descripcin del error
	que enva el servidor sin el html"

	^ anErrorDescription! !
!TusLibrosWindowModel methodsFor: 'error handling' stamp: 'JD 11/28/2021 04:32:13' prior: 50992195!
parseErrorDescription: anErrorDescription
	
	"Esto es muy feo, pero no encontramos una manera de obtener la descripcin del error
	que enva el servidor sin el html"

	^ anErrorDescription asUnHtml withoutPrefix: '400 Bad Request400 Bad Request'! !
!TusLibrosWindowModel methodsFor: 'error handling' stamp: 'JD 11/28/2021 04:33:24' prior: 50992205!
parseErrorDescription: anErrorDescription
	
	"Esto es muy feo, pero no encontramos una manera de obtener la descripcin del error
	que enva el servidor sin el html"
	
	(anErrorDescription includesSubString: '400 Bad Request') 
		ifTrue: [^ anErrorDescription asUnHtml withoutPrefix: '400 Bad Request400 Bad Request']
		ifFalse: [^ anErrorDescription]
	! !
!TusLibrosShopWindowModel methodsFor: 'cart' stamp: 'JD 11/28/2021 04:33:50' prior: 50992182!
removeFromCart

	self
		try: [
			| aBookToRemove |
			cartListIndex = 0 ifTrue: [self error: 'Select an item to remove'].
			aBookToRemove := cart at: cartListIndex.
			restInterface sendRemoveFromCartRequest: aBookToRemove from: cartId.
			self triggerEvent: #cartModified
		]! !

	ManualClock allInstances first advanceTime: 31 minutes. "Para probar la expiracin de la sesin"!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

"--------------------- Tus Libros ---------------------"

	| aHash256Algorithm credentials catalog clock |
	
	aHash256Algorithm := SecureHashAlgorithm256 new.
	
	credentials := Dictionary new.
	credentials at: 'Juan' put: (aHash256Algorithm hashMessage: '1234') asString.
	credentials at: 'Pedro' put: (aHash256Algorithm hashMessage: '12345') asString.
	credentials at: 'Ana' put: (aHash256Algorithm hashMessage: '123456') asString.
	
	catalog := Dictionary new.
	catalog at: 'Book1' put: 10.
	catalog at: 'Book2' put: 12.
	catalog at: 'Book3' put: 20.
	catalog at: 'Book4' put: 5.
	catalog at: 'Book5' put: 30.
	
	clock := ManualClock now: DateAndTime now.

	TusLibrosServer listeningOn: 8080 authenticatingWith: credentials acceptingItemsOf: catalog registeringOn: (OrderedCollection new) debitingThrought: (MerchantProcessorStub new) measuringTimeWith: clock. 
	
	TusLibrosWindow open.!

	ManualClock allInstances first advanceTime: 38 minutes. "Para probar la expiracin de la sesin"!

	ManualClock allInstances first advanceTime: 38 minutes. "Para probar la expiracin de la sesin"!

	ManualClock allInstances do: [:aManualClock | aManualClock advanceTime: 31 minutes.]!

!methodRemoval: TusLibrosWindowModel #try:failingWithErrorDescription: stamp: 'JD 11/28/2021 04:37:42'!
try: aBlock failingWithErrorDescription: anErrorDescription
	
	aBlock
		on: Error
		do: [
			Transcript clear.
			Transcript show: anErrorDescription.
			TranscriptWindow openTranscript.
		]!

----SNAPSHOT----(28 November 2021 04:38:05) CuisUniversity-4972.image priorSource: 21122765!

SecureHashAlgorithm256 new hashMessage: '1234'!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

	TusLibrosServer allInstances do: [:anInstance | anInstance destroy].!

----SNAPSHOT----(28 November 2021 04:58:47) CuisUniversity-4972.image priorSource: 21140585!

----SNAPSHOT----(28 November 2021 05:14:12) CuisUniversity-4972.image priorSource: 21140872!